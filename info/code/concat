"use strict";!function(){function getStates(navs,pageList){var routes=[];return _.each(navs,function(elem,inx){var views,page,state=null;elem.page?_.isObject(elem.page)?(views={},_.each(elem.page,function(_elem,_inx){var view,_page=pageList[_elem];_page&&(view={templateUrl:_.isArray(_page.html)?_.first(_page.html):_page.html,controller:_page.ctrl,controllerAs:_page.ctrlAlias,resolve:getLazyResolve(_page)},views[_inx]=view)}),state={views:views,url:elem.url,params:elem.url?void 0:elem.params}):(page=pageList[elem.page],page&&(state={templateUrl:_.isArray(page.html)?_.first(page.html):page.html,controller:page.ctrl,controllerAs:page.ctrlAlias,url:elem.url,params:elem.params,resolve:getLazyResolve(page)})):state={"abstract":!0,url:elem.url,template:"<ui-view/>"},state&&routes.push({state:inx,config:state})}),routes}function getLazyResolve(page){return page.lazyDeps&&page.lazyDeps.length?{deps:function($q,$rootScope,$state){var deferred=$q.defer();return page.lazyDeps.length||deferred.resolve(),$script(page.lazyDeps,"deps",function(){$rootScope.$apply(function(){app.controllerProvider.has(page.ctrl)?(page.lazyDeps.length=0,deferred.resolve()):(deferred.reject(),$state.go("error",{code:"msg_lazy_load_error",message:"msg_lazy_load_error_desc"}))})}),deferred.promise}}:{deps:function(){}}}function disableScroll($rootHtmlElement){$rootHtmlElement.addClass("disable_scroll")}function enableScroll($rootHtmlElement){$rootHtmlElement.removeClass("disable_scroll")}var defaultPage;svg4everybody(),appDeps=appDeps.concat(["app.config","unsavedChanges","device","app-module-funcs","nw","anweb-storage","svgIcon","ngDialog","angular-progress-arc"]),appDeps.push("duScroll");var app=angular.module("app",appDeps);app.constant("fieldConfig",{style:"material"}),app.config(["unsavedWarningsConfigProvider","$controllerProvider","$filterProvider","$compileProvider","ngDialogProvider","$injector",function(unsavedWarningsConfigProvider,$controllerProvider,$filterProvider,$compileProvider,ngDialogProvider,$injector){var somovd;$injector.has("somovdProvider")&&(somovd=$injector.get("somovdProvider"),somovd.somovdEndPoint="/jsonrpc"),app.controllerProvider=$controllerProvider,app.filterProvider=$filterProvider,app.compileProvider=$compileProvider,unsavedWarningsConfigProvider.useTranslateService=!1,unsavedWarningsConfigProvider.navigateMessage="msg_warn_navigate",unsavedWarningsConfigProvider.reloadMessage="msg_warn_reload",$script.path("/"),ngDialogProvider.setDefaults({closeByDocument:!1,showClose:!1})}]),app.run(["routerHelper","pageList","navigationFilter",function(routerHelper,pageList,navigationFilter){FastClick.attach(document.body);var navs=navigationFilter.filter(),states=getStates(navs,pageList);routerHelper.configureStates(states),_.find(states,function(elem){return"home"==elem.state})?(defaultPage="home",routerHelper.setOtherwise("/home")):(defaultPage="summary",routerHelper.setOtherwise("/summary"))}]),app.controller("AppMobileCtrl",["$scope","$injector","device","history","navigationFilter","pageList","$timeout","$state","translate","$document","$q","$rootScope","devinfo","$window","menus","menuFuncs","notice","ngDialog","overlay-core","snapper",function($scope,$injector,device,history,navigationFilter,pageList,$timeout,$state,translate,$document,$q,$rootScope,devinfo,$window,menus,menuFuncs,notice,ngDialog,overlayCore,snapper){function updateNavs(){menuFuncs.updateNavs($scope)}!function(){function appDataInit(){devinfo.skipAuth.once("version").then(function(data){return data?(data.lang&&translate.changeLanguage(data.lang),data.webMode&&($rootScope.webInterfaceMode=data.webMode),data?void($scope.deviceInfo=data):Promise.reject()):Promise.reject()})["catch"](appDataInit)}history.clearAll(),$scope.device=device,appDataInit(),function(){$timeout(function(){angular.element(document.getElementsByTagName("body")).removeClass("disable_transitions")},2e3),angular.element(document.getElementById("lblock")).bind("transitionend",updateNavs),angular.element($window).bind("resize",updateNavs)}()}(),$injector.has("eventHandler")?$injector.get("eventHandler"):null,$rootScope.autoconf=autoconf,$scope.devinfo=devinfo,$scope.showGroup="";var navs=navigationFilter.filter();$scope.customRules=navigationFilter.rules(),$scope.menuList=menuFuncs.makeMenuList(navs,pageList),$scope.tabsList=[],$scope.mobileViewStyle="",$scope.mobileMenuShow=!1,$scope.selectedParam="",$rootScope.$on("$stateChangeStart",function(event,toState,toParams,fromState,fromParams){return!$scope.pageWasLoaded&&function(toState,toParams,fromState,fromParams){return toState.name===fromState.name&&_.isEqual(toParams,fromParams)}(toState,toParams,fromState,fromParams)?void event.preventDefault():($scope.pageWasLoaded=!1,void((toState.controller||toState.views&&toState.views[""])&&!event.defaultPrevented&&$scope.overlay.preloader.start()))}),$scope.$on("$stateChangeSuccess",function(event,state,params,fromState){var snav,navObj=_.find(navs,function(elem,key){return key==state.name});if(navObj&&navObj.menu&&navObj.menu.sref&&navObj.menu.sref!=state.name)return void $state.go(navObj.menu.sref);$scope.previousState=fromState.name,$scope.currentState=state.name,$scope.openedMenu=state.name.split(".")[0];var stateArr=state.name.split(".");$scope.showGroup=stateArr[0]+"."+stateArr[1],menuFuncs.makeTabsList&&($scope.tabsList=menuFuncs.makeTabsList($scope.menuList,$state.current));var nav=navs[params.name?params.name:state.name];history.isCleanLastHistory()&&(history.remove(0,-2),history.setCleanLastHistory(!1)),function(toState,fromState){return toState!=fromState}(state,fromState)&&(state.name==defaultPage||history.getObj(-1)||(snav=navs[defaultPage],history.add({title:snav.title,name:defaultPage,params:{}})),state.url?history.add({title:nav.title,name:state.name,params:params}):nav.title&&history.update({title:nav.title},-1),$timeout(function(){$scope.$digest(),updateNavs()}))}),$rootScope.$on("pageload",function(){$scope.pageWasLoaded=!0}),$scope.$on("changelang",function(){updateNavs()}),$scope.state=function(){return history.getObj(-1)},$scope.backState=function(){return history.getObj(-2)},$scope.goBackState=function(){var state=$scope.backState();state&&(history.setCleanLastHistory(!0),$state.go(state.name,state.params))},$scope.collapseMobileMenu=function(){$scope.mobileViewStyle="",$scope.mobileMenuShow=!1,$scope.selectedMenu=null},$scope.expandMobileMenu=function(){$scope.mobileViewStyle="expanded"},$scope.toggleMobileMenu=function(){"left"==snapper.snap.state().state?snapper.snap.close():snapper.snap.open("left")},$scope.selectFirstLevelMenu=function(menu){var mousemove=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!1,forceOpenPage=arguments[2];$scope.selectedMenu=$scope.selectedMenu!=menu.id?menu.id:void 0,$scope.selectedSubMenu=null,menu.external&&(location.href=menu.url),!forceOpenPage&&!menu.openPage||mousemove||($state.go(menu.sref,null,{reload:!0}),$scope.collapseMobileMenu(),snapper.snap.close())},$scope.clearSelectedMenu=function(){$scope.selectedMenu=null,$scope.selectedSubMenu=null},$scope.selectSubMenu=function(menu,event){var mousemove=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!1;menuFuncs.selectSubMenu&&menuFuncs.selectSubMenu($scope,menu,event,mousemove)},$scope.selectSecondLevelMenu=function(menu){menuFuncs.selectSecondLevelMenu($scope,$state,menu)&&snapper.snap.close()},$scope.logout=function($event,isUser){if($event.preventDefault(),$rootScope.dlinkMobileApp.isUserInMobileApp())$rootScope.dlinkMobileApp.askUserToLogout();else{if(isUser&&!confirm(translate("msg_warn_logout")))return;$rootScope.auth.logout()}},function(){var opened=[],$rootHtmlElement=angular.element($document[0].documentElement);$scope.$on("ngDialog.opened",function(e,$dialog){opened.push({element:$dialog,id:$dialog.attr("id")}),disableScroll($rootHtmlElement)}),$scope.$on("ngDialog.closing",function(e,$dialog){var index=_.findIndex(opened,function(elem){return elem.id==$dialog.attr("id")});opened.splice(index,1),enableScroll($rootHtmlElement)}),$scope.$on("$locationChangeStart",function(e){var notCloseDialogs=["login_dialog"];return function(dialogs){return _.some(dialogs,function(dialog){return _.some(notCloseDialogs,function(className){return dialog.element.hasClass(className)})})}(opened)?void e.preventDefault():void(opened.length&&(ngDialog.closeAll(),e.preventDefault()))})}()}])}();
;"use strict";angular.module(regdep("history"),[]).service("history",[function(){var history=[],cleanLastHistory=!1,add=function(obj){return history.push(obj),history},update=function(obj,pos){var currentHistory;if(0>pos)var currentHistory=history[history.length+pos];else currentHistory=history[pos];return _.extend(currentHistory,obj),currentHistory},remove=function(start,end){return history=history.slice(start,end)},clearAll=function(){return remove(0,history.length),history},getObj=function(pos){return 0>pos?history[history.length+pos]:history[pos]},isCleanLastHistory=function(){return cleanLastHistory};return{add:add,update:update,remove:remove,clearAll:clearAll,getObj:getObj,isCleanLastHistory:isCleanLastHistory,setCleanLastHistory:function(value){cleanLastHistory=value}}}]);
;"use strict";!function(){angular.module(regdep("root-scope-interface"),["app.page-details"]).run(["$rootScope","$q","overlay-simple","overlay-progress","ngDialog","devinfo","$timeout","$interval","$http","navigationFilter","pageDetails",function($rs,$q,overlaySimple,overlayProgress,ngDialog,devinfo,$timeout,$interval,$http,navigationFilter,pageDetails){$rs.autoconf=autoconf,$rs.appEvents={notifications:[]};var appEvents=$rs.appEvents;$rs.pageReady=!1,$rs.$on("notification",function(){function prepareNotification(obj){function nextNotification(inx){function getNextNotice(notifications,inx){if(notifications){var maxPriorityNotification,pullNotices=_.without(notifications,notifications[inx]);if(pullNotices.length){var maxPriorityNotice=_.max(pullNotices,function(e){return e.priority});return _.isObject(maxPriorityNotice)&&(maxPriorityNotification=_.filter(pullNotices,function(e,k){return e.priority==maxPriorityNotice.priority&&k>=inx}),maxPriorityNotification.length>0&&(maxPriorityNotice=_.first(maxPriorityNotification))),_.isObject(maxPriorityNotice)?maxPriorityNotice:notifications[inx+1]}}}inx>appEvents.notifications.length-2?delete appEvents.trayNotification:appEvents.trayNotification=getNextNotice(appEvents.notifications,inx)}function wrapAction(actionObj,actionName,handler){var action=actionObj[actionName];actionObj[actionName]=function(){var actionResult,inx=_.findIndex(appEvents.notifications,function(e){return e.name==obj.name}),inTray=!1;appEvents.trayNotification&&appEvents.trayNotification.name==obj.name&&(inTray=!0,delete appEvents.trayNotification),_.isFunction(action)?(actionResult=action.call(actionObj),actionResult&&_.isFunction(actionResult.then)?actionResult.then(function(result){handler(result,inTray,inx)})["catch"](function(){handler(!1,inTray,inx)}):handler(actionResult,inTray,inx)):handler(!0,inTray,inx)}}return wrapAction(obj,"close",function(result,inTray,inx){result&&inTray&&nextNotification(inx)}),obj.actions&&_.each(obj.actions,function(e){wrapAction(e,"handler",function(result,inTray,inx){inTray&&nextNotification(inx),inx>=0&&result&&appEvents.notifications.splice(inx,1)})}),obj}var arg=arguments[1];if(arg){_.isArray(arg)||(arg=[arg]),_.each(arg,function(e){appEvents.notifications.push(prepareNotification(e))});var firstNotification=function(notifications){var maxPriorityNotice=_.max(notifications,function(e){return e.priority});return _.isObject(maxPriorityNotice)?maxPriorityNotice:notifications[notifications.length-1]}(appEvents.notifications);appEvents.trayNotification&&appEvents.trayNotification.name==firstNotification.name||(appEvents.trayNotification=firstNotification)}}),$rs.$on("notification-remove",function(){var arg=arguments[1];arg&&(_.isArray(arg)||(arg=[arg]),_.each(arg,function(e){var noticeIndex=_.findIndex(appEvents.notifications,function(notice){return notice.name==e.name});-1!=noticeIndex&&appEvents.notifications.splice(noticeIndex,1)}),function(){function getNextNotice(notifications){if(notifications){var maxPriorityNotice=_.max(notifications,function(e){return e.priority});return _.isObject(maxPriorityNotice)?maxPriorityNotice:notifications[0]}}appEvents.notifications.length?appEvents.trayNotification=getNextNotice(appEvents.notifications):delete appEvents.trayNotification}())}),$rs.$on("pageload",function(){$rs.overlay.preloader.stop()}),$rs.$on("stateChangeBreak",function(){$rs.overlay.preloader.stop()}),$rs.overlay={circular:{start:function(){var id=Math.floor(999*Math.random())+1;return overlaySimple.start({event:id}),id},stop:function(id,force){overlaySimple.stop({event:id,force:force})}},progress:{start:function(duration,title){var deferred=$q.defer();return overlayProgress.start({duration:duration,callback:function(status){"finished"==status&&deferred.resolve()},title:title}),deferred.promise},stop:function(){overlayProgress.stop()}},preloader:{start:function(){$rs.pageReady=!1},stop:function(){$rs.pageReady=!0}}},$rs.waitForReboot=function(){function updateRows(data){null!=data&&($timeout.cancel(promise),deffered.resolve(data))}var deffered=$q.defer(),promise=$timeout(function(){devinfo.skipAuth.subscribe("version",updateRows)},15e3);return deffered.promise},$rs.customRules=navigationFilter.rules(),$rs.goToNewIP=function(ip){var oldUrl=location.href,newUrl=oldUrl.replace(/(\:\/\/)([^:\/]*)/,function(str,p1){return p1+ip});window.onbeforeunload=null,newUrl==oldUrl?location.reload():location.href=newUrl},$rs.pageDetails=pageDetails}])}();
;"use strict";var snap=angular.module(regdep("snapper"),[]);snap.service("snapper",["$timeout","$interval",function($timeout,$interval){this.snap={};var blocked=!1,self=this,maxWidth=autoconf.BR2_PACKAGE_ANWEB_HQ_ADMIN_APP?699:1024,initInterval=$interval(function(){var bodyContent=document.getElementById("body-content");if(bodyContent){$interval.cancel(initInterval);var maxPosition=window.innerWidth>500?310:270;snap=new Snap({element:document.getElementById("body-content"),maxPosition:maxPosition,disable:"right"}),self.snap=snap;var wrapper=autoconf.BR2_PACKAGE_ANWEB_HQ_ADMIN_APP||autoconf.BR2_PACKAGE_ANWEB_EU_ADMIN_APP||autoconf.BR2_PACKAGE_ANWEB_MEGAFON_APP?document.getElementsByClassName("page-block")[0]:document.getElementById("wrapper"),snapOverlay=document.getElementById("overlay-blackout");snap.on("open",function(){blocked||(snapOverlay.style.zIndex=9999,snapOverlay.style.opacity=(maxPosition/(maxPosition+195)).toFixed(2),wrapper.style.overflow="hidden")}),snap.on("close",function(){blocked||($timeout(function(){snapOverlay.style.zIndex=-1},300),snapOverlay.style.opacity=0,wrapper.style.overflow="auto")}),snap.on("start",function(){if(blocked=window.innerWidth>maxWidth?!0:!1,!blocked){var state=snap.state();null!=state.info.flick&&(snapOverlay.style.transition="none")}}),snap.on("end",function(){if(!blocked){snapOverlay.style.transition="opacity 0.3s ease";var state=snap.state();"right"==state.info.towards?state.info.flick?(snapOverlay.style.zIndex=9999,snapOverlay.style.opacity=(maxPosition/(maxPosition+195)).toFixed(2),wrapper.style.overflow="hidden"):($timeout(function(){snapOverlay.style.zIndex=-1},300),snapOverlay.style.opacity=0,wrapper.style.overflow="auto"):1==state.info.flick&&($timeout(function(){snapOverlay.style.zIndex=-1},300),snapOverlay.style.opacity=0,wrapper.style.overflow="auto")}}),snap.on("drag",function(){if(!blocked){var transformBC=bodyContent.style.transform,shiftBC=parseInt(transformBC.substr(12,transformBC.length).split(",")[0]);shiftBC>15?(snapOverlay.style.zIndex=9999,wrapper.style.overflow="hidden"):(snapOverlay.style.zIndex=-1,wrapper.style.overflow="auto"),maxPosition>=shiftBC&&(snapOverlay.style.opacity=(shiftBC/(maxPosition+195)).toFixed(2))}});var startY=0,menu=document.getElementsByClassName("mmenu")[0];if(!navigator.platform&&/iPad|iPhone|iPod/.test(navigator.platform)&&function(){var iosVersion;try{return iosVersion=parseInt(navigator.userAgent.match(/OS (\d{1,2})_\d(_\d)? like Mac OS/)[1]),13>iosVersion}catch(e){return!1}}()){var preventScrollIfNeeded=function(event,scrollingElement){var clientY=event.targetTouches[0].clientY-startY;0===scrollingElement.scrollTop&&clientY>0&&event.preventDefault(),isTotallyScrolled(scrollingElement)&&0>clientY&&event.preventDefault()},isTotallyScrolled=function(elem){return elem.scrollHeight-elem.scrollTop<=elem.clientHeight};wrapper.addEventListener("touchstart",function(event){1===event.targetTouches.length&&(startY=event.targetTouches[0].clientY)},!1),wrapper.addEventListener("touchmove",function(event){1===event.targetTouches.length&&preventScrollIfNeeded(event,wrapper)},!1),menu.addEventListener("touchstart",function(event){1===event.targetTouches.length&&(startY=event.targetTouches[0].clientY)},!1),menu.addEventListener("touchmove",function(event){1===event.targetTouches.length&&preventScrollIfNeeded(event,menu)},!1)}}},500)}]);
;"use strict";!function(){var modname="auth-interface";window.appDeps.push(modname),angular.module(modname,["auth-digest"]).config(["$injector",function($injector){var authDigestProvider=$injector.get("authDigestProvider");authDigestProvider.authHeaderName=window.H_AUTH_HEADER_NAME,authDigestProvider.autologinHeaderName=window.H_AUTH_AUTOLOGIN_HEADER_NAME,authDigestProvider.repeatRequestHeaderName=window.H_REPEAT_REQUEST_HEADER_NAME,authDigestProvider.deviceSessionHeaderName=window.H_DEVICE_SESSION_ID,authDigestProvider.authDefaultUsername=autoconf.BR2_PACKAGE_ANWEB_ADMIN_NAME,authDigestProvider.authDefaultPassword=autoconf.BR2_PACKAGE_ANWEB_ADMIN_PASS,authDigestProvider.getCredentialsCallback=["$location","$q","ngDialog","authParams","$injector","navigationFilter",function($location,$q,ngDialog,authParams,$injector,navigationFilter){var template=autoconf.BR2_PACKAGE_ANWEB_HQ_ADMIN_APP?"dialogs/hq_login/dialog.tpl.html":"dialogs/login/dialog.tpl.html";return function(ngDialog,authParams){var preCloseCallback,deferred=$q.defer();return $injector.has("authReload")&&(preCloseCallback=$injector.get("authReload").getCallback(deferred)),ngDialog.open({template:template,className:"login_dialog",closeByDocument:!1,closeByEscape:!1,controller:LoginDialogCtrl,showClose:!1,preCloseCallback:preCloseCallback,data:{clientTryCount:authParams.clientTryCount,tryCountRemain:authParams.tryCountRemain,banTimeRemain:authParams.banTimeRemain,banReason:authParams.banReason,notAuthorized:authParams.notAuthorized,customRules:navigationFilter.rules()}}).closePromise.then(function(data){deferred.resolve(data.value)}),deferred.promise}(ngDialog,authParams)}]}]).run(["$rootScope","$http","$injector","authDigest",function($rs,$http,$injector,authDigest){$rs.auth={logout:function(){authDigest.cleanCredentials(),$http.get("/logout")}},$injector.has("authReload")&&$injector.get("authReload").startWatch()}])}();
;"use strict";function NoticeQueue(notifications){_.extend(this,{queue:{},showedList:[],addToQueue:function(name,notificationView){this.queue[name]=notificationView},removeFromQueue:function(name){this.queue=_.omit(this.queue,name)},addShowed:function(name){_.contains(this.showedList,name)||this.showedList.push(name)},forgetShowing:function(name){this.showedList=_.without(this.showedList,name)},pushNotifications:function(){_.each(this.queue,function(notification,name){_.contains(this.showedList,name)||(notifications.add(notification),this.showedList.push(name))}.bind(this)),this.queue={}}})}angular.module(regdep("notice"),[]).service("notice",["$rootScope","$state","devinfo","device","funcs","ngDialog","authDigestCredentialsStorage","authDigestRealmStorage","authDigest","authDigestHelper","$timeout","noticeQueue","translate","cookie","navigationFilter","$q",function($rootScope,$state,devinfo,device,funcs,ngDialog,authDigestCredentialsStorage,authDigestRealmStorage,authDigest,authDigestHelper,$timeout,noticeQueue,translate,cookie,navFilter,$q){function getNoticeView(notice,params){return notice.view?_.extend({},notice.view,{getDescription:_.isFunction(notice.view.description)?notice.view.description.bind(null,params):function(){return notice.view.description},actions:_.map(notice.view.actions,function(item){return item.handler&&_.isFunction(item.handler)&&(item.handler=_.partial(item.handler,params)),item})}):null}var navRules=navFilter.rules()||{},noticeConfig={NeedSave:{name:"Save",priority:5,addCallback:function(){return!isExistNotice("SaveAndReboot")},addNotice:function(noticeView){isExistNotice("SaveAndReboot")||noticeQueue.addToQueue(this.name,noticeView)},view:{description:"notice_save_desc",name:"save",icon:"save",actions:[{icon:"apply",primary:!0,text:"act_save",handler:function(){return device.system.save()}},{icon:"arrow-revert",primary:!1,text:"act_cancel",handler:function(){confirm(translate("notification_reset_changes_confirm"))&&device.system.reboot()}}]}},NeedSaveAndReboot:{name:"SaveAndReboot",priority:5,addNotice:function(noticeView){noticeQueue.removeFromQueue("Save"),noticeQueue.addToQueue(this.name,noticeView)},view:{description:"notice_save_and_reboot_desc",name:"saveAndReboot",icon:"save_and_reboot",actions:[{icon:"apply",text:"act_reboot",primary:!0,handler:function(){confirm(translate("notice_save_and_reboot_confirm"))&&device.system.reboot(!0)}}]},addCallback:function(){return remove("NeedSave",!1),!0}},NeedChangeDefaultSettings:{name:"ChangeDefaults",priority:6,addCallback:function(params){return $timeout(function(){var realm=authDigestRealmStorage.getCurrent(),authHeader=authDigestCredentialsStorage.get(realm);return!authHeader&&params.needChangePass?!1:(auto.stop(),void ngDialog.open({template:"dialogs/change_pass/dialog.tpl.html",className:"change_pass_dialog",closeByDocument:!1,closeByEscape:!1,controller:ChangePassDialogCtrl,showClose:!1,data:params}).closePromise.then(function(){auto.start()}))}),!1}},FirmwareUpdateAvailable:{name:"FirmwareUpdateAvailable",priority:4,addNotice:function(noticeView){noticeQueue.addToQueue(this.name,noticeView)},view:{name:"firmwareUpdate",description:function(params){return translate("notice_fwupdate_available_desc")+" "+params.updateVersion+" "+translate("notice_fwupdate_available_desc2")},icon:"firmware_remote_update",actions:[{icon:"apply",text:"notice_fwupdate_available_title",primary:!0,handler:function(params){function backup(){var deferred=$q.defer();return device.system.backup(function(){var url="/config_load",header=authDigestHelper.generateHeader({url:url,method:"GET"});cookie.set("Authorization",header,3,"sec"),document.location.href=url,$timeout(function(){deferred.resolve()},3e3)},function(){deferred.reject()}),deferred.promise}function success(){$rootScope.$emit("device.action.started",{action:"fwupdate.remote"})}function error(){alert(translate("firmware_remote_update_failed")),location.reload()}if(confirm(translate("firmware_update_confirm"))){var checkVersion=device.system.checkVersion(params.updateCurrentVersion,params.updateVersion);switch(checkVersion){case"need_backup":alert(translate("firmware_force_reset")),backup().then(function(){confirm(translate("firmware_continue_update"))&&device.system.remoteUpdate(success,error)});break;case"maybe_backup":confirm(translate("firmware_maybe_reset"))?backup().then(function(){confirm(translate("firmware_continue_update"))&&device.system.remoteUpdate(success,error)}):confirm(translate("firmware_continue_update"))&&device.system.remoteUpdate(success,error);break;default:device.system.remoteUpdate(success,error)}}}}]}},NeedEnterPINPUK:{name:"NeedEnterPINPUK",priority:7,addNotice:function(noticeView){noticeQueue.addToQueue(this.name,noticeView)},view:{name:"needEnterPin",description:function(params){var name="pin"==params.name?"PIN":"puk"==params.name?"PUK":"PUK2";return translate("notice_need_enter_pin_desc")+" "+name},icon:"sim_card",actions:[{icon:"go_to_page",text:"notice_need_enter_pin_enter",primary:!0,handler:function(){$rootScope.notice.show=!1,"settings.usbmodem.pin"!=!$state.current.name&&$state.go("settings.usbmodem.pin")}}]}},unreadMessages:{name:"unreadMessages",priority:8,addNotice:function(noticeView){noticeQueue.addToQueue(this.name,noticeView)},view:{name:"youHaveUnreadMessages",description:function(){return translate("usb_modem_sms_you_have_unread_messages")},icon:"unread_mess",actions:[{icon:"go_to_page",text:"usb_modem_sms_you_have_unread_messages_read",primary:!0,handler:function(){"settings.usbmodem.sms"!=!$state.current.name&&$state.go("settings.usbmodem.sms")}}]}},lteIntersectedSubnet:{name:"lteIntersectedSubnet",priority:10,addNotice:function(noticeView){noticeQueue.addToQueue(this.name,noticeView)},view:{icon:"need_change_lan_subnet",name:"notice_lte_intersected_subnet",description:function(params){return translate("notice_lte_intersected_subnet_desc")+" "+params.name+". "+translate("notice_lte_intersected_subnet_desc2")},actions:[{icon:"go_to_page",text:"notice_enable_go",primary:!0,handler:function(){"settings.lan"!=!$state.current.name&&$state.go("settings.lan")}}]}},wanIntersectedSubnet:{name:"wanIntersectedSubnet",priority:10,addNotice:function(noticeView){noticeQueue.addToQueue(this.name,noticeView)},view:{icon:"warning",name:"notice_wan_intersected_subnet",description:function(){return translate("notice_wan_intersected_subnet_desc")},actions:[{icon:"go_to_page",text:"notice_enable_go",primary:!0,handler:function(){"settings.lan"!=!$state.current.name&&$state.go("settings.lan")}}]}},needUpdateMac:{name:"needUpdateMac",priority:10,addNotice:function(noticeView){noticeQueue.addToQueue(this.name,noticeView)},view:{name:"notice_need_update_mac",description:"notice_need_update_mac",icon:"need_update_mac"}},hotWifiEnable:{name:"hotWifiEnable",priority:10,addNotice:function(noticeView){noticeQueue.addToQueue(this.name,noticeView)},view:{name:"hotWifiEnable",description:"notice_enable_desc",actions:[{icon:"go_to_page",text:"hotwifi_notice_enable_go",primary:!0,handler:function(){"advanced.hot_wif"!=!$state.current.name&&$state.go("advanced.hot_wifi")}}]}}},notices=[],skipNextNeedSave=!1,hasUnshowed=!1;$rootScope.notice={count:0};var auto=new function(){var handlers=[];this.start=function(){devinfo.onceAndSubscribe("notice",auto.update)},this.stop=function(){devinfo.unsubscribe("notice",auto.update)},this.subscribe=function(handler){var list;return~_.indexOf(handlers,handler)?!1:(handlers.push(handler),list=getList(),handler(list),!0)},this.update=function(data){function shouldShowUpdateNotification(updateAvailable){return new Promise(function(resolve){updateAvailable&&!navRules.OffNoticeUpdateAvailable?$rootScope.dlinkMobileApp.isUserInMobileApp()?$rootScope.dlinkMobileApp.isNotificationsBlocked().then(function(blocked){resolve(!blocked)}):resolve(!0):resolve(!1)})}if(data){if(_.each(["NeedSave","NeedSaveAndReboot"],function(notice){data.systemNotice==notice?skipNextNeedSave||(add(notice,null,!1),hasUnshowed=!1):remove(notice,!1)}),"NeedChangePass"==data.systemNotice||data.needChangeSSID24||data.needChangeSSID5){var params={needChangeSSID24:data.needChangeSSID24,needChangeSSID5:data.needChangeSSID5,needChangePass:"NeedChangePass"==data.systemNotice};add("NeedChangeDefaultSettings",params,!1)}shouldShowUpdateNotification("update_available"==data.updateStatus).then(function(shouldShow){shouldShow?add("FirmwareUpdateAvailable",{updateVersion:data.updateVersion,updateCurrentVersion:data.updateCurrentVersion},!1):remove("FirmwareUpdateAvailable",!1)}),data.needEnterPINPUK?(pinNotice=get("NeedEnterPINPUK"),pinNotice&&pinNotice.params.name!=data.needEnterPINPUK&&remove("NeedEnterPINPUK",!1),add("NeedEnterPINPUK",{name:data.needEnterPINPUK},!1)):remove("NeedEnterPINPUK",!1),data.unreadMessages?add("unreadMessages",{name:data.unreadMessages},!1):remove("unreadMessages",!1),data.needUpdateMAC?add("needUpdateMac",{name:data.needUpdateMac},!1):remove("needUpdateMac",!1),data.lteIntersectedSubnet?(get("lteIntersectedSubnet"),add("lteIntersectedSubnet",{name:data.lteIntersectedSubnet},!1)):remove("lteIntersectedSubnet",!1),isAPMode="ap"===cookie.get("device_mode"),data.brConflict&&!isAPMode?(get("wanIntersectedSubnet"),add("wanIntersectedSubnet",null,!1)):remove("wanIntersectedSubnet",!1),data.hotWifiEnable?add("hotWifiEnable"):remove("hotWifiEnable")}noticeQueue.pushNotifications();var pinNotice,isAPMode,oldNotice=angular.copy($rootScope.notice);$rootScope.notice.count=count(),oldNotice.count<$rootScope.notice.count&&($rootScope.notice.show=!0);for(var index in handlers)handlers[index]()}},indexInList=function(name){for(var r=0;notices[r];){if(notices[r].name==name)return r;r++}return-1},isExistNotice=function(name){return-1!=indexInList(name)},sortListPriority=function(list){list.sort(function(a,b){return b.priority-a.priority})},get=function(name){var index=indexInList(name);return~index?notices[index]:!1},getList=function(){return sortListPriority(notices),notices},add=function(type){var params=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},sw_update=arguments.length>2&&void 0!==arguments[2]?arguments[2]:!0,notice=noticeConfig[type];if(!notice)return!1;var name=notice.name,priority=notice.priority||0,noticeView=getNoticeView(notice,params);return _.has(notice,"addNotice")&&!notice.addNotice(noticeView),isExistNotice(name)?!1:_.has(notice,"addCallback")&&!notice.addCallback(params)?!1:(notices.push({name:name,priority:priority,params:params,view:noticeView}),sw_update&&auto.update(),!0)},remove=function(type){var sw_update=arguments.length>1&&void 0!==arguments[1]?arguments[1]:!0,fg=!1,types=type.split("|");return _.each(types,function(value){var notice=noticeConfig[value];if(notice){var _index=indexInList(notice.name);~_index&&(notices.splice(_index,1),fg=!0),noticeQueue.forgetShowing(notice.name)}}),fg&&sw_update&&auto.update(),fg},count=function(){return notices.length};return auto.start(),{add:add,remove:remove,get:get,getList:getList,clear:function(){notices=[],auto.update()},count:count,subscribe:auto.subscribe,start:auto.start,stop:auto.stop}}]).run(["notice","$rootScope",function(notice,$rs){$rs.notifications=notice.getList(),$rs.closeNotification=function(){$rs.notice.show=!1}}]),angular.module("app").service("noticeQueue",NoticeQueue),NoticeQueue.$inject=["notifications"];
;"use strict";!function(){var module=angular.module(regdep("change-password"),[]);module.service("changePassword",["$q","somovd","funcs","authDigest","authDigestCredentialsStorage","authDigestRealmStorage",function($q,somovd,funcs,authDigest,authDigestCredentialsStorage,authDigestRealmStorage){return function(login,password){var deferred=$q.defer();return somovd.write(69,{login:login,pass:password},function(response){var authHeader;funcs.is.allRPCSuccess(response)?(authHeader=authDigestCredentialsStorage.get(authDigestRealmStorage.getCurrent()),authDigest.setCredentials({username:login,password:password},authHeader),deferred.resolve("password_changed")):deferred.reject(52==response.status?"password_invalid_value":"password_not_changed")}),deferred.promise}}])}();
;"use strict";!function(){angular.module(regdep("check-factory"),["devinfo","app-module-funcs","ngDialog"]).service("checkFactory",["devinfo","ngDialog","funcs",function(devinfo,ngDialog,funcs){function handler(res){res&&(!res.factorySettings||res.customBuildConfig||ngDialog.isOpen(dialogID)||(dialogID=ngDialog.open({template:"dialogs/check_factory/dialog.tpl.html",className:"check_factory_dialog",closeByDocument:!1,closeByEscape:!1,controller:"CheckFactoryDialogCtrl",resolve:funcs.getLazyResolve("dialogs/check_factory/ctrl.lazy.js","CheckFactoryDialogCtrl"),showClose:!1}).id),!res.factorySettings&&ngDialog.isOpen(dialogID)&&ngDialog.close(dialogID))}var areas="notice|version",dialogID=null,isRun=!1;this.start=function(){isRun||(isRun=!0,devinfo.skipAuth.subscribe(areas,handler),console.info("Checking the factory settings is started"))},this.stop=function(){return devinfo.skipAuth.unsubscribe(areas,handler)}}]).run(["checkFactory",function(checkFactory){checkFactory.start()}])}();
;"use strict";!function(){angular.module("app").directive("urlWrapper",["$location",function($location){return{restrict:"A",require:"ngModel",link:function($scope,$element,$attrs,$model){function needUpdateFavicon(){return stopWatching}function updateFavicon(){var path,url=$model.$viewValue,style={};url?(style.display="block",path=$location.protocol()+"://"+url+"/favicon.ico",style.background="url('"+path+"') no-repeat center center",style["background-size"]="contain",style.bottom="10px",style.height="16px",style.right="35px",style.width="16px"):style.display="none",$btn.css(style)}var $parent=$element.parent(),$btn=angular.element('<i class="url_favicon noselect"></i>'),stopWatching=!1;$parent.addClass("url_wrapper"),$parent.prepend($btn),$element.bind("focus",function(){stopWatching=!0}),$element.bind("blur",function(){stopWatching=!1}),$scope.$watch(needUpdateFavicon,updateFavicon),updateFavicon()}}}])}();
;"use strict";!function(){var app=angular.module("app");app.directive("wifiTransmitPower",[function(){return{restrict:"AEC",scope:{value:"=wifiTransmitPowerValue",nwDisabled:"="},template:'<div nw-field nw-label="wifi_advanced_transmit_power" nw-disabled="nwDisabled"><div class="custom-select"><select class="wifi-transmit-power-select" ng-model="wifiTransmit.value" ng-change="wifiTransmit.change(wifiTransmit.value)" ng-options="option.value as option.name | translate for option in wifiTransmit.options" nw-options-class="wifiTransmit.getOptionClass(option)" ng-class="wifiTransmit.getSelectClass(wifiTransmit.value)" ></select></div></div><div class="note"  ng-bind="\'wifi_advanced_transmit_power_note\' | translate"  ng-if="wifiTransmit.isWarning(wifiTransmit.value)" ></div>',link:function($scope,$element,$attrs){function isWarning(value){return"Maximum"==value||parseInt(value)>100}function setValue(value){value&&($scope.wifiTransmit.value=value)}$element.find("select"),$scope.wifiTransmit={value:null,options:function(){var options=$scope.$parent.$eval($attrs.wifiTransmitPowerOptions);return _.map(options,function(opt){return{name:opt,value:opt}})}(),change:function(){$scope.value=wifiTransmit.value},isWarning:isWarning,getSelectClass:function(value){var classes=["wifi-transmit-power-select"];return isWarning(value)&&classes.push("wifi-transmit-power-select--warning"),classes.join(" ")},getOptionClass:function(option){var classes=["wifi-transmit-power-option"];return isWarning(option.value)&&classes.push("wifi-transmit-power-option--warning"),classes.join(" ")}};var wifiTransmit=$scope.wifiTransmit;setValue($scope.value),$scope.$watch("value",setValue)}}}])}();
;"use strict";angular.module("nw",["translate","ab-base64"]);
;"use strict";function ipv6cut(value){if(!value)return"";if(value.length<=30)return value;var tmp=value.split(":"),ret=tmp[0]+": .. :"+tmp[tmp.length-2]+":"+tmp[tmp.length-1];return ret}angular.module(regdep("nw-ipv6cut"),[]).directive("ipv6cut",["$compile",function($compile){return{restrict:"AE",template:"",scope:{ipv6cut:"="},link:function(scope,element){var template,ipv6=scope.ipv6cut||"",ipv6Length=ipv6.length;template=ipv6Length>=30?$compile('<abbr title="'+ipv6+'" >'+ipv6cut(ipv6)+"</abbr>")(scope):$compile("<span>"+ipv6+"</span>")(scope),element.append(template)}}}]),angular.module("nw-ipv6cut").filter("ipv6cut",function(){return ipv6cut});
;"use strict";angular.module(regdep("nw-alert"),[]).directive("alert",[function(){return{restrict:"A",transclude:!0,scope:{alert:"@"},template:'<svg class="icon"><use xlink:href="/general/img/svg/sprite.symbol.svg#warningNew"></use></svg><div ng-transclude class="content"></div>',link:function($scope,element){var alertClass=$scope.alert||"warning";element.addClass("alert"),element.addClass(alertClass)}}}]);
;"use strict";!function(){var nw=angular.module(regdep("nw-fields"),[]);nw.directive("nwForm",function($document,$timeout){return{restrict:"A",require:"form",link:function(scope,element,attrs,formCtrl){function submitHandler(){_.each(element[0],function(el){var $el=angular.element(el),model=$el.data("$ngModelController"),isField=model&&model.hasOwnProperty("$viewValue");isField&&!el.disabled&&model.$setViewValue(model.$viewValue),isAutocompleteOff&&"password"==$el.attr("type")&&setInputAutocompleteOff($el)}),scope.$digest(),element.addClass("nw-form-apply");var invalid=element[0].querySelector(".ng-invalid:enabled");invalid&&("scrollToElementAnimated"in $document?$document.scrollToElementAnimated(invalid,90):invalid.scrollIntoView(!0)),formCtrl.$valid&&formCtrl.$setPristine()}function isEqualPasswords(){_.each(element[0],function(el){var passElement,confElement,$el=angular.element(el);$el.data("$ngModelController");var nwConfirm=$el.attr("nw-confirm");nwConfirm&&(passElement=formCtrl[nwConfirm],confElement=formCtrl[$el.attr("name")],passElement&&""!=confElement.$modelValue&&passElement.$valid&&confElement.$dirty&&passElement.$modelValue!=confElement.$modelValue?confElement.$setValidity("msg_passwords_not_equal",!1):confElement.$setValidity("msg_passwords_not_equal",!0))})}function setInputAutocompleteOff($el){$el.attr("autocomplete","off")}var isAutocompleteOff=_.has(attrs,"nwFormAutocompleteOff");isAutocompleteOff&&function(){element.attr("autocomplete","off");var $fakePassword=angular.element("<div><input/><input type='password' id='prevent_autofill' /></div>");$fakePassword.css({overflow:"hidden",width:"0px",height:"0px"}),element.prepend($fakePassword)}(),element.on("submit",function(){submitHandler()}),scope.$on("formSubmit",function(){$timeout(function(){submitHandler()},0)}),scope.$on("goToErrorForm",function(event,data){data&&submitHandler()}),scope.$on("resetErrorForm",function(event,data){data&&element.removeClass("nw-form-apply")}),scope.$watchCollection("[config.user.confirm, config.user.password]",function(){isEqualPasswords()})}}}),nw.directive("nwField",["translate","$timeout","$compile","fieldConfig",function(translate,$timeout,$compile,fieldConfig){var template,replace="material"===fieldConfig.style?!0:!1;return"material"==fieldConfig.style?template='<label class="nwfield_element"ng-class="{ nwfield_required_error: error == \'msg_input_is_empty\', invalid: error}"><div class="nwfield_content"><div ng-transclude></div></div><div class="nwfield_valid" ng-if="!nwFieldNoValidate"><span ng-bind="error | translate" ng-show="isShowError()"></span></div></label>':"classic"==fieldConfig.style&&(template='<div class="nwfield_element" ng-class="{ nwfield_required_error: error == \'msg_input_is_empty\'}"><div class="nwfield_label" ng-class="{\'nwfield_label_disabled\': isDisabled}"><span ng-bind="nwLabel | translate"></span><span class="sep">:</span><font color="red" ng-show="isRequired && !isDisabled">*</font></div><div class="nwfield_content"><div ng-transclude></div></div><div class="nwfield_valid"><span ng-bind="error | translate" ng-show="isShowError()"></span></div></div>'),{restrict:"A",replace:replace,transclude:!0,scope:{nwLabel:"@",nwLabelCompile:"=",nwRequired:"=",nwDisabled:"=",nwFieldNoValidate:"@"},template:template,link:function($scope,$element,$attr){function attach(input,parentClass){function isVisible(dom){return dom&&"none"!=dom.style.display&&dom.offsetWidth&&dom.offsetHeight}function checkRequired(){$scope.isRequired&&isVisible($element[0])?model.$setValidity("msg_input_is_empty",!isModelEmpty()||model.$pristine):model.$setValidity("msg_input_is_empty",!0)}function isEmptyField(){return!selects.length&&!(model.$viewValue||0===model.$viewValue)}function isModelEmpty(){return _.isUndefined(model.$viewValue)||_.isNaN(model.$viewValue)||_.isNull(model.$viewValue)||!model.$viewValue.toString().length}function checkDisabled(){var eye;$scope.isDisabled&&isVisible($element[0])?(input.parent().hasClass("nweye_wrapper")&&input.parent().find("i").hasClass("nweye_button")&&(eye=input.parent().find("i"),input.prop("type","password"),eye.removeClass("nweye_button"),eye.addClass("nweye_close_button")),input.attr("disabled","disabled")):input.removeAttr("disabled")}"material"==fieldConfig.style&&(label=$compile('<div class="nwfield_label" ng-class="{\'nwfield_label_disabled\': isDisabled}"><span '+function(){return $scope.nwLabelCompile?"nw-bind-html-compile":"ng-bind"}()+'="nwLabel | translate" class="label"ng-class="{ required: isRequired && !isDisabled, placeholder: isFieldEmpty}"></span></div>')($scope),input.after(label));var label,model=input.data("$ngModelController");model&&(parentClass&&input.parent().addClass(parentClass),$scope.$watch(function(){return JSON.stringify([model.$error,input.prop("disabled"),isVisible(input[0])])},function(){var min,max;if($scope.error="",input.prop("disabled")||!isVisible(input[0]))for(var i in model.$error)model.$setValidity(i,!0);else{for(var i in model.$error)if(model.$error[i]){if("msg_value_less_min"==i&&(i=translate(i),min=input.attr("nw-min"),_.isUndefined(min)||(i+=" ("+min+")")),"msg_value_more_max"==i){i=translate(i);var max=input.attr("nw-max");_.isUndefined(max)||(i+=" ("+max+")")}"maxlength"==i&&(i=translate("msg_maxlength_symb"),max=input.attr("ng-maxlength"),_.isUndefined(max)||(i+=" "+max)),$scope.error=i}model.$dirty&&model.$viewValue&&(model.$setViewValue(model.$viewValue),model.$render())}}),$scope.$watch(function(){return JSON.stringify([model.$viewValue,model.$dirty,$scope.nwRequired,$scope.revalidate,$scope.nwDisabled,$scope.nwInputDisabled])},function(){$scope.isRequired=$scope.nwRequired||""===$attr.nwRequired,$scope.isDisabled=$scope.nwDisabled||""===$attr.nwDisabled||$scope.nwInputDisabled,$scope.isFieldEmpty=isEmptyField(),checkRequired(),checkDisabled()}),$timeout(function(){$scope.revalidate=!0},200))}var $input,isHiddenPass,input_watches,$selects,input=$element.find("input"),selects=$element.find("select");(input.length||selects.length)&&(input.length&&($input=angular.element(input),isHiddenPass=!1,input_watches=_.filter(input,function(i){return!_.isUndefined(angular.element(i).attr("nw-validate"))}),0==input_watches.length&&(input_watches=input),_.each(input_watches,function(i){attach(angular.element(i))}),$input.bind("focus",function(){"password"==$input.prop("type")&&"PROTECTED-ad2f4833"==$input.prop("value")&&(isHiddenPass=!0,$input.prop("value","")),$scope.elementFocus=!0,$scope.$apply()}),$input.bind("blur",function(){"password"==$input.prop("type")&&isHiddenPass&&""==$input.prop("value")?isHiddenPass&&$input.prop("value","PROTECTED-ad2f4833"):"password"==$input.prop("type")&&""==$input.prop("value").trim()&&$input.prop("value",""),$scope.elementFocus=!1,$scope.$apply()})),selects.length&&($selects=angular.element(selects),_.each(selects,function(select){attach(angular.element(select),"custom-select")}),$selects.bind("focus",function(){$scope.elementFocus=!0,$scope.$apply()}),$selects.bind("blur",function(){$scope.elementFocus=!1,$scope.$apply()})),$scope.isShowError=function(){return!$scope.elementFocus&&$scope.error},$scope.$watch(function(){return input.attr("nw-input-disabled"),"disabled"==input.attr("nw-input-disabled")},function(value){$scope.nwInputDisabled=value}))}}}]),nw.directive("nwFieldGroup",[function(){return{restrict:"A",link:function($scope,$element){$element.addClass("nwfield_group"),$element.addClass("clearfix"),$scope.$watch(function(){return $element.children().length},function(){var $children=$element.children();$children.addClass("nwfield_group_element"),1==$children.length&&$children.addClass("nwfield_group_element--c12"),2==$children.length&&$children.addClass("nwfield_group_element--c6")})}}}]),nw.directive("nwEyeText",[function(){return{restrict:"A",link:function($scope,$element,$attrs){var i,text=$attrs.nwEyeText,hidden="";if("PROTECTED-ad2f4833"!=text)for(var i=0;i<_.size(text);i++)hidden+="*";else for(i=0;6>i;i++)hidden+="*";var $value=angular.element("<span></span>"),$btn=angular.element('<i class="nweye_close_button text noselect"></i>');return $element.prepend($value),"PROTECTED-ad2f4833"==text?void $value.text(hidden):($element.prepend($btn),$btn.bind("mousedown touchstart",function(){$value.text()==hidden?($value.text(text),$btn.removeClass("nweye_close_button"),$btn.addClass("nweye_button")):($value.text(hidden),$btn.removeClass("nweye_button"),$btn.addClass("nweye_close_button"))}),void $value.text(hidden))}}}]),nw.directive("nwEye",[function(){return{restrict:"A",link:function($scope,$element,$attrs){function isDisabled(){return $element.prop("disabled")}function isSecretKey(){return"PROTECTED-ad2f4833"==$element.prop("value")}var $parent=$element.parent(),$btn=angular.element('<i class="nweye_close_button noselect"></i>'),enable=$scope.$eval($attrs.nwEye);enable!==!1&&($parent.addClass("nweye_wrapper"),$parent.prepend($btn)),$btn.bind("mousedown touchstart",function(event){"password"==$element.prop("type")?($element.prop("type","text"),$btn.removeClass("nweye_close_button"),$btn.addClass("nweye_button")):($element.prop("type","password"),$btn.removeClass("nweye_button"),$btn.addClass("nweye_close_button")),event.preventDefault()}),$scope.$watch(function(){return isDisabled()||isSecretKey()},function(needHide){needHide?$btn.css("display","none"):$btn.css("display","block")}),$scope.$on("$destroy",function(){$parent.removeClass("nweye_wrapper"),$btn.unbind("mousedown")})}}}]),nw.directive("nwCustomValid",function(){return{restrict:"A",require:"ngModel",scope:{validation:"&nwCustomValid"},link:function($scope,$element,$attrs,$model){function checkError(){var params={},args=$scope.args;return _.isUndefined($model.$modelValue)?null:($scope.args&&$scope.args[0]&&(params[args[0]]=$model.$modelValue),$scope.validation(params))}function updateValidation(error){var isError;_.isNull(error)||($scope.validationType=error),$scope.validationType&&(isError=_.isNull(error),$model.$setValidity($scope.validationType,isError))}$scope.validationType,$scope.args=[],$scope.parseAttrs=function(){var reg=/\((.*)\)/,attr=$attrs.nwCustomValid,matches=attr.match(reg);matches&&matches.length&&matches[1]&&($scope.args=matches[1].replace(/\s/g,"").split(","))},$scope.parseAttrs(),$scope.$watch(checkError,updateValidation),$scope.$watch(function(){return"none"!=$element[0].style.display&&$element[0].offsetWidth&&$element[0].offsetHeight&&!$element[0].disabled},function(visible){visible&&String($model.$modelValue).length&&updateValidation(checkError())}),$scope.$watch("validationType",function(newType,oldType){newType&&oldType&&newType!=oldType&&$model.$setValidity(oldType,!0)})}}}),nw.directive("nwMinvalue",function(){return{restrict:"A",require:"ngModel",link:function($scope,$element,$attrs,$model){var isValid=function(s){return!_.isFinite(s)||parseInt(s)>=parseInt($attrs.nwMinvalue)};$model.$parsers.unshift(function(viewValue){return $model.$setValidity("msg_value_less_min",isValid(viewValue)),viewValue}),$model.$formatters.unshift(function(modelValue){return $model.$setValidity("msg_value_less_min",isValid(modelValue)),modelValue}),$element.attr("min",$attrs.nwMinvalue)}}}),nw.directive("nwMaxvalue",function(){return{restrict:"A",require:"ngModel",link:function($scope,$element,$attrs,$model){var isValid=function(s){return!_.isFinite(s)||parseInt(s)<=parseInt($attrs.nwMaxvalue)};$model.$parsers.unshift(function(viewValue){return $model.$setValidity("msg_value_more_max",isValid(viewValue)),viewValue}),$model.$formatters.unshift(function(modelValue){return $model.$setValidity("msg_value_more_max",isValid(modelValue)),modelValue}),$element.attr("max",$attrs.nwMaxvalue)}}}),nw.directive("nwNumber",function(){var patt_number=/(^-?[0-9]+$)/;return{restrict:"A",require:"ngModel",link:function($scope,$el,$attrs,$model){function parser(value){if(skipCheckNumberValidation())return prepareValidValue(value);_.each(validators,function(validator){var result;return _.isEmpty(value)||_.isUndefined(value)||$attrs.disabled?($model.$setValidity(validator.error,!0),!0):(result=validator.validate(value),$model.$setValidity(validator.error,result),result)});var isValid=$model.$valid;return value=isValid&&_.isFinite(parseInt(value))?"string"==$attrs.nwNumberType?value.toString():parseInt(value):"string"==$attrs.nwNumberType?"":void 0}function getValue(valueGetters){return _.isFunction($scope[valueGetters.fn])?$scope[valueGetters.fn]():valueGetters.val}function prepareValidValue(value){return"string"==$attrs.nwNumberType?value:parseInt(value)}function skipCheckNumberValidation(){var currentErrors=function(){var result=[];return $model&&$model.$error?(_.each($model.$error,function(value,name){value&&result.push(name)}),result):result}(),numberErrors=_.pluck(validators,"error");return _.some(currentErrors,function(value){return!_.contains(numberErrors,value)})}var validators=[];(_.has($attrs,"nwMin")||_.has($attrs,"nwMinFn"))&&validators.push({validate:function(value){return!_.isFinite($scope.minValue)||parseInt(value)>=parseInt($scope.minValue)},error:"msg_value_less_min"}),(_.has($attrs,"nwMax")||_.has($attrs,"nwMaxFn"))&&validators.push({validate:function(value){return!_.isFinite($scope.maxValue)||parseInt(value)<=parseInt($scope.maxValue)},error:"msg_value_more_max"}),validators.push({validate:function(value){return patt_number.test(value)&&_.isFinite(parseInt(value))},error:"msg_invalid_number"}),$model.$parsers.unshift(parser),$model.$formatters.unshift(parser);var min=getValue({val:$attrs.nwMin,fn:$attrs.nwMinFn}),max=getValue({val:$attrs.nwMax,fn:$attrs.nwMaxFn});min&&($scope.minValue=min),max&&($scope.maxValue=max),$attrs.$observe("nwMin",function(value){_.isUndefined(value)||($scope.minValue=min=parseInt(value))}),$attrs.$observe("nwMax",function(value){_.isUndefined(value)||($scope.maxValue=max=parseInt(value))})}}}),nw.directive("nwMacNotNullAndNotMulticast",function(){return{restrict:"A",require:"ngModel",link:function($scope,$element,$attrs,$model){function isMac(mac){var pattern=/^([0-9a-fA-F][0-9a-fA-F][-:]){5}[0-9a-fA-F][0-9a-fA-F]$/;return pattern.test(mac)}function isNullMac(mac){var pattern=/^(00[-:]){5}(00)$/;return pattern.test(mac)}function isMulticastMac(mac){var pattern=/^[0-9a-fA-F][13579bBdDfF][-:]([0-9a-fA-F][0-9a-fA-F][-:]){4}[0-9a-fA-F][0-9a-fA-F]$/;return pattern.test(mac)}function unshiftFn(value){return _.isUndefined(value)||!value.toString().length||$attrs.disabled?($model.$setValidity("msg_invalid_mac",!0),$model.$setValidity("msg_err_null_mac",!0),$model.$setValidity("msg_err_multicast_mac",!0)):($model.$setValidity("msg_invalid_mac",isMac(value)),$model.$setValidity("msg_err_null_mac",!isNullMac(value)),$model.$setValidity("msg_err_multicast_mac",!isMulticastMac(value))),value}$model.$parsers.unshift(unshiftFn),$model.$formatters.unshift(unshiftFn),$element.on("change",function(){var newValue,value=unshiftFn($element.val()),isValidValue=isMac($element.val())&&!isNullMac($element.val())&&!isMulticastMac($element.val());!_.isUndefined(value)&&isValidValue&&(newValue=$element.val().replace(/-/g,":").toUpperCase(),$model.$setViewValue(newValue),$model.$render()),$scope.$apply()})}}}),nw.directive("nwNotCyrillicChar",function(){return{restrict:"A",require:"ngModel",link:function($scope,$element,$attrs,$model){function hasCyrillicChar(value){var patt=/[АаБбВвГгДдЕеЁёЖжЗзИиЙйКкЛлМмНнОоПпРрСсТтУуФфХхЦцЧчШшЩщЪъЫыЬьЭэЮюЯя]+/g;return value?!patt.test(value):!0}function change(value){var result;return _.isUndefined(value)||!value.toString().length||$attrs.disabled?$model.$setValidity("msg_invalid_not_cyrillic_char",!0):(result=hasCyrillicChar(value),$model.$setValidity("msg_invalid_not_cyrillic_char",result)),value}$model.$parsers.unshift(change),$model.$formatters.unshift(change)}}}),nw.directive("nwSelect",[function(){return{restrict:"AEC",transclude:!0,scope:{nwSelect:"=",ngModel:"="},template:'<div class="nwselect">	  <select ng-model="ngModel" ng-options="value.id as value.name group by value.group for value in nwSelect">	  </select></div>',controller:function(){}}}]),nw.directive("nwCheckbox",function(){return{restrict:"A",replace:!0,transclude:!0,scope:{nwLabel:"@"},template:'<div class="nwcheckbox"><div ng-transclude></div><i class="nwcheckbox_switch"></i><span ng-if="nwLabel" class="nwcheckbox_label" ng-bind="nwLabel | translate"></span></div>',link:function($scope,$element){var $switch=angular.element($element.find("i")),$input=angular.element($element.find("input")),$model=$input.data("$ngModelController");$scope.$watch(function(){return $model.$modelValue},function(value){value?$switch.addClass("nwcheckbox_switch--checked"):$switch.removeClass("nwcheckbox_switch--checked")}),$element.bind("click",function(){$scope.$apply(function(){$model.$setViewValue(!$model.$modelValue)})})}}}),nw.directive("nwRadio",function(){return{restrict:"A",replace:!0,transclude:!0,scope:{nwLabel:"@",nwValue:"="},template:'<div class="nwradio"><div ng-transclude></div><svg class="icon svg_checked" fill="#000000" height="24" width="24" viewBox="0 2 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm0-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"/><path d="M0 0h24v24H0z" fill="none"/></svg><svg class="icon svg_unchecked" fill="#000000" height="24" viewBox="0 2 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"/><path d="M0 0h24v24H0z" fill="none"/></svg><span ng-if="nwLabel" class="nwradio_label" ng-bind="nwLabel | translate"></span></div>',link:function($scope,$element){function isDisabled(){return $input.attr("disabled")}var $radio=angular.element($element.find("svg")),$input=angular.element($element.find("input")),$model=$input.data("$ngModelController");$scope.$watch(function(){return $model.$modelValue},function(value){value==$scope.nwValue?$radio.addClass("nwradio_switch--checked"):$radio.removeClass("nwradio_switch--checked")}),$scope.$watch(isDisabled,function(){isDisabled()?$radio.addClass("nwradio_switch--disabled"):$radio.removeClass("nwradio_switch--disabled")}),$element.bind("click",function(){isDisabled()||$scope.$apply(function(){$model.$setViewValue($scope.nwValue)})})}}}),nw.directive("nwRadioGroup",function(){return{restrict:"A",replace:!0,compile:function($element,$attrs){var template="";$attrs.nwLabel&&(template+="<div class='label radio-group-label' ng-bind=\"'"+$attrs.nwLabel+"' | translate\" ></div>"),template+='<div ng-repeat="option in '+$attrs.nwOptions+'"><div class="radio-field" nw-radio nw-label="{{option.label}}" nw-value="option.value"><input type="radio" ng-model="'+$attrs.nwModel+'" ng-change="'+$attrs.nwChange+'" ng-disabled="{{option.disabled}}"></div></div>',$element.append(template)}}}),nw.directive("nwSwitch",[function(){return{restrict:"AEC",scope:{nwSwitch:"="},template:'<div class="nwswitch">                     <div class="container" ng-class="{onright: nwSwitch}">                        <div class="switch_button">                            </div></div>                        <div ng-click="change()" class="switch_touch">                    </div>                </div>',controller:function($scope){$scope.change=function(){$scope.nwSwitch=!$scope.nwSwitch}}}}]),nw.directive("nwLabeledSwitch",["translate",function(){var classes="nw_labeled_switch switch";return{restrict:"A",transclude:!0,template:'<label class="'+classes+'"><input type="checkbox"><div class="thumb"><div class="track"></div></div><div class="label-wrapper"><span class="label"></span></div></label>',compile:function($element,$attr){function isFuncsAttr(attr){return/\(.*\)$/.test(attr)}var template,element,input=$element.find("input"),label=$element.find("span");$attr.nwLabel&&(isFuncsAttr($attr.nwLabel)?label.attr("ng-bind",""+$attr.nwLabel):label.attr("ng-bind","'"+$attr.nwLabel+"' | translate")),$attr.nwModel&&input.attr("ng-model",$attr.nwModel),$attr.nwChange&&input.attr("ng-change",$attr.nwChange),$attr.nwDisabled&&input.attr("ng-disabled",$attr.nwDisabled),$attr.schedule&&(template='<div nw-scheduler-icon id-rule="'+$attr.schedule+'" indexes-link="'+$attr.scheduleIndexesLink+'"is-exists-schedule="'+$attr.scheduleExists+'"value-model="'+$attr.nwModel+'"is-disabled="'+$attr.scheduleDisabled+'"></div>',element=angular.element(template),$element.append(element),$element.css({display:"flex"}));var wrap=$element.find("label");$attr["class"]&&wrap.attr("class",classes+" "+$attr["class"])}}}]),nw.directive("nwAddToEnd",[function(){return{restrict:"A",link:function($scope,$element,$attrs){var $postfix,$parent,$input,width;$attrs.nwAddToEnd&&($postfix=angular.element('<span class="postfix">'+$attrs.nwAddToEnd+"</span>"),$parent=$element.parent(),$input=$parent.find("input"),$parent.addClass("postfix_wrapper"),$parent.prepend($postfix),width=$input[0].offsetWidth-$postfix[0].offsetWidth,$input.css({width:width+"px"}))}}}]),nw.directive("nwAddButton",["$compile",function($compile){return{restrict:"A",scope:{buttonHandler:"&nwAddButton",buttonText:"@nwAddButtonText",buttonIcon:"@nwAddButtonIcon",buttonShow:"=nwAddButtonShow"},link:function($scope,$element,$attrs){var $postfix,buttonText,$parent;$attrs.nwAddButton&&(buttonText=$scope.buttonText||"",$postfix=$scope.buttonIcon?$compile('<a class="post-icon" title="{{\''+buttonText+'\' | translate}}" ng-click="buttonHandler($event)"  ng-show="buttonShow"><i svg-icon="'+$scope.buttonIcon+'" ></i></a>')($scope):$compile('<a class="button colored post-button" ng-click="buttonHandler($event)" ng-show="buttonShow">{{"'+buttonText+'" | translate}}</a>')($scope),$parent=$element.parent(),$parent.addClass("postfix_wrapper"),$parent.prepend($postfix),$scope.$watch("buttonShow",function(needShow){var $button=$parent.find("a"),width=$button[0].offsetWidth+10;needShow?$element.css("width","calc(100% - "+width+"px)"):$element.css("width","100%")}))}}}])}();
;"use strict";!function(){var nw=angular.module(regdep("nw-type"),[]);nw.directive("nwType",function(funcs){return{restrict:"A",require:"ngModel",link:function($scope,$element,$attrs,$model){function change(value){function getLangKey(type){var key;return"maskv4"==type||"maskv6"==type?"msg_invalid_mask":"hostv6"==type?"msg_invalid_host":"psk"==type?"wifi_invalid_psk":"notCyrillicChar"==type||"ipv4AddressOrSubnet"==type||"pppPassword"==type?(key=type.replace(/([a-z0-9])([A-Z])/g,"$1_$2").toLowerCase(),"msg_invalid_"+key):"msg_invalid_"+type}var result,validator=validators[$attrs.nwType];return validator&&(_.isUndefined(value)||!value.toString().length||$attrs.disabled?$model.$setValidity(getLangKey($attrs.nwType),!0):(result=validator(value),$model.$setValidity(getLangKey($attrs.nwType),result))),"number"==$attrs.nwType&&(value=parseInt(value)),value}var posInteger=function(value){var patt=/^[0-9]$|^[1-9][0-9]*$/;return patt.test(value)?!0:!1},isIpv4=function(value){var patt=/^(0|[1-9]?\d|1\d\d|2[0-4]\d|25[0-5])\.(0|[1-9]?\d|1\d\d|2[0-4]\d|25[0-5])\.(0|[1-9]?\d|1\d\d|2[0-4]\d|25[0-5])\.(0|[1-9]?\d|1\d\d|2[0-4]\d|25[0-5])$/;return patt.test(value)?!0:!1},checkMask=function(mask,version){var endrange,bits,i,octet,flagmask,j,arr=mask.split("."),len=arr.length;switch(len){case 1:if(endrange="4"==version?32:128,!checkMaskRange(arr[0],0,endrange))return!1;break;case 4:if(!isIpv4(mask)||"4"!=version&&"46"!=version)return!1;for(bits="",i=0;4>i;i++){if(!posInteger(arr[i]))return!1;octet=parseInt(arr[i]),bits+=0==octet?"00000000":octet.toString(2)}if(32!=bits.length)return!1;for(flagmask="1"==bits.charAt(0)?!1:!0,j=1;j<=bits.length;j++)if(0==bits.charAt(j)&&(flagmask=!0),1==bits.charAt(j)&&flagmask)return!1;break;default:return!1}return!0},checkMaskRange=function(val,start_range,end_range){return!_.isNaN(parseInt(val))&&posInteger(val)?parseInt(val)<start_range||parseInt(val)>end_range?!1:!0:!1},validators={ip:function(value){return validators.ipv4(value)||validators.ipv6(value)},ipv4AddressOrSubnet:function(value){return funcs.is.ipv4(value)||funcs.is.ipv4Network(value)},ipv4:function(value){return isIpv4(value)},ipv6:function(value){var arrValue,patt=/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/;return _.isString(value)?(arrValue=value.split("/"),arrValue.length<=2&&(_.isUndefined(arrValue[0])||patt.test(arrValue[0]))&&(_.isUndefined(arrValue[1])||checkMask(arrValue[1],"6"))?!0:!1):!1},mask:function(value){return checkMask(value,"46")},maskv4:function(value){return checkMask(value,"4")},maskv6:function(value){return checkMask(value,"6")},prefixv6:function(value){if(_.isUndefined(value))return!1;var prefixInt=parseInt(value);return prefixInt>=0&&128>=prefixInt},url:function(value){var tmp,tmp2,patt=/^(?:(?:https?):\/\/)?(?:\S+(?::\S*)?@)?(?:(?:(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4])))|(\[.*\])|(?:(?:(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,}))))(?::\d{2,5})?(?:\/[^\s]*)?$/i;return patt.test(value)?(tmp=value.split("["),tmp[1]&&(tmp2=tmp[1].split("]"),!funcs.is.ipv6(tmp2[0])||"::"==(funcs.is.ipv6(tmp2[0])&&funcs.ipv6.address["short"](tmp2[0])))?!1:!0):!1},number:function(value){var patt_number=/(^-?[0-9]+$)/;return patt_number.test(value)?!0:!1},domain:function(host){var host=host||"",regDomain=/^[а-яА-Яa-zA-Z0-9]+([\-]{0,2}[а-яА-Яa-zA-Z0-9])*$/;if(host=host.replace(/(^\s+|\s+$)/g,""),host.length>255)return!1;var domains=host.split(".");for(var i in domains)if(domains[i].length<1||domains[i].length>63||!regDomain.test(domains[i]))return!1;return!0},host:function(_host){return _host?validators.domain(_host)||validators.ipv4(_host):!0},hostv6:function(host){return host?validators.domain(host)||validators.ipv6(host):!0},mac:function(value){var patt_mac=/^([0-9a-fA-F][0-9a-fA-F][-:]){5}([0-9a-fA-F][0-9a-fA-F])$/;return patt_mac.test(value)},digits:function(val){return val?/^[0-9]*$/.test(val):!0},port:function(val){var patt=/^[0-9]*$/;return val&&(val=val.match(/\S+/)[0]),patt.test(val)?!0:!1},pppPassword:function(str){var patt;return str&&(patt=/[А-яёЁ]/,patt.test(str))?!1:!0},notCyrillicChar:function(str){var patt=/[АаБбВвГгДдЕеЁёЖжЗзИиЙйКкЛлМмНнОоПпРрСсТтУуФфХхЦцЧчШшЩщЪъЫыЬьЭэЮюЯя]+/g;return str?!patt.test(str):!0},psk:function(str){return!str||str.length>=8&&str.length<=63?!0:!1},ploam:function(str){var patt;return str&&(patt=/^\d{10}$/,!patt.test(str))?!1:!0},mail:function(str){var patt=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return str?patt.test(str):!0},network_address_v4:function(value){var ip,mask,net;return funcs.is.ipv4(value)||funcs.is.ipv4Network(value)?funcs.is.ipv4Network(value)&&(ip=value.split("/")[0],mask=value.split("/")[1],net=funcs.ipv4.address.and(ip,funcs.ipv4.mask["long"](mask)),ip!=net)?!1:!0:!1},network_address_v6:function(value){var ip,prefix,net;return funcs.is.ipv6(value)||funcs.is.ipv6Network(value)?funcs.is.ipv6Network(value)&&(ip=value.split("/")[0],prefix=value.split("/")[1]?value.split("/")[1]:"128",net=funcs.ipv6.subnet.getNetworkAddress(ip,prefix),funcs.ipv6.address.full(ip.toUpperCase())!=funcs.ipv6.address.full(net.toUpperCase()))?!1:!0:!1}};$model.$parsers.unshift(change),$model.$formatters.unshift(change),"mac"==$attrs.nwType&&$element.on("change",function(){var newValue,value=change($element.val()),isValidValue=validators.mac($element.val());value&&void 0!=value&&isValidValue&&(newValue=value.replace(/-/g,":").toUpperCase(),$model.$setViewValue(newValue),$model.$render()),$scope.$apply()})}}})}();
;"use strict";!function(){var nw=angular.module(regdep("nw-file-upload-form"),[]);nw.directive("nwFileUploadForm",["$rootScope","$timeout","$http",function($rootScope,$timeout,$http){return{restrict:"AE",replace:!1,scope:{nwUploadUrl:"@",nwUploadUrlParams:"&",nwUploadBefore:"&",nwUploadBegin:"&",nwUploadEnd:"&",nwUseFormData:"=",nwFieldButtonTitle:"@",nwSubmitTitle:"@",nwButtonBlockClass:"@",nwSubmitButtonClass:"@"},template:'<form method="POST" enctype="multipart/form-data"  target="nwFileUploadFormTarget" class="nw_file_upload_form"><label class="nw_file nwfield_content"><div class="button">{{nwFieldButtonTitle | translate}}</div><div class="input">{{filename || (\'file_not_selected\' | translate)}}</div><input type="file" name="file"></label><div class="button_block {{nwButtonBlockClass}}"><button type="submit"class="{{nwSubmitButtonClass}}"ng-disabled="!filename" >{{nwSubmitTitle | translate}}</button></div></form>',link:function($scope,$element){function getUrlParams(){var getUploadUrlParams;return _.isFunction($scope.nwUploadUrlParams)?(getUploadUrlParams=$scope.nwUploadUrlParams(),_.reduce(getUploadUrlParams(),function(memo,value,key){return memo+(memo?"&":"?")+key+"="+encodeURIComponent(value)},"")):""}{var iframe,uniq_iframe=_.uniqueId("nw_upload_iframe"),form=$element.find("form"),input=form.find("input").eq(0);form.find("input").eq(1),form.find("input").eq(2)}form.after('<iframe name="'+uniq_iframe+'" id="'+uniq_iframe+'" width="0" height="0" frameborder="0" />'),iframe=$element.find("iframe"),form.attr("target",uniq_iframe),form.attr("action",$scope.nwUploadUrl),input.bind("change",function(){$scope.fileSelect(input[0].value)}),form.bind("submit",function(e){function handler(){isSupportFormData()?formDataUpload():iframeUpload()}function isSupportFormData(){return $scope.nwUseFormData&&void 0!==window.FormData}function iframeUpload(){form[0].submit(),window[uniq_iframe]=!0,$scope.nwUploadBegin&&$scope.nwUploadBegin()()}function formDataUpload(){var payload=new FormData;return payload.append("file",input[0].files[0]),$timeout(function(){$scope.nwUploadBegin&&$scope.nwUploadBegin()()}),$http({url:$scope.nwUploadUrl+getUrlParams(),method:"POST",data:payload,headers:{"Content-Type":void 0},transformRequest:angular.identity}).then(function(result){$scope.nwUploadEnd()({data:result.data})},function(err){$scope.nwUploadEnd()({data:err})})}e.preventDefault();var fwUploadBegin=$scope.nwUploadBefore();fwUploadBegin?fwUploadBegin(handler):handler()}),iframe.bind("load",function(e){var data,json;if(window[uniq_iframe]&&(data=angular.element(e.target).contents().find("body").text(),$scope.nwUploadEnd&&data))try{json=JSON.parse(data),$scope.nwUploadEnd()({data:json})}catch(e){$scope.nwUploadEnd()({data:data})}}),$scope.fileSelect=function(path){$scope.filename=path.slice(path.lastIndexOf("\\")+1),$scope.$digest()}}}}])}();
;"use strict";!function(){var nw=angular.module(regdep("nw-menu-upload"),[]);nw.directive("nwMenuUpload",["$rootScope","$timeout","$http",function($rootScope,$timeout,$http){return{restrict:"AE",replace:!1,scope:{nwUploadUrl:"@",nwUploadPrepare:"&",nwUploadBegin:"&",nwUploadEnd:"&",nwUseFormData:"=",nwUploadTitle:"@",nwUploadDesc:"@",nwUploadClass:"@"},template:'<span class="addlink {{nwUploadClass}}" ng-click="clickFile(); $event.stopPropagation(); $event.preventDefault();"> <form method="POST" enctype="multipart/form-data" target="nwMenuUploadTarget">    <input type="file" name="file" class="hidden_element">    <label class="button">{{nwUploadTitle | translate}}</label> </form>   <span>{{nwUploadDesc | translate}}</span></span>',link:function($scope,$element){var uniq_iframe=_.uniqueId("nw_upload_iframe"),form=$element.find("form");form.after('<iframe name="'+uniq_iframe+'" id="'+uniq_iframe+'" width="0" height="0" frameborder="0" />');var iframe=$element.find("iframe"),input=form.find("input").eq(0),label=form.find("label"),uniq_label=_.uniqueId("nw_upload_label");input.attr("id",uniq_label),label.attr("for",$scope.nwUploadUrl),form.attr("target",uniq_iframe),form.attr("action",$scope.nwUploadUrl),$element.addClass("nw_menu_upload"),$scope.clickFile=function(){input[0].click()},input.bind("change",function(){function formDataUpload(){function handler(){var payload=new FormData;return payload.append("file",input[0].files[0]),$timeout(function(){$scope.nwUploadBegin&&$scope.nwUploadBegin()}),$http({url:$scope.nwUploadUrl,method:"POST",data:payload,headers:{"Content-Type":void 0},transformRequest:angular.identity}).then(function(result){$scope.nwUploadEnd({data:result.data})},function(err){$scope.nwUploadEnd({data:err})})}$scope.nwUploadPrepare?$scope.nwUploadPrepare({cb:handler}):handler()}function iframeUpload(){window[uniq_iframe]=!0,$scope.nwUploadPrepare&&$scope.nwUploadPrepare(),form[0].submit(),$rootScope.$emit("request.started",{config:{url:$scope.nwUploadUrl}}),$scope.nwUploadBegin&&$scope.nwUploadBegin()}(function(){return $scope.nwUseFormData&&void 0!==window.FormData})()?formDataUpload():iframeUpload()}),iframe.bind("load",function(e){var data,json;if(window[uniq_iframe]){try{data=angular.element(e.target).contents().find("body").text()}catch(e){$rootScope.$emit("request.failed",{config:{url:$scope.nwUploadUrl}}),$scope.nwUploadEnd()}if($scope.nwUploadEnd&&data){$rootScope.$emit("request.succeed",{config:{url:$scope.nwUploadUrl}});try{json=JSON.parse(data),$scope.nwUploadEnd({data:json})}catch(e){$scope.nwUploadEnd({data:data})}}}})}}}])}();
;"use strict";!function(){var nw=angular.module(regdep("nw-flat-switch"),[]);nw.directive("nwFlatSwitch",function(){return{restrict:"A",scope:!0,controller:function($scope){$scope.changeState=function(){$scope.state=!$scope.state,$scope.nwAction()}},template:'<div class="button_block no_top_margin"><button type="button" class="colored flat no_margin no_min_width" ></button><button type="button" class="colored flat no_margin no_min_width" ></button></div>',compile:function($elem,$attr){var state=$attr.nwState,textEn=$attr.nwTextEnable,textDis=$attr.nwTextDisable,action=$attr.nwAction,buttons=$elem.find("button"),but1=angular.element(buttons[0]),but2=angular.element(buttons[1]);but1.attr("ng-bind","'"+textEn+"' | translate"),but1.attr("ng-if","!"+state),but1.attr("ng-click",state+" = !"+state+"; "+action+"()"),$attr.nwDisabled&&but1.attr("ng-disabled",$attr.nwDisabled),but2.attr("ng-bind","'"+textDis+"' | translate"),but2.attr("ng-if",state),but2.attr("ng-click",state+" = !"+state+"; "+action+"()"),$attr.nwDisabled&&but2.attr("ng-disabled",$attr.nwDisabled)}}})}();
;"use strict";!function(){var nw=angular.module(regdep("nw-view-line"),[]);nw.directive("nwViewLine",["$q","$timeout","translate",function($q){return{restrict:"A",replace:!0,scope:{possibleViews:"=nwViewLinePossibleViews",state:"=nwViewLineState",changeViewPrepare:"&nwViewLineChangeViewPrepare",changeViewSuccess:"&nwViewLineChangeViewSuccess"},template:'<div class="view-general-line"><span class="view-general-tabs" ng-repeat="view in possibleViews" ng-click="changeView($event, view.value)" ng-class="{\'view-general-tabs--active\': view.value == state}"ng-bind="view.description | translate"></span></div>',link:function($scope,$element,$attrs){function hasFunction(name){var attr=$attrs["nwViewLine"+capitalizeFirstLetter(name)];return _.isUndefined(attr)?!1:!0}function getFunctionArgs(name){if(!hasFunction(name))return[];var reg=/\((.*)\)/,attr=$attrs["nwViewLine"+capitalizeFirstLetter(name)],matches=attr.match(reg);return matches&&matches.length&&matches[1]?matches[1].replace(/\s/g,"").split(","):[]}function capitalizeFirstLetter(str){return str.charAt(0).toUpperCase()+str.slice(1)}var changeViewPrepare={has:hasFunction("changeViewPrepare"),args:getFunctionArgs("changeViewPrepare")},changeViewSuccess={has:hasFunction("changeViewSuccess"),args:getFunctionArgs("changeViewSuccess")};$scope.changeView=function($event,nextView){function isSuccess(){return changeViewSuccess.has}function prepare(){var params=getParams(changeViewPrepare.args);$q.when($scope.changeViewPrepare(params)).then(function(value){value&&isSuccess()&&success()})}function success(){var params=getParams(changeViewSuccess.args);$scope.changeViewSuccess(params)}function getParams(args){var params={};return params[args[0]]=nextView,params[args[1]]=$scope.state,params}return function(){return changeViewPrepare.has}()?void prepare():void(isSuccess()&&success())},$scope.$watch("possibleViews",function(views){!_.isUndefined(views)&&_.isUndefined($scope.state)&&($scope.state=$scope.possibleViews[0].value)})}}}])}();
;"use strict";angular.module(regdep("nw-adaptive-grid"),[]).directive("nwAdaptiveGrid",function(){return{restrict:"A",scope:{model:"=nwAdaptiveGrid"},link:function($scope,$element){$scope.$watch("model",function(){var span_padding=10;$element[0].offsetWidth;var width_span=$element[0].children[0].offsetWidth,border=$element[0].offsetWidth-$element[0].clientWidth,path=140,path_span=114,koef=Math.floor(width_span/path_span)-1,k=Math.floor((width_span-koef*span_padding)/path_span)+1;switch(k){case 1:$element.toggleClass("one_cell");break;case 2:$element.toggleClass("two_cells");break;case 3:$element.toggleClass("three_cells");break;case 4:$element.toggleClass("four_cells");break;case 5:$element.toggleClass("five_cells");break;case 6:$element.toggleClass("six_cells");break;case 7:$element.toggleClass("seven_cells")}$element.css("width",path*k-border-2*span_padding+3*(k-1)+"px");var parent_width=$element[0].offsetParent.clientWidth,padding=angular.element(document.querySelector(".checkbox-field"))[0].offsetLeft,max_cells=Math.floor((parent_width-2*padding)/path),elem_mbssid=angular.element(document.querySelector("#mbssid"));elem_mbssid.css("width",parent_width-2*padding+"px"),$element[0].offsetWidth>parent_width-2*padding&&$element.css("width",path*max_cells-border-2*span_padding+3*(max_cells-1)+"px")})}}});
;"use strict";var sorttt;!function(){var nw=angular.module(regdep("nw-table"),[]);nw.directive("nwTable",["$injector","$compile","$q","$timeout","nwTableService",function($injector,$compile,$q,$timeout,nwTableService){var scheduler=$injector.has("scheduler")?$injector.get("scheduler"):{isSupport:!1},postLink=function($scope,$element){$element.prepend($compile("<div nw-table-toolbar></div>")($scope))};return{restrict:"A",scope:{title:"@nwTableTitle",needEmptyTitle:"=nwTableNeedEmptyTitle",desc:"@nwTableDesc",empty:"=nwTableEmptyStatus",emptyDesc:"@nwTableEmptySubtitle",onAdd:"&nwTableOnAdd",onAddDisable:"&nwTableOnAddDisable",onAddHide:"&nwTableOnAddHide",onDelete:"&nwTableOnDelete",onDeleteHide:"&nwTableOnDeleteHide",onEdit:"&nwTableOnEdit",onMessage:"&nwTableOnMessage",onMessageDisable:"&nwTableOnMessageDisable",onMessageHide:"&nwTableOnMessageHide",onCustomEvent:"&nwTableOnCustomEvent",onSecondCustomEvent:"&nwTableOnSecondCustomEvent",customEventName:"@nwTableCustomEventName",secondCustomEventName:"@nwTableSecondCustomEventName",onCustomEventOnSelected:"&nwTableOnCustomEventOnSelected",onCustomEventOnSelectedHide:"&nwTableOnCustomEventOnSelectedHide",matchedFunc:"&nwTableSelectedMatchedFunc",onCustomEventOnSelectedDisable:"&nwTableOnCustomEventOnSelectedDisable",onCustomEventDisable:"&nwTableOnCustomEventDisable",selectedRows:"=?nwTableSelected",sortedFunc:"&nwTableSortedFunc",isSorted:"@nwTableSortedFunc",toolbarDisabled:"&nwTableToolbarDisabled",needShowRow:"&nwTableNeedShowRow"},compile:function($element,$attrs){function hasAttr(name){return!_.isUndefined($attrs[name])}var buttons,$toggleMenu,$divLimit,$divTableFixedContainer,$container=angular.element('<div class="nw-table-empty-container" ng-if="'+$attrs.nwTableEmptyStatus+'"></div>'),$titleEmpty=angular.element('<div class="title" ng-bind="\''+$attrs.nwTableEmptyTitle+"' | translate\"></div>"),$buttonPanel=angular.element('<div class="nwtable_toolbar_rightfloat"></div>');if($attrs.nwTableEmptyButton)if($attrs.nwTableEmptyButtonClick.match("add"))var buttons='<div class="nwtable_toolbar_button_icon" ng-click="'+$attrs.nwTableEmptyButtonClick+"\"ng-class=\"{'disabled_icon' : (nwTable.isAction('addDisable') && onAddDisable()) || toolbarDisabled() }\"ng-hide=\""+$attrs.nwTableOnAddHide+'" title="{{\'act_add\' | translate }}"><div svg-icon="add_icon"></div></div>';else if($attrs.nwTableEmptyButton.match("message"))var buttons='<div class="nwtable_toolbar_button_icon" ng-click="'+$attrs.nwTableEmptyButtonClick+"\"ng-class=\"{'disabled_icon' : (nwTable.isAction('messageDisable') && onMessageDisable()) || toolbarDisabled() }\"ng-hide=\""+$attrs.nwTableOnMessageHide+'" title="{{\'usb_modem_sms_new_message\' | translate }}"><div svg-icon="unread_mess"></div></div>';else buttons='<button type="button" class="colored flat" ng-bind="\''+$attrs.nwTableEmptyButton+'\' | translate"ng-click="'+$attrs.nwTableEmptyButtonClick+'"></button>';$attrs.nwTableEmptyButton2&&(buttons+=$attrs.nwTableEmptyButton2.match("add")?'<div class="nwtable_toolbar_button_icon" ng-click="'+$attrs.nwTableEmptyButton2Click+"\"ng-class=\"{'disabled_icon' : (nwTable.isAction('addDisable') && onAddDisable()) || toolbarDisabled() }\"ng-hide=\""+$attrs.nwTableOnAddHide+'" title="{{\'act_add\' | translate }}"><div svg-icon="add_icon"></div></div>':$attrs.nwTableEmptyButton2.match("message")?'<div class="nwtable_toolbar_button_icon" ng-click="'+$attrs.nwTableEmptyButton2Click+"\"ng-class=\"{'disabled_icon' : (nwTable.isAction('messageDisable') && onMessageDisable()) || toolbarDisabled() }\"ng-hide=\""+$attrs.nwTableOnMessageHide+'" title="{{\'usb_modem_sms_new_message\' | translate }}"><div svg-icon="unread_mess"></div></div>':'<button type="button" class="colored flat" ng-bind="\''+$attrs.nwTableEmptyButton2+'\' | translate"ng-click="'+$attrs.nwTableEmptyButton2Click+'"></button>'),$buttonPanel.append(buttons);var $subtitleEmpty=angular.element('<div class="subtitle" ng-bind="\''+$attrs.nwTableEmptySubtitle+"' | translate\"></div>");$container.append($titleEmpty),$container.append($buttonPanel),$container.append($subtitleEmpty),$element.append($container);var $table=$element.find("table");$table.attr("ng-if","!"+$attrs.nwTableEmptyStatus);var $head=$element.find("thead"),$body=$element.find("tbody"),$row={$head:$head.find("tr"),$body:$body.find("tr")},$cell={$head:$row.$head.find("th")};return $table.addClass("nw-mini-table"),hasAttr("nwMiniTableOff")&&$table.removeClass("nw-mini-table"),$row.$head.attr("nw-table-head-row",""),$row.$body.attr("nw-table-row",""),(hasAttr("nwTableSelected")||hasAttr("nwTableOnEdit"))&&$row.$body.attr("nw-table-row-action",""),hasAttr("nwTableSelected")&&!hasAttr("nwTableSorted")&&($row.$head.attr("nw-table-row-select-all",""),$row.$body.attr("nw-table-row-select","")),hasAttr("nwTableSelected")&&hasAttr("nwTableSorted")&&$row.$body.attr("nw-table-row-select",""),hasAttr("nwTableOnEdit")&&$row.$body.attr("nw-table-row-click",""),scheduler.isSupport&&($row.$head.attr("nw-table-schedule-column","head"),$row.$body.attr("nw-table-schedule-column","")),hasAttr("nwTableSorted")&&(hasAttr("nwTableSelected")&&$row.$head.attr("nw-table-row-sorted-and-select-all",""),hasAttr("nwTableSelected")||$row.$head.attr("nw-table-row-sorted",""),$toggleMenu=angular.element("<div></div>"),$toggleMenu.addClass("block_toggle_menu"),_.each($cell.$head,function(elem){var $thSpan,$thSpan2,$cell=angular.element(elem),itemMenu=angular.element("<div class='item_toggle_menu'></div>"),param=$cell.attr("nw-table-sort-param");$cell.attr("ng-bind")&&($thSpan=angular.element("<span></span>"),$thSpan.attr("ng-bind",$cell.attr("ng-bind")),$thSpan2=angular.element("<span class='toggle_text'></span>"),$thSpan2.attr("ng-bind",$cell.attr("ng-bind")),$cell.append($thSpan),itemMenu.addClass("sortable"),itemMenu.attr("ng-click",'rearrangeColumn($event, "'+param+'")'),itemMenu.attr("ng-class",'getColumnClass("'+param+'")'),itemMenu.append($thSpan2),$cell.removeAttr("ng-bind"));var $arrow=angular.element('<span class="sortable-icon-box"><svg svg-icon="arrow"></svg></span>'),$arrow2=angular.element('<span class="sortable-icon-box"><svg svg-icon="arrow"></svg></span>');$cell.append($arrow),itemMenu.append($arrow2),$toggleMenu.append(itemMenu)}),$row.$head.append($toggleMenu)),hasAttr("nwTableLimit")&&($divLimit=angular.element("<div class='nwtable_limit'></div>"),$divTableFixedContainer=angular.element("<div class='nwtable_fixed-container'></div>"),$divLimit.append($table),$divTableFixedContainer.append($divLimit),_.each($cell.$head,function(elem){var $thSpan,$divFixed=angular.element("<div class='nwtable_fixed-cell'></div>"),$cell=angular.element(elem);$cell.attr("ng-bind")?($thSpan=angular.element("<span></span>"),$thSpan.attr("ng-bind",$cell.attr("ng-bind")),$cell.append($thSpan),$divFixed.attr("ng-bind",$cell.attr("ng-bind")),$cell.append($divFixed),$cell.removeAttr("ng-bind")):($divFixed.append($cell.clone().contents()),$cell.append($divFixed))}),$row.$head.addClass("nwtable_fixed-header"),$element.append($divTableFixedContainer)),postLink},controller:function($scope,$element,$attrs){function findSelectedIndex(item,key){var inx,items=self.selected;for(inx=0;inx<items.length;inx++){if(items[inx].key==key)return inx;if(_.isEqual(items[inx].item,item))return inx}return-1}function getIndexesLink(){function getValueParam(str){return str=str.replace(/[\[\]\'\"]/g,""),str.split(",")}var attrArr,result=[],attrStr=$attrs.scheduleIndexesLink;return attrStr&&(attrStr=attrStr.replace(/\s/g,""),attrArr=attrStr.split("],["),result=attrArr.length>1?_.map(attrArr,function(str){return getValueParam(str)}):getValueParam(attrStr)),result}var self=this,nwTableScheduler={};scheduler.isSupport&&(nwTableScheduler=$injector.get("nwTableScheduler"),scheduler.getSchedulerData()),this.items,this.selected=$scope.selectedRows=[],this.showToggle=!1,$scope.sortParamInit=$attrs.nwTableSortParamInit?$attrs.nwTableSortParamInit:"",$scope.sortDirectionInit=$attrs.nwTableSortDirectionInit?$attrs.nwTableSortDirectionInit:"desc",$scope.sortParam||($scope.sortParam=angular.copy($scope.sortParamInit)),$scope.sortDirection||($scope.sortDirection=angular.copy($scope.sortDirectionInit)),_.has($attrs,"nwTableSorted")&&!_.has($attrs,"nwTableNotSortInit")&&$timeout(function(){self.action.sorted($scope.sortParam,$scope.sortDirection)}),this.isReadyBody=$q.defer(),this.isReadyBody.promise.then(function(ngRepeat){$scope.$parent.$watch(ngRepeat.items,function(newValue,oldValue){(_.isUndefined(self.items)||newValue!==oldValue)&&(self.items=newValue),self.selected.length&&_.has($attrs,"nwTableSelectedMatchedFunc")?self.selected=_.filter(self.selected,function(item){return self.action.matched(item,newValue)}):self.selected.length&&newValue!==oldValue&&self.selected.splice(0)},!0)}),this.isAction=function(name){function capitalizeFirstLetter(str){return str.charAt(0).toUpperCase()+str.slice(1)}function checkOnScheduler(id){return scheduler.isSupport?scheduler.checkPageSchedulerSupported(id):!1}var result,attr;return"schedule"===name?result=$attrs.schedule?checkOnScheduler($attrs.schedule):!1:(attr=$attrs["nwTableOn"+capitalizeFirstLetter(name)],result=!_.isUndefined(attr)),result},this.action={add:function($event){$event.preventDefault(),$scope.onAddDisable()||$scope.onAdd()},message:function($event){$event.preventDefault(),$scope.onMessageDisable()||$scope.onMessage()},"delete":function($event){if($event.preventDefault(),self.isSelected()){var params={},args=nwTableService.parse.attrFunction($attrs.nwTableOnDelete);args.first&&(params[args.first]=_.pluck(self.selected,"item")),args.second&&(params[args.second]=_.pluck(self.selected,"key")),$scope.onDelete(params)}},setSchedule:function($event,itemTable,inxRow){if(itemTable||($event.preventDefault(),self.isSelected())){var isNotReload="scheduleNotReload"in $attrs;nwTableScheduler.startScheduleDialog({branches:function(itemTable,inxRow){function getLinks(rule,indexesLink,itemTable,inxRow,nameDynamicLink){function pushLinks(inx){function pushLink(indexes){var link=scheduler.getFullLink(rule,indexes,dynamicLink);result.push(link)}var indexes=_.clone(indexesLink);inx&&indexes.push(inx),_.isArray(indexes[0])?(indexes=scheduler.parseIndexesLink(indexes),_.each(indexes,function(inxs){pushLink(inxs)})):pushLink(indexes)}var inx,dynamicLink,result=[],indexesLink=nwTableScheduler.initIndexesLink(itemTable,indexesLink);return itemTable&&nameDynamicLink&&(dynamicLink=itemTable[nameDynamicLink]),indexesLink&&_.isArray(indexesLink[0])?pushLinks():(inx=nwTableScheduler.getIdBranch(itemTable)||inxRow,_.isArray(inx)?_.each(inx,function(i){return pushLinks(i)}):pushLinks(inx)),result}var link,result=[],rule=$attrs.schedule,nameDynamicLink=$attrs.scheduleDynamicLink,indexesLink=getIndexesLink($attrs);return itemTable?(link=getLinks(rule,indexesLink,itemTable,inxRow,nameDynamicLink),result=result.concat(link)):_.each(self.selected,function(elem){var link=getLinks(rule,indexesLink,elem.item,elem.key,nameDynamicLink);result=result.concat(link)}),result}(itemTable,inxRow),isNeedReload:!isNotReload},$scope).then(function(res){res&&res.isReset&&($scope.nwTable.selected=[])})}},edit:function($event,itemTable,inxRow){$event.preventDefault();var useSchedule=!1;self.isAction("schedule")&&(useSchedule=self.checkSchedule(itemTable,inxRow));var params={},args=nwTableService.parse.attrFunction($attrs.nwTableOnEdit);args.first&&(params[args.first]=itemTable,self.isAction("schedule")&&(params[args.first].useSchedule=useSchedule)),args.second&&(params[args.second]=inxRow),$scope.onEdit(params)},customEvent:function($event){$event.preventDefault(),$scope.onCustomEventDisable()||$scope.onCustomEvent()},secondCustomEvent:function($event){$event.preventDefault(),$scope.onSecondCustomEvent()},customEventOnSelected:function($event){if($event.preventDefault(),self.isSelected()&&!$scope.onCustomEventOnSelectedDisable()){var params={},args=nwTableService.parse.attrFunction($attrs.nwTableOnCustomEventOnSelected);args.first&&(params[args.first]=_.pluck(self.selected,"item")),args.second&&(params[args.second]=_.pluck(self.selected,"key")),$scope.onCustomEventOnSelected(params)}},sorted:function(param,direction){var params={},args=nwTableService.parse.attrFunction($attrs.nwTableSortedFunc);args.first&&(params[args.first]=param),args.second&&(params[args.second]=direction),$scope.sortedFunc(params)},matched:function(item,items){var params={},args=nwTableService.parse.attrFunction($attrs.nwTableSelectedMatchedFunc);return args.first&&(params[args.first]=item),args.second&&(params[args.second]=items),$scope.matchedFunc(params)}},this.showRow=function(param){var params={},args=nwTableService.parse.attrFunction($attrs.nwTableNeedShowRow);return args.first&&(params[args.first]=param),$scope.needShowRow(params)},this.sortMenu=function(){var blockToggleMenu=angular.element(document.getElementsByClassName("block_toggle_menu")[0]);this.showToggle?(blockToggleMenu.css("display","none"),this.showToggle=!1):(blockToggleMenu.css("display","block"),this.showToggle=!0)},this.checkSchedule=function(elem,inxElem){var rule=$attrs.schedule,indexesLink=getIndexesLink(),dynamicLink=$attrs.scheduleDynamicLink;return nwTableScheduler.checkSchedule(rule,indexesLink,elem,inxElem,dynamicLink)},this.rowsSize=function(){return _.isArray(this.items)?this.items.length:_.size(this.items)},this.hasRows=function(){return this.rowsSize()>0},this.isSelected=function(){return this.selected.length},this.hasSelected=function(item,key){return findSelectedIndex(item,key)+1},this.hasSelectedAll=function(){return this.hasRows()&&this.rowsSize()==this.selected.length},this.addSelectedItem=function(item,key){this.selected.push({item:item,key:key})},this.removeSelectedItem=function(item,key){var index=findSelectedIndex(item,key);this.selected.splice(index,1)},this.addSelectedAllItems=function(){_.each(this.items,function(item,key){this.hasSelected(item,key)||this.addSelectedItem(item,key)},this)},this.removeSelectedAllItems=function(){_.each(this.items,function(item,key){this.hasSelected(item,key)&&this.removeSelectedItem(item,key)},this)},this.changeSortParam=function(param){$scope.sortParam!=param?($scope.sortParam=param,$scope.sortDirection=angular.copy($scope.sortDirectionInit)):$scope.sortDirection="desc"==$scope.sortDirection?"asc":"desc",this.action.sorted($scope.sortParam,$scope.sortDirection)},this.getAttr=function(attrName){return $attrs[attrName]},this.getSortParam=function(){return $scope.sortParam},this.getSortDirection=function(){return $scope.sortDirection},this.getDefaultDirection=function(){return $scope.sortDirectionInit}},controllerAs:"nwTable"}}]),nw.directive("nwTableToolbar",["translate",function(){return{restrict:"A",require:"^?nwTable",replace:!0,link:function(){},template:'<div class="nwtable_toolbar" ng-if="!empty"><div class="nwtable_toolbar_title" ng-if="title || needEmptyTitle" ng-bind="title | translate"></div><div class="nwtable_toolbar_toggle_menu" ng-if="isSorted"ng-click="nwTable.sortMenu()"></div><div class="nwtable_toolbar_actions" ng-class="{\'margin-for-toggle\' : isSorted }"><button type="button" class="nwtable_toolbar_button colored flat" ng-if="nwTable.isAction(\'customEvent\')" ng-click="nwTable.action.customEvent($event)"ng-class="{\'disabled\' : onCustomEventDisable() || toolbarDisabled()}"ng-bind="customEventName |translate "></button><button class="nwtable_toolbar_button colored flat" ng-if="nwTable.isAction(\'secondCustomEvent\')" ng-click="nwTable.action.secondCustomEvent($event)"ng-class="{\'disabled\' : toolbarDisabled()}"ng-bind="secondCustomEventName |translate "></button><button class="nwtable_toolbar_button colored flat" ng-if="nwTable.isAction(\'customEventOnSelected\')" ng-click="nwTable.action.customEventOnSelected($event)"ng-class="{\'disabled\' : !nwTable.isSelected() || (nwTable.isAction(\'customEventOnSelected\') && onCustomEventOnSelectedDisable()) || toolbarDisabled(), \'hide\' : onCustomEventOnSelectedHide()}"ng-bind="customEventName |translate "></button><div class="nwtable_toolbar_button_icon"ng-class="{\'disabled_icon\' : !nwTable.isSelected()}"ng-if="nwTable.isAction(\'schedule\')"ng-click="nwTable.action.setSchedule($event)"title="{{\'sched_nav\' | translate}}"><div svg-icon="time"></div></div><div class="nwtable_toolbar_button_icon" ng-if="nwTable.isAction(\'add\')" ng-click="nwTable.action.add($event)"ng-class="{\'disabled_icon\' : (nwTable.isAction(\'addDisable\') && onAddDisable()) || toolbarDisabled(), \'hide\' : nwTable.isAction(\'addHide\') && onAddHide()}"title="{{\'act_add\' | translate }}"><div svg-icon="add_icon"></div></div><div class="nwtable_toolbar_button_icon" ng-if="nwTable.isAction(\'message\')" ng-click="nwTable.action.message($event)"ng-class="{\'disabled_icon\' : (nwTable.isAction(\'messageDisable\') && onMessageDisable()) || toolbarDisabled(), \'hide\' : nwTable.isAction(\'messageHide\') && onMessageHide()}"title="{{\'usb_modem_sms_new_message\' | translate }}"><div svg-icon="unread_mess"></div></div><div class="nwtable_toolbar_button_icon " ng-if="nwTable.isAction(\'delete\')" ng-click="nwTable.action.delete($event)"ng-class="{\'disabled_icon\' : !nwTable.isSelected() || toolbarDisabled(), \'hide\' : nwTable.isAction(\'deleteHide\') && onDeleteHide()}"title="{{\'act_delete\' | translate}}"><div svg-icon="delete_icon"></div></div></div><div class="nwtable_toolbar_desc" ng-if="desc && !empty" nw-bind-html-compile="desc | translate"></div><div class="nwtable_toolbar_desc" ng-if="empty && emptyDesc" ng-bind="emptyDesc | translate"></div></div>'}}]),nw.directive("nwTableHeadRow",[function(){return{restrict:"A",require:"^^nwTable",link:function($scope,$element,$attrs,$nwTable){$scope.toggleSelectAllRows=function($event){$event.stopPropagation(),$nwTable.hasSelectedAll()?$nwTable.removeSelectedAllItems():$nwTable.addSelectedAllItems()},$scope.isSelectedAllRows=function(){return $nwTable.hasSelectedAll()},$scope.hasRows=function(){return $nwTable.hasRows()}}}}]),nw.directive("nwTableRowSorted",[function(){return{restrict:"A",require:"^nwTable",priority:1001,template:function($element){var $ths=$element.find("th");_.each($ths,function(elem){var $th=angular.element(elem),param=$th.attr("nw-table-sort-param");param?($th.addClass("sortable"),$th.attr("ng-click",'rearrangeColumn($event, "'+param+'")'),$th.attr("ng-class",'getColumnClass("'+param+'")')):$th.addClass("sortable--disable")})},scope:{},link:function($scope,$element,$attrs,$nwTable){$scope.rearrangeColumn=function($event,param){$nwTable.changeSortParam(param)},$scope.getColumnClass=function(param){var result=[],currentParam=$nwTable.getSortParam(),currentDirection=$nwTable.getSortDirection(),defaultDirection=$nwTable.getDefaultDirection();return currentParam==param?(result.push("sortable--active"),result.push("sortable--"+currentDirection)):"asc"==defaultDirection&&result.push("sortable--asc"),result}}}}]),nw.directive("nwTableRowSortedAndSelectAll",[function(){return{restrict:"A",require:"^nwTable",priority:1001,template:function($element){var $th=angular.element("<table><tr><th class='nw-table-checkbox-th'></th></tr></table>").find("th"),$checkbox=angular.element("<div nw-table-checkbox></div>");$checkbox.attr("ng-click","toggleSelectAllRows($event)"),$checkbox.attr("nw-checked","isSelectedAllRows()"),$checkbox.attr("nw-disabled","!hasRows()"),$element.prepend($th.append($checkbox));var $ths=$element.find("th");_.each($ths,function(elem){var $th=angular.element(elem),param=$th.attr("nw-table-sort-param"),showParam=$th.attr("nw-if-param");param?($th.addClass("sortable"),$th.attr("ng-click",'rearrangeColumn($event, "'+param+'")'),$th.attr("ng-class",'getColumnClass("'+param+'")')):$th.addClass("sortable--disable"),showParam&&($th.attr("ng-if",'needShow("'+showParam+'")'),$th.removeAttr("nw-if-param"))})},scope:{},link:function($scope,$element,$attrs,$nwTable){$scope.needShow=function(param){return $nwTable.showRow(param)},$scope.toggleSelectAllRows=function($event){$event.stopPropagation(),$nwTable.hasSelectedAll()?$nwTable.removeSelectedAllItems():$nwTable.addSelectedAllItems()},$scope.isSelectedAllRows=function(){return $nwTable.hasSelectedAll()},$scope.hasRows=function(){return $nwTable.hasRows()},$scope.rearrangeColumn=function($event,param){$nwTable.changeSortParam(param)},$scope.getColumnClass=function(param){var result=[],currentParam=$nwTable.getSortParam(),currentDirection=$nwTable.getSortDirection(),defaultDirection=$nwTable.getDefaultDirection();return currentParam==param?(result.push("sortable--active"),result.push("sortable--"+currentDirection)):"asc"==defaultDirection&&result.push("sortable--asc"),result}}}}]),nw.directive("nwTableRowSelectAll",["nwTableService",function(){return{restrict:"A",require:"^^nwTable",priority:1001,template:function($element){var $th=angular.element("<table><tr><th class='nw-table-checkbox-th'></th></tr></table>").find("th"),$checkbox=angular.element("<div nw-table-checkbox></div>");$checkbox.attr("ng-click","toggleSelectAllRows($event)"),$checkbox.attr("nw-checked","isSelectedAllRows()"),$checkbox.attr("nw-disabled","!hasRows()"),$element.prepend($th.append($checkbox))}}}]),nw.directive("nwTableRow",["nwTableService",function(nwTableService){return{restrict:"A",require:"^^nwTable",link:function($scope,$element,$attrs,$nwTable){var ngRepeat=nwTableService.parse.ngRepeat($attrs.ngRepeat);$scope.toggleSelectRow=function($event,item,key){$event.stopPropagation(),$nwTable.hasSelected(item,key)?$nwTable.removeSelectedItem(item,key):$nwTable.addSelectedItem(item,key)},$scope.isSelectedRow=function(item,key){return $nwTable.hasSelected(item,key)},$scope.editRow=function($event,item,key){$nwTable.action.edit($event,item,key)},$scope.$last&&$nwTable.isReadyBody.resolve(ngRepeat)}}}]),nw.directive("nwTableRowAction",["nwTableService",function(nwTableService){return{restrict:"A",require:"^nwTable",priority:1001,template:function($element,$attrs){function hasAttr(name){return!_.isUndefined($attrs[name])}var ngRepeat=nwTableService.parse.ngRepeat($attrs.ngRepeat),item=ngRepeat.item,key=ngRepeat.key;hasAttr("nwTableRowSelect")&&function($element,item){function addCheckbox($container,$target,place){var $checkbox=angular.element("<div nw-table-checkbox></div>");$checkbox.attr("ng-click","toggleSelectRow($event, "+item+", "+key+")"),$checkbox.attr("nw-checked","isSelectedRow("+item+", "+key+")"),$target[place]($container.append($checkbox))}$attrs.$set("ngClass","{'selected': isSelectedRow("+item+")}");var $containers={$table:angular.element("<table><tr><td class='nw-table-checkbox-td'></td><tr></table>").find("td"),$miniTable:angular.element("<div class='nw-mini-table-checkbox-container'></div>")};addCheckbox($containers.$table,$element,"prepend"),hasAttr("nwMiniTable")&&addCheckbox($containers.$miniTable,$element.children("div"),"prepend")}($element,item),hasAttr("nwTableRowClick")&&function($element,item,key){$element.addClass("clickable"),$element.attr("ng-click","editRow($event, "+item+", "+key+")")}($element,item,key)},scope:{}}}]),nw.directive("nwTableCheckbox",[function(){return{restrict:"A",replace:!0,scope:{nwChecked:"=nwChecked",nwDisabled:"=nwDisabled"},template:'<div class="nw-table-checkbox-field"><i class="nw-table-checkbox-switch"></i></div>',link:function($scope,$element){var $switch=angular.element($element.find("i"));$scope.$watch("nwChecked",function(value){value?$switch.addClass("nw-table-checkbox-switch--checked"):$switch.removeClass("nw-table-checkbox-switch--checked")}),$scope.$watch("nwDisabled",function(value){_.isUndefined(value)||(value?($element.addClass("nw-table-checkbox-field--disabled"),$switch.addClass("nw-table-checkbox-switch--disabled")):($element.removeClass("nw-table-checkbox-field--disabled"),$switch.removeClass("nw-table-checkbox-switch--disabled")))})}}}]),nw.directive("nwMiniTable",["$injector","nwTableService",function($injector){var scheduler=$injector.has("scheduler")?$injector.get("scheduler"):{isSupport:!1},postLink=function($scope,$element){$element.addClass("nw-mini-table-tr")};return{restrict:"A",compile:function($element,$attrs){function isClickableTable(){return!(_.isUndefined($attrs.nwMiniTableClick)&&_.isUndefined($attrs.nwClickAnywhere)&&_.isUndefined($attrs.ngClick)&&_.isUndefined($attrs.nwTableRowClick))}var $schedule,$container={$wrapper:angular.element("<div class='nw-mini-table-container'></div>"),$info:angular.element("<div class='nw-mini-table-caption-info-container'></div>"),$status:angular.element("<div class='nw-mini-table-status'></div>"),$icon:angular.element("<div class='nw-mini-table-icon'></div>")};return _.isUndefined($attrs.nwMiniTableCaption)||$container.$info.append('<span class="nw-mini-table-caption" nw-bind-html-compile="'+$attrs.nwMiniTableCaption+'"></span>'),_.isUndefined($attrs.nwMiniTableShort)||$container.$info.append('<span class="nw-mini-table-short" nw-bind-html-compile="'+$attrs.nwMiniTableShort+'"></span>'),_.isUndefined($attrs.nwMiniTableInfo)||($element.addClass("nw-mini-table-tr-info"),$container.$status.attr("nw-bind-html-compile",$attrs.nwMiniTableInfo)),_.isUndefined($attrs.nwMiniTableChooseIcon)||($container.$connections=angular.element("<div class=nw-mini-table-activate-icon ><svg svg-icon='"+$attrs.nwMiniTableChooseIcon+"'></svg></div>"),_.isUndefined($attrs.nwMiniTableActivateIcon)||$container.$connections.attr("ng-class","{'enable':"+$attrs.nwMiniTableActivateIcon+"}"),$container.$wrapper.append($container.$connections)),$container.$arrow=angular.element("<div class='nw-mini-table-arrow'><svg svg-icon='arrow_right'></svg></div>"),_.isUndefined($attrs.nwMiniTableClick)||$container.$wrapper.attr("ng-click",$attrs.nwMiniTableClick),function(){return $attrs.nwMiniTableFull||!$attrs.nwMiniTableShort&&!$attrs.nwMiniTableCaption}()?($element.addClass("nw-mini-table-opening"),$element.bind("click",function(){$element.toggleClass("nw-mini-table-open")})):$element.addClass("nw-mini-table-not-opening"),$container.$wrapper.append($container.$info),scheduler.isSupport&&($schedule=angular.element("<div nw-table-schedule-column='mini'></div>"),$container.$wrapper.append($schedule)),$container.$wrapper.append($container.$status),_.isUndefined($attrs.nwMiniTableIcon)?isClickableTable()&&$container.$wrapper.append($container.$arrow):($container.$icon.attr("nw-bind-html-compile",$attrs.nwMiniTableIcon),$container.$wrapper.append($container.$icon)),$element.append($container.$wrapper),$element.addClass("nw-mini-table-tr"),postLink},priority:1002}}]),nw.factory("nwTableService",function(){function Repeat(ngRepeat){for(this._tokens=this.parse(ngRepeat).split(" "),this._iterator=0,this.isNext("in")?(this.key="$index",this.item=this.current()):(this.key=this.current(),this.item=this.getNext()),this.delim=this.getNext(),this.items=this.getNext();this.hasNext()&&-1===["|","track"].indexOf(this.getNext());)this.items+=this.current()}function AttrFunction(attr){this._args=this.parse(attr),this._iterator=0,this.hasCurrent()&&(this.first=this.current()),this.hasNext()&&(this.second=this.getNext())}var cache={};Repeat.prototype.parse=function(ngRepeat){var delimiterChars=/[(,)]/g;return ngRepeat.replace(delimiterChars,"")},Repeat.prototype.current=function(){return this._tokens[this._iterator]},Repeat.prototype.isNext=function(name){return this._tokens[this._iterator+1]===name},Repeat.prototype.getNext=function(){return this._tokens[++this._iterator]},Repeat.prototype.getValue=function(){return this._tokens.join(" ")},Repeat.prototype.hasNext=function(){return this._iterator<this._tokens.length-1},AttrFunction.prototype.parse=function(attr){var reg=/\((.*)\)/,matches=attr.match(reg);return matches&&matches.length&&matches[1]?matches[1].replace(/\s/g,"").split(","):[]},AttrFunction.prototype.hasCurrent=function(){return this._iterator<this._args.length},AttrFunction.prototype.current=function(){return this._args[this._iterator]},AttrFunction.prototype.getNext=function(){return this._args[++this._iterator]},AttrFunction.prototype.hasNext=function(){return this._iterator<this._args.length-1};var parse=function(){return{ngRepeat:function(attr){return cache.hasOwnProperty(attr)?cache[attr]:cache[attr]=new Repeat(attr)},attrFunction:function(attr){return cache.hasOwnProperty(attr)?cache[attr]:cache[attr]=new AttrFunction(attr)}}}();return{parse:parse}})}();
;"use strict";function _defineProperty(obj,key,value){return key in obj?Object.defineProperty(obj,key,{value:value,enumerable:!0,configurable:!0,writable:!0}):obj[key]=value,obj}!function(){var nw=angular.module(regdep("nw-control-list"),[]);nw.directive("nwControlList",["$q",function($q){return{restrict:"A",scope:{selectedList:"=nwControlListSelectedList"},compile:function($element,$attrs){var params={selected:"nwControlListSelected"},$item=$element.children();(function(name){return _.has($attrs,params[name])})("selected")&&$item.attr("nw-control-list-item-selected","")},controller:function($scope){function findSelectedIndex(item,key){var inx,items=self.selected;for(inx=0;inx<items.length;inx++){if(items[inx].key==key)return inx;if(_.isEqual(angular.copy(items[inx].item),angular.copy(item)))return inx}return-1}var self=this;this.items,this.selected=$scope.selectedList?$scope.selectedList:[],this.isReadyBody=$q.defer(),this.isReadyBody.promise.then(function(ngRepeat){$scope.$parent.$watch(ngRepeat.items,function(newValue,oldValue){(_.isUndefined(self.items)||newValue!==oldValue)&&(self.items=newValue),self.selected.length&&newValue!==oldValue&&self.selected.splice(0)},!0)}),this.hasSelected=function(item,key){return findSelectedIndex(item,key)+1},this.addSelectedItem=function(item,key){self.selected.push({item:item,key:key})},this.removeSelectedItem=function(item,key){var index=findSelectedIndex(item,key);self.selected.splice(index,1)},$scope.$watch("nwControlList.selected",function(newValue){_.isUndefined(newValue)||_.isUndefined($scope.selectedList)||($scope.selectedList=newValue)},!0)},controllerAs:"nwControlList"}}]),nw.directive("nwControlListItem",["nwControlListService","$compile",function(nwControlListService){var params={selected:"nwControlListItemSelected",title:"nwControlListItemTitle",subtitle:"nwControlListItemSubtitle",subtitle2:"nwControlListItemSubtitle2",disabled:"nwControlListItemDisabled"};return{restrict:"A",require:"^^nwControlList",compile:function($element,$attrs){function hasAttr(name){return _.has($attrs,params[name])}var ngRepeat=nwControlListService.parse.ngRepeat($attrs.ngRepeat),item=ngRepeat.item,key=ngRepeat.key,$container={$primary:angular.element("<div class='nw-control-list_item_primary'></div>"),$content:angular.element("<div class='nw-control-list_item_content'></div>")};return hasAttr("title")&&$container.$content.append('<div class="nw-control-list_item_title" nw-bind-html-compile='+$attrs[params.title]+"></div>"),hasAttr("subtitle")&&$container.$content.append('<div class="nw-control-list_item_subtitle" nw-bind-html-compile='+$attrs[params.subtitle]+"></div>"),hasAttr("subtitle2")&&$container.$content.append('<div class="nw-control-list_item_subtitle" nw-bind-html-compile='+$attrs[params.subtitle2]+"></div>"),$element.addClass("nw-control-list_item"),hasAttr("selected")&&($element.attr("ng-click","toggleSelectItem($event, "+item+", "+key+")"),$element.attr("ng-class","{'nw-control-list_item--selected' : isSelectedItem("+item+", "+key+")}")),$element.append($container.$primary),$element.append($container.$content),function($scope,$element,$attrs,$nwControlList){function isDisabledItem(item,key){var _$scope$$eval;return $scope.$eval($attrs[params.disabled],(_$scope$$eval={},_defineProperty(_$scope$$eval,ngRepeat.key,key),_defineProperty(_$scope$$eval,ngRepeat.item,item),_$scope$$eval))}var ngRepeat=nwControlListService.parse.ngRepeat($attrs.ngRepeat);$scope.toggleSelectItem=function($event,item,key){$event.stopPropagation(),isDisabledItem(item,key)||($nwControlList.hasSelected(item)?$nwControlList.removeSelectedItem(item,key):$nwControlList.addSelectedItem(item,key))},$scope.isSelectedItem=function(item,key){return $nwControlList.hasSelected(item,key)},$scope.isDisabledItem=isDisabledItem,$scope.$last&&$nwControlList.isReadyBody.resolve(ngRepeat)}},priority:1001}}]),nw.directive("nwControlListItemSelected",["nwControlListService",function(nwControlListService){return{restrict:"A",require:"^^nwControlList",template:function($element,$attrs){var $primary=angular.element($element[0].querySelector(".nw-control-list_item_primary")),ngRepeat=nwControlListService.parse.ngRepeat($attrs.ngRepeat),item=ngRepeat.item,key=ngRepeat.key,$checkbox=angular.element("<div nw-control-list-checkbox></div>");$checkbox.attr("nw-checked","isSelectedItem("+item+", "+key+")"),$checkbox.attr("nw-disabled","isDisabledItem("+item+", "+key+")"),$primary.append($checkbox)}}}]),nw.directive("nwControlListCheckbox",[function(){return{restrict:"A",replace:!0,scope:{nwChecked:"=nwChecked",nwDisabled:"=nwDisabled"},template:'<div class="nw-control-list-checkbox_field"><i class="nw-control-list-checkbox_switch"></i></div>',link:function($scope,$element){var $switch=angular.element($element.find("i"));$scope.$watch("nwChecked",function(value){value?$switch.addClass("nw-control-list-checkbox_switch--checked"):$switch.removeClass("nw-control-list-checkbox_switch--checked")}),$scope.$watch("nwDisabled",function(value){_.isUndefined(value)||(value?($element.addClass("nw-control-list-checkbox_field--disabled"),$switch.addClass("nw-control-list-checkbox_switch--disabled")):($element.removeClass("nw-control-list-checkbox_field--disabled"),$switch.removeClass("nw-control-list-checkbox_switch--disabled")))})}}}]),nw.factory("nwControlListService",function(){function Repeat(ngRepeat){for(this._tokens=this.parse(ngRepeat).split(" "),this._iterator=0,this.isNext("in")?(this.key="$index",this.item=this.current()):(this.key=this.current(),this.item=this.getNext()),this.delim=this.getNext(),this.items=this.getNext();this.hasNext()&&-1===["|","track"].indexOf(this.getNext());)this.items+=this.current()}function AttrFunction(attr){this._args=this.parse(attr),this._iterator=0,this.hasCurrent()&&(this.first=this.current()),this.hasNext()&&(this.second=this.getNext())}var cache={};Repeat.prototype.parse=function(ngRepeat){var delimiterChars=/[(,)]/g;return ngRepeat.replace(delimiterChars,"")},Repeat.prototype.current=function(){return this._tokens[this._iterator]},Repeat.prototype.isNext=function(name){return this._tokens[this._iterator+1]===name},Repeat.prototype.getNext=function(){return this._tokens[++this._iterator]},Repeat.prototype.getValue=function(){return this._tokens.join(" ")},Repeat.prototype.hasNext=function(){return this._iterator<this._tokens.length-1},AttrFunction.prototype.parse=function(attr){var reg=/\((.*)\)/,matches=attr.match(reg);return matches&&matches.length&&matches[1]?matches[1].replace(/\s/g,"").split(","):[]},AttrFunction.prototype.hasCurrent=function(){return this._iterator<this._args.length},AttrFunction.prototype.current=function(){return this._args[this._iterator]},AttrFunction.prototype.getNext=function(){return this._args[++this._iterator]},AttrFunction.prototype.hasNext=function(){return this._iterator<this._args.length-1};var parse=function(){return{ngRepeat:function(attr){return cache.hasOwnProperty(attr)?cache[attr]:cache[attr]=new Repeat(attr)},attrFunction:function(attr){return cache.hasOwnProperty(attr)?cache[attr]:cache[attr]=new AttrFunction(attr)}}}();return{parse:parse}})}();
;"use strict";angular.module(regdep("nw-langlist"),[]).directive("nwLanglist",["translate","$rootScope","cookie",function(translate,$rootScope,cookie){return{restrict:"A",transclude:!0,scope:{},template:'<div><div class="lang_active" ng-click="expand()">{{\'language\'|translate}}:<div class="lang_list" ng-class="{ focused: !!lang_list.length }">{{lang|translate}}&nbsp;<div class="lng"><img src="img/lang/{{lang}}.png"></div><div ng-repeat="name in lang_list|filter:lang:filterfn" ng-click="change(name)">{{name|translate}}</div></div></div></div>',link:function($scope){$scope.lang_list=[],$rootScope.$on("changelang",function(event,lang){$scope.lang=lang}),$scope.filterfn=function(actual,expected){return!angular.equals(actual,expected)},$scope.expand=function(){$scope.lang_list=$scope.lang_list.length>0?[]:["rus","eng","ara","fas","ukr","fra","heb","lit","tur"]},$scope.change=function(lang){cookie.set("lang",lang),translate.changeLanguage(lang)}}}}]);
;"use strict";!function(){var nw=angular.module(regdep("nw-help-funcs"),[]);nw.directive("nwClickAnywhere",function($document){return{restrict:"A",link:function(scope,elem,attr){elem.bind("click",function(e){e.stopPropagation()}),$document.bind("click",function(){scope.$apply(attr.clickAnywhere),angular.element(elem).css("display","none")})}}}),nw.directive("nwClickClearInput",function(){return{restrict:"A",link:function(scope,elem){elem.bind("focus",function(){angular.element(elem).val()==angular.element(elem).attr("title")&&angular.element(elem).val("")}),elem.bind("blur",function(){angular.element(elem).val(angular.element(elem).attr("title"))})}}}),nw.directive("nwSetFocus",function($timeout){return{restrict:"A",link:function($scope,$element,$attrs){$attrs.$observe("nwSetFocus",function(){(""==$attrs.nwSetFocus||"true"==$attrs.nwSetFocus)&&$timeout(function(){$element[0].focus()},0)})}}}),nw.directive("nwBindHtmlCompile",["$compile",function($compile){return{restrict:"A",link:function($scope,$element,$attrs){$scope.$watch(function(){return $scope.$eval($attrs.nwBindHtmlCompile)},function(value){/(xn--)/.test(value)&&(value=value.replace(/(xn--\w+)/,function(str){return punycode.toUnicode(str)})),$element.html(value&&value.toString());var compileScope=$scope;$attrs.bindHtmlScope&&(compileScope=$scope.$eval($attrs.bindHtmlScope)),$compile($element.contents())(compileScope)})}}}]),nw.directive("nwOptionsClass",function(){return{require:"select",link:function($scope,$element,$attrs){var optionsSourceStr=$attrs.ngOptions.split(" ").pop();$scope.$watch(optionsSourceStr,function(items){angular.forEach(items,function(item,index){var optionClass=$scope.$eval($attrs.nwOptionsClass,{option:item,index:index}),$option=angular.element($element.find("option")[index]),classes=optionClass.split(" ");angular.forEach(classes,function(className){$option.addClass(className)})})})}}}),nw.directive("nwEnterBind",["$document",function(){return{restrict:"A",link:function($scope,$element,$attrs){document.onkeydown=function($event){13===$event.which&&($scope.$apply(function(){$scope.$eval($attrs.nwEnterBind)}),$event.preventDefault())},$scope.$on("$destroy",function(){document.onkeydown=null})}}}]),nw.directive("nwNotDirty",function(){return{restrict:"A",require:"ngModel",link:function(scope,elm,attrs,ctrl){ctrl.$pristine=!1}}})}();
;"use strict";angular.module(regdep("nw-empty-state"),[]).directive("nwEmptyState",[function(){return{restrict:"A",replace:!0,compile:function($element,$attrs){var template="";template+=function(){return'<div class="empty_state_container">'}(),$attrs.nwEmptyStateTitle&&(template+=function(){return'<div class="empty_state_title" ng-bind="\''+$attrs.nwEmptyStateTitle+"' | translate\"></div>"}()),$attrs.nwEmptyStateButton&&(template+=function(){var result='<div class="empty_state_buttons_panel">';return result+='<button type="button" class="colored flat" ng-bind="\''+$attrs.nwEmptyStateButton+'\' | translate"ng-click="'+$attrs.nwEmptyStateButtonClick+'"></button>',$attrs.nwEmptyStateButton2&&(result+='<button type="button" class="colored flat" ng-bind="\''+$attrs.nwEmptyStateButton2+'\' | translate"ng-click="'+$attrs.nwEmptyStateButton2Click+'"></button>'),result+="</div>"}()),$attrs.nwEmptyStateSubtitle&&(template+=function(){return'<div class="empty_state_subtitle" ng-bind="\''+$attrs.nwEmptyStateSubtitle+"' | translate\"> </div>"}()),template+=function(){return"</div>"}(),$element.append(template)}}}]);
;"use strict";!function(){var nw=angular.module(regdep("nw-autocomplete"),[]);nw.directive("nwAutocomplete",["$compile",function($compile){var KEY_CODE={TAB:9,ENTER:13,UP_ARROW:38,DOWN_ARROW:40};return{restrict:"A",require:"ngModel",link:function($scope,$element,$attrs){function setActive(val){isActive=val}function getActive(){return isActive}function init(){$autocomplete=angular.element($compile(template)($scope)),$parent.addClass("nw-autocomplete-wrap"),$parent.append($autocomplete),$element.bind("focus",function(){$scope.$broadcast("input.focus")}),$element.bind("blur",function(){$scope.$broadcast("input.blur")}),$element.bind("keydown",function($event){if(0!=getActive()){switch($event.keyCode){case KEY_CODE.TAB:$scope.$broadcast("input.tab");break;case KEY_CODE.ENTER:$scope.$broadcast("input.enter"),$event.preventDefault();break;case KEY_CODE.UP_ARROW:$scope.$broadcast("input.up"),$event.preventDefault();break;case KEY_CODE.DOWN_ARROW:$scope.$broadcast("input.down"),$event.preventDefault()}($event.keyCode==KEY_CODE.TAB||$event.keyCode==KEY_CODE.ENTER||$event.keyCode==KEY_CODE.UP_ARROW||$event.keyCode==KEY_CODE.DOWN_ARROW)&&$scope.$apply()}}),$scope.$on("input.focus.set",function(){$element[0].focus()}),$scope.$on("autocomplete.show",function(){setActive(!0)}),$scope.$on("autocomplete.leave",function(){setActive(!1)})}var $autocomplete,$parent=$element.parent(),isActive=!1,template="<div nw-autocomplete-core nw-autocomplete-core-value="+$attrs.ngModel+"  nw-autocomplete-core-options="+$attrs.nwAutocompleteOptions+" ></div>";init()}}}]),nw.directive("nwAutocompleteCore",["$window","$document",function($window,$document){return{restrict:"A",replace:!0,template:'<div tabindex="-1" class="nw-autocomplete" ><div class="nw-autocomplete__item" ng-class="{\'nw-autocomplete__item--active\': active.check($index) }"ng-click="selectItem($event, $index)" ng-repeat="option in options.list" ng-bind="option.title"></div></div>',scope:{value:"=nwAutocompleteCoreValue",allOptions:"=nwAutocompleteCoreOptions"},link:function($scope,$element){function isShow(){return(focus.is()||elementActive.is())&&!stop.is()&&!$scope.options.isEmpty()&&!$scope.options.isSelect()}function setValue(index){if(!_.isUndefined(index)){var option=$scope.options.get(index);$scope.value=option.value,$scope.$emit("input.focus.set",!0)}}function updateScroll(){function scrollTopFn(element,value){"scrollTopAnimated"in $document?angular.element(element).scrollTopAnimated(value):element.scrollTop=value}var childrens=$element.children();if(childrens.length){var container=$element[0],item=$element.children()[0],index=$scope.active.index,allHeight=container.clientHeight+1,scrollTop=container.scrollTop,height=item.offsetHeight,top=height*index,bottom=top+height;bottom>allHeight+scrollTop?scrollTopFn(container,bottom-allHeight):scrollTop>top&&scrollTopFn(container,top)}}function correctElementScroll(){function getScrollTop(){return $window.scrollY||$document[0].documentElement.scrollTop||$document[0].body.scrollTop}var scrollTop,scrollHeight,body=$document[0].body,container=$element[0],bodyCords=body.getBoundingClientRect(),containerCords=container.getBoundingClientRect(),bodyBottom=bodyCords.bottom-bodyCords.top,containerBottom=containerCords.bottom;containerBottom>bodyBottom&&(scrollTop=getScrollTop(),scrollHeight=containerBottom-bodyBottom+20,"scrollTopAnimated"in $document?$document.scrollTopAnimated(scrollTop+scrollHeight):$window.scrollTo(0,scrollTop+scrollHeight))}var stop={value:!1,set:function(val){this.value=val},get:function(){return this.value},is:function(){return 1==this.value}},focus={value:!1,set:function(val){this.value=val},get:function(){return this.value},is:function(){return 1==this.value}},elementActive={value:!1,is:function(){return 1==this.value},set:function(val){this.value=val}};$scope.options={list:[],clean:function(){this.list.length=0},get:function(index){return this.list[index]},has:function(data){return _.some(this.list,function(elem){return elem.value==data.value})},findIndex:function(data){var inx;if(!data)return 0;for(inx=0;inx<this.list.length;inx++)if(this.list[inx].value==data.value)return inx;return 0},isEmpty:function(){return 0==this.list.length},isSelect:function(){return 1==this.list.length&&this.list[0].value==$scope.value},correct:function(){this.list=function(options,value){function match(str,substr){_.isString(str)||(str=str.toString()),_.isString(substr)||(substr=substr.toString());var pattern=new RegExp("^"+substr),result=str.match(pattern);return result&&result[0]}return _.filter(options,function(option){return value?match(option.value,value):!0})}($scope.allOptions,$scope.value)}},$scope.active={data:null,index:null,clean:function(){this.data=null,this.index=null},set:function(val){this.data=val},get:function(){return this.data},check:function(index){return this.data&&this.index==index},dec:function(){this.index=this.index-1,this.data=$scope.options.get(this.index)},inc:function(){this.index=this.index+1,this.data=$scope.options.get(this.index)},isFirst:function(){return 0==this.index},isLast:function(){return this.index==$scope.options.list.length-1},correct:function(){var index=$scope.options.findIndex(this.data);this.data=$scope.options.get(index),this.index=index}},$element.bind("mousedown",function(){elementActive.set(!0)}),$element.bind("mouseup",function(){elementActive.set(!1),$scope.$emit("input.focus.set",!0)}),$scope.$on("input.focus",function(){focus.set(!0)}),$scope.$on("input.blur",function(){focus.set(!1)}),$scope.$on("input.tab",function(){focus.set(!1)}),$scope.$on("autocomplete.stop",function(){stop.set(!0)}),$scope.$on("autocomplete.start",function(){stop.set(!1)}),$scope.$on("input.enter",function(){setValue($scope.active.index)}),$scope.$on("input.up",function(){$scope.active.isFirst()||($scope.active.dec(),updateScroll())}),$scope.$on("input.down",function(){$scope.active.isLast()||($scope.active.inc(),updateScroll())}),$scope.isShow=isShow,$scope.selectItem=function($event,index){$event.preventDefault(),setValue(index)},$scope.setValue=setValue,$scope.updateScroll=updateScroll;var correctLazy=_.debounce(function(){$scope.options.correct(),$scope.active.correct(),$scope.$apply(),updateScroll()},50);$scope.$watch("defaultValue",function(newValue){newValue&&($scope.value=newValue)}),$scope.$watch("value",correctLazy),$scope.$watch(isShow,function(val){val?($element.addClass("nw-autocomplete--show"),$scope.$emit("autocomplete.show"),$scope.active.correct(),correctElementScroll(),updateScroll()):($element.removeClass("nw-autocomplete--show"),$scope.$emit("autocomplete.leave"),$scope.active.clean())})}}}])}();
;"use strict";!function(){var nw=angular.module(regdep("nw-network"),[]);nw.directive("nwAutocompleteNetworkSubnetMask",["$compile","$timeout","funcs",function($compile,$timeout,funcs){function getRanges(){var ranges=ipv4.mask.range("0.0.0.0","255.255.255.255");return _.map(ranges,function(value){return{title:value,value:value}})}var ipv4=funcs.ipv4,attr={ipAddress:"nwAutocompleteNetworkIpAddressValue",minHosts:"nwAutocompleteNetworkSubnetMaskMinHosts",maxHosts:"nwAutocompleteNetworkSubnetMaskMaxHosts",useEndAddress:"nwAutocompleteUseEndAddress"};return{restrict:"A",require:"ngModel",link:function($scope,$element,$attrs,$ctrl){function correctRange(minHosts,maxHosts){$scope.subnetMask.ranges=getRanges(),_.isNumber(minHosts)&&correctMinRange(minHosts),_.isNumber(maxHosts)&&correctMaxRange(maxHosts)}function correctMinRange(hosts){var ranges=$scope.subnetMask.ranges,index=function(ranges,hosts){var inx,current;for(inx=ranges.length-1;inx>=0;inx--)if(current=ipv4.mask.hosts(ranges[inx].value),current>=hosts)return inx;return null}(ranges,hosts);_.isNull(index)||$scope.subnetMask.ranges.splice(index+1,ranges.length-1)}function correctMaxRange(hosts){var ranges=$scope.subnetMask.ranges,index=function(ranges,hosts){var inx,current;for(inx=0;inx<ranges.length;inx++)if(current=ipv4.mask.hosts(ranges[inx].value),hosts>=current)return inx;return null}(ranges,hosts);_.isNull(index)||$scope.subnetMask.ranges.splice(0,index)}function getDefaultValue(){var ip=$scope.subnetMask.ipAddress;return _.has($attrs,attr.useEndAddress)&&function(ip){return funcs.is.ipv4(ip)&&"0"!=ip.split(".")[3]}(ip)?"255.255.255.255":function(ip){var ipClass=funcs.ipv4.subnet.getNetworkClass(ip);switch(ipClass){case"A":return"255.0.0.0";case"B":return"255.255.0.0";case"C":return"255.255.255.0";case null:return"";default:return"255.255.255.0"}}(ip)}(function(){return _.has($attrs,"nwAutocomplete")&&_.has($attrs,"nwAutocompleteOptions")})()||function(){$element.attr("nw-autocomplete",""),$element.attr("nw-autocomplete-options","subnetMask.ranges"),$compile($element)($scope)}(),$scope.subnetMask={ipAddress:null,ranges:getRanges(),minHosts:2,maxHosts:16777214},correctMinRange($scope.subnetMask.minHosts),correctMaxRange($scope.subnetMask.maxHosts),$attrs.$observe(attr.minHosts,function(hosts){_.isUndefined(hosts)||(hosts=parseInt(hosts),$scope.subnetMask.minHosts=hosts,correctRange(hosts,$scope.subnetMask.maxHosts))}),$attrs.$observe(attr.maxHosts,function(hosts){_.isUndefined(hosts)||(hosts=parseInt(hosts),$scope.subnetMask.maxHosts=hosts,correctRange($scope.subnetMask.minHosts,hosts))}),$attrs.$observe(attr.ipAddress,function(ip){$scope.subnetMask.ipAddress=ip?ip:null}),$element.bind("focus",function(){var value;if(!$ctrl.$modelValue){if(value=getDefaultValue($scope.subnetMask.ipAddress),!value)return;$scope.$broadcast("autocomplete.stop"),$ctrl.$setViewValue(value),$ctrl.$render(),$scope.$apply(),$timeout(function(){$scope.$broadcast("autocomplete.start")},100)}})}}}]),nw.directive("nwAutocompleteNetworkGwip",["funcs",function(funcs){funcs.ipv4;var attr={ipAddress:"nwAutocompleteNetworkIpAddressValue",subnetMask:"nwAutocompleteNetworkSubnetMaskValue"};return{restrict:"A",require:"ngModel",link:function($scope,$element,$attrs,$ctrl){function getDefaultValue(){var range,ip=$scope.gwip.ipAddress,mask=$scope.gwip.subnetMask;return ip&&funcs.is.ipv4(ip)&&mask&&funcs.is.mask(mask)?(range=funcs.ipv4.subnet.getNetworkRange(ip,mask),ip!=range.start?range.start:range.end):null}$scope.gwip={ipAddress:null,subnetMask:null},$attrs.$observe(attr.ipAddress,function(ip){$scope.gwip.ipAddress=ip?ip:null}),$attrs.$observe(attr.subnetMask,function(mask){$scope.gwip.subnetMask=mask?mask:null}),$element.bind("focus",function(){var value;if(!$ctrl.$modelValue){if(value=getDefaultValue(),!value)return;$ctrl.$setViewValue(value),$ctrl.$render(),$scope.$apply()}})}}}]),nw.directive("nwNetworkValidation",["nwNetworkCheckValidation",function(validation){return{restrict:"A",require:"ngModel",scope:{param:"@nwNetworkValidation",address:"=nwNetworkAddress",subnetMask:"=nwNetworkSubnetMask",gwip:"=nwNetworkGatewayIpAddress",dnsServer1:"=nwNetworkDnsServerOne",dnsServer2:"=nwNetworkDnsServerTwo"},link:function($scope,$element,$attrs,$ctrl){function change(value){return checkValidation(value),value}function checkValidation(value){var param=paramsMap[$scope.param],data={};switch(data[param]=value,param){case"Address":data.SubnetMask=$attrs.nwNetworkValidationSubnetMaskValue;break;case"SubnetMask":data.Address=$scope.address,data.SubnetMask=$scope.subnetMask;case"GatewayIPAddress":data.Address=$scope.address,data.SubnetMask=$scope.subnetMask;break;case"DNSServer1":data.DNSServer2=$scope.dnsServer2;break;case"DNSServer2":data.DNSServer1=$scope.dnsServer1}var only={};only[param]=!0;var error=validation(data,only)[param];(error||currentError)&&error!=currentError&&($ctrl.$setValidity(currentError,!0),currentError=error),error&&$ctrl.$setValidity(error,!1)}var paramsMap={address:"Address",subnetMask:"SubnetMask",gwip:"GatewayIPAddress",dnsServer1:"DNSServer1",dnsServer2:"DNSServer2"},currentError="";"subnetMask"==$scope.param&&$scope.$watch("address",function(){checkValidation($ctrl.$viewValue)}),"subnetMask"==$scope.param&&$scope.$watch("subnetMask",function(){checkValidation($ctrl.$viewValue)}),"gwip"==$scope.param&&$scope.$watch("address",function(){checkValidation($ctrl.$viewValue)}),"gwip"==$scope.param&&$scope.$watch("subnetMask",function(){checkValidation($ctrl.$viewValue)}),"dnsServer1"==$scope.param&&$scope.$watch("dnsServer2",function(){checkValidation($ctrl.$viewValue)}),"dnsServer2"==$scope.param&&$scope.$watch("dnsServer1",function(){checkValidation($ctrl.$viewValue)}),$ctrl.$parsers.unshift(change),$ctrl.$formatters.unshift(change)}}}]),nw.factory("nwNetworkCheckValidation",["funcs",function(funcs){var is=funcs.is,ipv4=funcs.ipv4;return funcs.subnet,function(obj,only){function isNeed(name){return!only||only[name]}function checkValidation(obj,param){function isInvalidAddress(addr){return addr&&!is.ipv4(addr)}function isInvalidSubnetMask(msk){return msk&&!is.mask(msk)}function isReserved(addr,msk){return addr&&msk&&funcs.ipv4.subnet.checkReserved(addr,msk)}function isInvalidGwip(gwip){return gwip&&!is.ipv4(gwip)}function isInvalidDns(dns){return dns&&!is.ipv4(dns)}function isNeedCustomCheck2KOM(){return autoconf.BR2_PACKAGE_ANWEB_CUSTOM_2KOM_21535}function checkGwipRangeValidation(obj){function getRanges(addr,mask){var ranges=[];return addr&&mask&&ranges.push(ipv4.subnet.getNetworkRange(addr,mask)),ranges}return!obj.GatewayIPAddress||isInvalidAddress(obj.Address)||isInvalidSubnetMask(obj.SubnetMask)?"":function(addr,gwip){return addr==gwip}(obj.Address,obj.GatewayIPAddress)?"msg_ip_address_is_used":function(obj){var ranges=getRanges(obj.Address,obj.SubnetMask);return ranges.length?!_.some(ranges,function(range){return ipv4.subnet.belongNetworkRange(range,obj.GatewayIPAddress)}):!1}(obj)?"msg_error_gateway_ip_address_out_of_range":""}function checkDNSValidation(){return function(obj){return obj.DNSServer1&&obj.DNSServer2&&obj.DNSServer1==obj.DNSServer2}(obj)?"msg_error_dns_servers_is_equal":"0.0.0.0"==obj[param]||"255.255.255.255"==obj[param]?"msg_not_allowed_addr":""}switch(param){case"Address":return isInvalidAddress(obj.Address)?"msg_invalid_ipv4":isReserved(obj.Address,obj.SubnetMask)?"lan_error_ip_is_reserved":isNeedCustomCheck2KOM()&&obj.Address&&!funcs.customValidation.validStaticIP_2KOM_21748(obj.Address,obj.SubnetMask)?"msg_not_allowed_addr":"";case"SubnetMask":return isInvalidSubnetMask(obj.SubnetMask)?"msg_invalid_mask":isNeedCustomCheck2KOM()&&obj.Address&&obj.SubnetMask&&funcs.customValidation.validStaticIP_2KOM_21748(obj.Address,obj.SubnetMask)&&!funcs.customValidation.validSubnetMask_2KOM_21748(obj.Address,obj.SubnetMask)?"msg_invalid_mask":"";case"GatewayIPAddress":return isInvalidGwip(obj.GatewayIPAddress)?"msg_invalid_ipv4":checkGwipRangeValidation(obj);case"DNSServer1":if(isNeedCustomCheck2KOM())return funcs.customValidation.validDNS_2KOM_21748(obj.DNSServer1)?checkDNSValidation(obj):"msg_not_allowed_addr";case"DNSServer2":if(isInvalidDns(obj[param]))return"msg_invalid_ipv4";if(isNeedCustomCheck2KOM()){if(!funcs.customValidation.validDNS_2KOM_21748(obj.DNSServer2))return"msg_not_allowed_addr";if(!funcs.customValidation.validAllDNS_2KOM_21748(obj.DNSServer1,obj.DNSServer2))return"msg_not_allowed_addr"}return checkDNSValidation(obj)}return errors}var errors={Address:"",SubnetMask:"",GatewayIPAddress:"",DNSServer1:"",DNSServer2:""};return isNeed("Address")&&(errors.Address=checkValidation(obj,"Address")),isNeed("SubnetMask")&&(errors.SubnetMask=checkValidation(obj,"SubnetMask")),isNeed("GatewayIPAddress")&&(errors.GatewayIPAddress=checkValidation(obj,"GatewayIPAddress")),isNeed("DNSServer1")&&(errors.DNSServer1=checkValidation(obj,"DNSServer1")),isNeed("DNSServer2")&&(errors.DNSServer2=checkValidation(obj,"DNSServer2")),errors}}]),nw.directive("nwStrictIpValidation",["funcs",function(funcs){var reserved=[{start:"0.0.0.0",end:"0.255.255.255"},{start:"127.0.0.0",end:"127.255.255.255"},{start:"224.0.0.0",end:"239.255.255.255"},{start:"255.255.255.255",end:"255.255.255.255"}];return{restrict:"A",require:"ngModel",link:function($scope,$element,$attrs,$ctrl){function validation(value){var is;return funcs.is.ipv4(value)&&(is=_.some(reserved,function(range){return funcs.ipv4.subnet.belongNetworkRange(range,value)}),$ctrl.$setValidity("msg_invalid_ipv4",!is)),value}$ctrl.$parsers.unshift(validation),$ctrl.$formatters.unshift(validation)}}}]),nw.directive("nwNetworkType",["funcs",function(funcs){return{restrict:"A",require:"ngModel",link:function($scope,$element,$attrs,$ctrl){function validation(value){var isValid="ipv4"==version?validationIpv4(value):validationIpv6(value);return isValid?cleanValidError():$ctrl.$setValidity("invalid_network_"+version,!1),value}function validationIpv4(value){if(!value)return!0;if(!funcs.is.ipv4Network(value))return!1;var ip=value.split("/")[0],mask=value.split("/")[1],net=funcs.ipv4.address.and(ip,funcs.ipv4.mask["long"](mask));return ip!=net?!1:!0}function cleanValidError(){$ctrl.$setValidity("invalid_network_ipv4",!0),$ctrl.$setValidity("invalid_network_ipv6",!0)}var version="ipv4";$attrs.$observe({version:"nwNetworkTypeVersion"}.version,function(value){_.isUndefined(value)||(version=value,cleanValidError())}),$ctrl.$parsers.unshift(validation),$ctrl.$formatters.unshift(validation)}}}]),nw.directive("nwIpExtType",["funcs",function(funcs){return{restrict:"A",require:"ngModel",link:function($scope,$element,$attrs,$ctrl){function validation(value){var isValid="ipv4"==version?validationIpv4(value):validationIpv6(value);return isValid?cleanValidError():$ctrl.$setValidity("msg_invalid_"+version+"_ext",!1),value}function validationIpv4(value){if(!value)return!0;var arrVal=value.split("/"),ip=arrVal[0],mask=arrVal[1];return funcs.is.ipv4(ip)?""==mask?!1:_.isUndefined(mask)||funcs.is.ipv4Prefix(mask)?!0:!1:!1}function validationIpv6(value){if(!value)return!0;var arrVal=value.split("/"),ip=arrVal[0],prefix=arrVal[1];return funcs.is.ipv6(ip)?""==prefix?!1:_.isUndefined(prefix)||funcs.is.ipv6Prefix(prefix)?!0:!1:!1}function cleanValidError(){$ctrl.$setValidity("msg_invalid_ipv4_ext",!0),$ctrl.$setValidity("msg_invalid_ipv6_ext",!0)}var version="ipv4";$attrs.$observe({version:"nwIpExtTypeVersion"}.version,function(value){_.isUndefined(value)||(version=value,cleanValidError())}),$ctrl.$parsers.unshift(validation),$ctrl.$formatters.unshift(validation)}}}])}();
;"use strict";!function(){var nw=angular.module(regdep("nw-ip-range"),[]);nw.directive("nwIpRange",[function(){var rangeTypes=[{value:"range",name:"ip_range_set_as_range"},{value:"subnet",name:"ip_range_set_as_subnet"}];return{restrict:"A",replace:!0,scope:{nwIpRange:"=",nwIpRangeVersion:"@",nwIpStartPlagin:"=",nwIpStartLabel:"@",nwIpStartDisabled:"=",nwIpStartRequired:"=",nwIpEndPlagin:"=",nwIpEndLabel:"@",nwIpEndDisabled:"=",nwIpEndRequired:"=",nwIpSubnetLabel:"@",nwRangeType:"=",nwDisabled:"="},controller:function($scope,$attrs,funcs){$scope.ipRange={rangeTypes:rangeTypes,type:function(version){return"ipv6"==version?funcs.is.ipv6Network:funcs.is.ipv4Network}($scope.nwIpRangeVersion)($scope.nwIpRange.begin)?"subnet":"range",endIpHidden:!1}},plain:!0,template:'<div>    <div nw-field nw-label="ip_range_set_as" nw-disabled="nwDisabled">        <select ng-model="ipRange.type" ng-options="item.value as item.name | translate for item in ipRange.rangeTypes">        </select>    </div>    <div nw-field		 nw-disabled="nwDisabled"        nw-label="{{ipRange.type != \'subnet\'? nwIpStartLabel: nwIpSubnetLabel}}"        nw-required="nwIpStartRequired"     >        <input type="text"            ng-model="nwIpRange.begin"            nw-ip-range-validation="startIp"            nw-ip-range-validation-version="{{nwIpRangeVersion}}"            nw-ip-range-validation-start-ip="nwIpRange.begin"            nw-ip-range-validation-end-ip="nwIpRange.end"            nw-ip-range-type="ipRange.type"            nw-client-list            nw-client-list-version="{{nwIpRangeVersion}}"        >    </div>    <div nw-field		 nw-disabled="nwDisabled"        nw-label="{{nwIpEndLabel}}"        ng-if="ipRange.type != \'subnet\'"        nw-required="nwIpEndRequired"     >        <input type="text"            ng-model="nwIpRange.end"            nw-ip-range-validation="endIp"            nw-ip-range-validation-version="{{nwIpRangeVersion}}"            nw-ip-range-validation-start-ip="nwIpRange.begin"            nw-ip-range-validation-end-ip="nwIpRange.end"            nw-ip-range-type="ipRange.type"            nw-client-list            nw-client-list-version="{{nwIpRangeVersion}}"        >    </div></div>'}}]),nw.directive("nwIpRangeValidation",["nwIpRangeCheckValidation",function(validation){return{restrict:"A",require:"ngModel",scope:{param:"@nwIpRangeValidation",rangeType:"=nwIpRangeType",startIp:"=nwIpRangeValidationStartIp",endIp:"=nwIpRangeValidationEndIp"},link:function($scope,$element,$attrs,$ctrl){function change(value){return checkValidation(value),value}function checkValidation(value){var param=$scope.param,data={version:$attrs.nwIpRangeValidationVersion,startIp:"startIp"==param?value:$scope.startIp,endIp:"endIp"==param?value:$scope.endIp,rangeType:$scope.rangeType},error=validation(data)[param][0];(error||currentError)&&error!=currentError&&($ctrl.$setValidity(currentError,!0),currentError=error),error&&$ctrl.$setValidity(error,!1)}var currentError="";$attrs.$observe("nwIpRangeValidationVersion",function(){checkValidation($ctrl.$viewValue)}),"startIp"==$scope.param&&$scope.$watch("endIp",function(){checkValidation($ctrl.$viewValue)}),"endIp"==$scope.param&&$scope.$watch("startIp",function(){checkValidation($ctrl.$viewValue)});var endIpBackup=_.clone($scope.endIp);$scope.$watch("rangeType",function(value){$scope.rangeType=value,"subnet"==$scope.rangeType?(endIpBackup=_.clone($scope.endIp),$scope.endIp=null):$scope.endIp=endIpBackup,checkValidation($ctrl.$viewValue)}),$ctrl.$parsers.unshift(change),$ctrl.$formatters.unshift(change)}}}]),nw.service("nwIpRangeCheckValidation",["funcs",function(funcs){var ipv4=funcs.ipv4,ipv6=funcs.ipv6,is=funcs.is,ipVersionUtils={ipv4:{isIp:is.ipv4,isIpNetwork:is.ipv4Network,compareAddress:ipv4.address.compare,invalidIpMsg:"msg_invalid_ipv4",invalidSubnetMsg:"msg_invalid_ipv4_subnet"},ipv6:{isIp:is.ipv6,isIpNetwork:is.ipv6Network,compareAddress:ipv6.address?ipv6.address.compare:function(){},invalidIpMsg:"msg_invalid_ipv6",invalidSubnetMsg:"msg_invalid_ipv6_subnet"}};return function(data){var compare,errors={startIp:[],endIp:[]};if(!data.version)return errors;var utils=ipVersionUtils[data.version];if("subnet"==data.rangeType&&data.startIp&&!utils.isIpNetwork(data.startIp)&&errors.startIp.push(utils.invalidSubnetMsg),"subnet"!=data.rangeType&&data.startIp&&!utils.isIp(data.startIp)&&errors.startIp.push(utils.invalidIpMsg),"subnet"!=data.rangeType&&data.endIp&&!utils.isIp(data.endIp)&&errors.endIp.push(utils.invalidIpMsg),"subnet"!=data.rangeType&&data.startIp&&data.endIp&&utils.isIp(data.startIp)&&utils.isIp(data.endIp))switch(compare=utils.compareAddress(data.startIp,data.endIp)){case 1:errors.startIp.push("msg_error_start_ip_more_end_ip"),errors.endIp.push("msg_error_end_ip_less_start_ip");break;case 0:errors.startIp.push("msg_error_start_ip_equal_end_ip"),errors.endIp.push("msg_error_start_ip_equal_end_ip")}return errors}}])}();
;"use strict";!function(){var nw=angular.module(regdep("nw-port-range"),[]);nw.directive("nwPortRange",[function(){return{restrict:"A",replace:!0,compile:function($element,$attrs){function getPort($attrs,name){var attrName=capitalizeFirstLetter(name),label=$attrs["nwPort"+attrName+"Label"],model=$attrs["nwPort"+attrName+"Model"],disabled=$attrs["nwPort"+attrName+"Disabled"],required=$attrs["nwPort"+attrName+"Required"],startModel=$attrs.nwPortStartModel,endModel=$attrs.nwPortEndModel,usePorts=$attrs.nwPortUsePorts,portTm="";return portTm+="<div nw-field ",portTm+='nw-label="'+label+'" ',disabled&&(portTm+='nw-disabled="'+disabled+'" '),required&&(portTm+='nw-required="'+required+'" '),portTm+=">",portTm+='<input type="text" ',model&&(portTm+='ng-model="'+model+'" ',portTm+='nw-port-range-validation="'+name+'Port" ',portTm+='nw-port-range-validation-start-port="'+startModel+'" ',portTm+='nw-port-range-validation-end-port="'+endModel+'" ',usePorts&&(portTm+='nw-port-range-validation-use-ports="'+usePorts+'" ')),portTm+="/>",portTm+="</div>"}function capitalizeFirstLetter(str){return str.charAt(0).toUpperCase()+str.slice(1)}var template="<div>";template+=getPort($attrs,"start"),template+=getPort($attrs,"end"),template+="</div>",$element.append(template)}}}]),nw.directive("nwPortRangeValidation",["nwPortRangeCheckValidation","$document",function(validation,$document){return{restrict:"A",require:"ngModel",scope:{param:"@nwPortRangeValidation",startPort:"=nwPortRangeValidationStartPort",endPort:"=nwPortRangeValidationEndPort",usePorts:"=nwPortRangeValidationUsePorts"},link:function($scope,$element,$attrs,$ctrl){function change(value){return checkValidation(value),value}function checkValidation(value){var param=$scope.param,data={startPort:"startPort"==param&&value?value:$scope.startPort,endPort:"endPort"==param&&value?value:$scope.endPort,usePorts:$scope.usePorts||[]},error=validation(data,param)[param][0];(error||currentError)&&error!=currentError&&($ctrl.$setValidity(currentError,!0),currentError=error),error&&$ctrl.$setValidity(error,!1)}var currentError="";"endPort"==$scope.param&&$scope.$watch("startPort",function(){checkValidation($ctrl.$viewValue)}),$scope.$watch("usePorts",function(){checkValidation($ctrl.$viewValue)},!0),$scope.$watch(function(){"endPort"!=angular.element($document[0].activeElement).attr("nw-port-range-validation")&&checkValidation()}),$ctrl.$parsers.unshift(change),$ctrl.$formatters.unshift(change)}}}]),nw.service("nwPortRangeCheckValidation",["funcs",function(funcs){var is=funcs.is;return function(data){function isInvalidPort(port){return port&&!is.port(port)}function comparePorts(startPort,endPort){return startPort&&endPort?parseInt(startPort)>parseInt(endPort)?1:parseInt(startPort)==parseInt(endPort)?0:-1:-1}function isUsePorts(port,usePorts){return port?_.some(usePorts,function(elem){var startPort=elem.startPort?parseInt(elem.startPort):null,endPort=elem.endPort?parseInt(elem.endPort):null,curPort=parseInt(port);return elem.startPort&&elem.endPort?curPort>=startPort&&endPort>=curPort:elem.startPort?startPort==curPort:elem.endPort?endPort==curPort:!1}):!1}function isOverlapRange(startPort,endPort,usePorts){return startPort&&endPort?_.some(usePorts,function(elem){var elemStartPort=elem.startPort?parseInt(elem.startPort):null,elemEndPort=elem.endPort?parseInt(elem.endPort):null,curStartPort=parseInt(startPort),curEndPort=parseInt(endPort);return elemStartPort&&elemStartPort>curStartPort&&curEndPort>elemStartPort||elemEndPort&&elemEndPort>curStartPort&&curEndPort>elemEndPort}):!1}var compare,errors={startPort:[],endPort:[]};if(isInvalidPort(data.startPort)&&errors.startPort.push("msg_invalid_port"),isInvalidPort(data.endPort)&&errors.endPort.push("msg_invalid_port"),!errors.startPort.length&&!errors.endPort.length){switch(compare=comparePorts(data.startPort,data.endPort)){case 1:errors.startPort.push("msg_error_start_port_more_end_port"),errors.endPort.push("msg_error_start_port_less_end_port");break;case 0:errors.startPort.push("msg_error_start_port_equal_end_port"),errors.endPort.push("msg_error_start_port_equal_end_port")}isUsePorts(data.startPort,data.usePorts)&&errors.startPort.push("msg_error_port_is_busy"),isUsePorts(data.endPort,data.usePorts)&&errors.endPort.push("msg_error_port_is_busy")}return errors.startPort.length||errors.endPort.length||isOverlapRange(data.startPort,data.endPort,data.usePorts)&&(errors.startPort.push("msg_error_port_range_is_overlap"),errors.endPort.push("msg_error_port_range_is_overlap")),errors}}])}();
;"use strict";!function(){function getNwFiled($element){for(var $nwField=$element.parent();$nwField&&!$nwField.hasClass("nwfield_element");)$nwField=$nwField.parent();return $nwField}var nw=angular.module(regdep("nw-mac"),[]);nw.directive("nwMacClone",["$compile",function($compile){return{restrict:"A",priority:1e3,link:function($scope,$element,$attrs){var $nwField=getNwFiled($element),template="<div nw-mac-clone-core nw-mac-clone-core-value="+$attrs.ngModel+"></div>",$cloneMac=angular.element($compile(template)($scope));$nwField&&$nwField.after($cloneMac),$scope.$on("nwmac.clone",function($event,value){value?$element.attr("nw-input-disabled","disabled"):$element.removeAttr("nw-input-disabled")})}}}]),nw.directive("nwMacCloneCore",["translate","nwMacPull",function(translate,nwMacPull){return{restrict:"A",template:'<div class="nw-mac-clone__container" ng-if="clone.isShow()"><div nw-labeled-switch nw-label="clone.getLabel()" nw-model="clone.state" nw-change="clone.changeState(clone.state)" nw-disabled="clone.isDisabled()" ></div></div>',scope:{value:"=nwMacCloneCoreValue"},link:function($scope){function changeState(value){$scope.$emit("nwmac.clone",value),value?cloneMac():cancelCloneMac()}function cloneMac(){$scope.clone.backupMac=_.clone($scope.value),$scope.value=clone.client}function cancelCloneMac(){_.isNull($scope.clone.backupMac)||($scope.value=_.clone($scope.clone.backupMac),$scope.clone.backupMac=null)}function isClientMac(){return!_.isNull(clone.client)&&clone.client.toUpperCase()==$scope.value.toUpperCase()}function isCanClone(){return!_.isNull(clone.client)}$scope.clone={isActivate:!1,state:!1,client:null,backupMac:null,getLabel:function(){var msg="";return isClientMac()?msg+=translate("wan_client_mac_address_used"):(msg+=translate("wan_clone_mac_address_message"),clone.client&&(msg+=" ("+clone.client.toUpperCase()+")")),msg},changeState:changeState,isShow:function(){return clone.isActivate&&isCanClone()}};var clone=$scope.clone;$scope.$watch("value",function(newValue,oldValue){newValue.toUpperCase()!=oldValue.toUpperCase()&&(clone.state=isClientMac(),$scope.$emit("nwmac.clone",clone.state))}),nwMacPull.pull().then(function(data){(function(data){return data&&data.mac&&data.mac.client})(data)&&(clone.client=data.mac.client.toUpperCase(),clone.isActivate=!0,clone.state=isClientMac(),changeState(clone.state))})}}}]),nw.directive("nwMacRestore",["$compile",function($compile){return{restrict:"A",priority:999,link:function($scope,$element,$attrs){var $nwField=getNwFiled($element),template="<div nw-mac-restore-core nw-mac-restore-core-value="+$attrs.ngModel+" nw-mac-restore-core-default-value = "+$attrs.nwMacRestore+".toUpperCase()></div>",$resoreMac=angular.element($compile(template)($scope));$nwField&&$nwField.after($resoreMac)}}}]),nw.directive("nwMacRestoreCore",["translate","nwMacPull",function(translate,nwMacPull){return{restrict:"A",template:'<div class="button_block center no_top_margin bottom_margin" ng-if="restore.isShow()"><button type="button" class="colored" ng-click="restore.setMac()" ng-bind="\'wan_restore_mac_address_message\' | translate" ng-disabled="restore.isDisabled()" ></button></div>',scope:{value:"=nwMacRestoreCoreValue",defaultValue:"=nwMacRestoreCoreDefaultValue"},link:function($scope){function isCanRestore(){return $scope.defaultValue&&(restore.device.internet=$scope.defaultValue),!_.isNull(restore.device.internet)}function isDeviceMac(){var mac=getMacIf();return!_.isNull(mac)&&mac.toUpperCase()==$scope.value.toUpperCase()}function getMacIf(){return"WiFi"==$scope.$parent.media.type?restore.device.wlan:restore.device.internet}$scope.restore={isActivate:!1,state:!1,device:null,setMac:function(){$scope.value=getMacIf()},isShow:function(){return restore.isActivate&&isCanRestore()},isDisabled:function(){return isDeviceMac()}};var keyWlan,restore=$scope.restore,media=$scope.$parent.media.data;media.WiFi&&(keyWlan=media.WiFi.__Key,nwMacPull.keyWlan!==keyWlan?(nwMacPull.keyWlan=keyWlan,nwMacPull.isWlanChanged=!0):nwMacPull.isWlanChanged=!1),nwMacPull.pull().then(function(data){(function(data){return data&&data.mac&&data.mac.device})(data)&&(restore.device=data.mac.device,restore.isActivate=!0)})}}}]),nw.factory("nwMacPull",["$q","devinfo","$timeout",function($q,devinfo){function pull(){function init(data){function hasDeviceMacWlan(data){return!_.isUndefined(data.bssid)}function hasDeviceMacWlan5G(data){return!_.isUndefined(data["5G_bssid"])}isLoading=!1,cache.mac={client:function(data){return!_.isUndefined(data.client)&&!_.isUndefined(data.client.mac)}(data)?data.client.mac:null,device:{internet:function(data){return!_.isUndefined(data.deviceMac)}(data)?data.deviceMac.toUpperCase():null,wlan:function(data){if(!_.isUndefined(data)&&!_.isUndefined(data.ApCliRangeFreq)){if("2.4 GHz"===data.ApCliRangeFreq)return hasDeviceMacWlan(data)?data.bssid:null;if("5 GHz"===data.ApCliRangeFreq)return hasDeviceMacWlan5G(data)?data["5G_bssid"]:null}return null}(data.deviceMacWiFi)}},deferred.resolve(cache)}var deferred=$q.defer();return isLoading?promise:(_.isEmpty(cache)||this.isWlanChanged?(isLoading=!0,promise=deferred.promise,devinfo.once("version|client").then(init),this.isWlanChanged=!1):deferred.resolve(cache),deferred.promise)}var promise,isLoading=!1,cache={};return{pull:pull,keyWlan:null,isWlanChanged:!1}}])}();
;"use strict";!function(){var nw=angular.module(regdep("nw-drop-list"),[]);nw.directive("nwDropList",["$compile",function($compile){var KEY_CODE={TAB:9};return{restrict:"A",require:"ngModel",link:function($scope,$element,$attrs){function init(){$nwDropBtn=angular.element('<i class="nw-drop-list-btn"></i>'),$nwDropList=angular.element($compile(templateList)($scope)),$parent.addClass("nw-drop-list-wrap"),$parent.prepend($nwDropBtn),$parent.append($nwDropList),$nwDropBtn.bind("mousedown",function($event){return $event.preventDefault(),!1}),$nwDropBtn.bind("click",function(){$scope.$broadcast("drop-list-btn.change-active",!isActive)}),$element.bind("focus",function(){$scope.$broadcast("element.active")}),$element.bind("blur",function(){$scope.$broadcast("element.leave")}),$element.bind("keydown",function($event){0!=isActive&&$event.keyCode==KEY_CODE.TAB&&($scope.$broadcast("element.leave"),$scope.$apply())}),$scope.$on("drop-list.active",function(){isActive=!0,$nwDropBtn.addClass("nw-drop-list-btn--active")}),$scope.$on("drop-list.leave",function(){isActive=!1,$nwDropBtn.removeClass("nw-drop-list-btn--active")}),$scope.$on("drop-list.isEmpty",function($event,value){value?$nwDropBtn.addClass("nw-drop-list-btn--hide"):$nwDropBtn.removeClass("nw-drop-list-btn--hide")}),$scope.$watch(function(){return $element.attr("disabled")},function(value){value?$nwDropBtn.addClass("nw-drop-list-btn--disabled"):$nwDropBtn.removeClass("nw-drop-list-btn--disabled")})}var $nwDropBtn,$nwDropList,$parent=$element.parent(),templateList="<div nw-drop-list-core nw-drop-list-core-value="+$attrs.ngModel+" nw-drop-list-core-options="+$attrs.nwDropListOptions+" ></div>",isActive=!1;init()}}}]),nw.directive("nwDropListCore",["$window","$document",function($window,$document){return{restrict:"A",replace:!0,template:'<div tabindex="-1" class="nw-drop-list" ><div class="nw-drop-list__item" ng-class="{\'nw-drop-list__item--active\': active.check($index) }"ng-click="updateValue($event, option.value)" ng-repeat="option in options" ><span class="nw-drop-list__item-title" ng-bind="option.title"></span> <span class="nw-drop-list__item-subtitle" ng-bind="option.subtitle"></span></div></div>',scope:{value:"=nwDropListCoreValue",options:"=nwDropListCoreOptions"},link:function($scope,$element){function isEmpty(){return!$scope.options.length}function correctElementScroll(){function getScrollTop(){return $window.scrollY||$document[0].documentElement.scrollTop||$document[0].body.scrollTop}var scrollTop,scrollHeight,body=$document[0].body,container=$element[0],bodyCords=body.getBoundingClientRect(),containerCords=container.getBoundingClientRect(),bodyBottom=bodyCords.bottom-bodyCords.top,containerBottom=containerCords.bottom;containerBottom>bodyBottom&&(scrollTop=getScrollTop(),scrollHeight=containerBottom-bodyBottom+20,"scrollTopAnimated"in $document?$document.scrollTopAnimated(scrollTop+scrollHeight):$window.scrollTo(0,scrollTop+scrollHeight))}$scope.isListActive=!1,$scope.workOnList=!1,$scope.isElementActive=!1,$scope.updateValue=function($event,value){$event.preventDefault(),$scope.value=value,$scope.isListActive=!1},$scope.$on("drop-list-btn.change-active",function($event,value){$scope.isListActive=value,value&&($scope.isElementActive=!0)}),$scope.$on("element.active",function(){$scope.isElementActive=!0}),$scope.$on("element.leave",function(){$scope.isElementActive=!1}),$element.bind("mousedown touchstart",function(){$scope.workOnList=!0}),$element.bind("mouseup touchend",function(){$scope.workOnList=!1}),$scope.$watch(function(){return $scope.isListActive&&($scope.isElementActive||$scope.workOnList)},function(value){isEmpty()||(value?($element.addClass("nw-drop-list--show"),$scope.$emit("drop-list.active"),correctElementScroll()):($element.removeClass("nw-drop-list--show"),$scope.$emit("drop-list.leave"),$scope.isListActive=!1))}),$scope.$watch(isEmpty,function(value){value?$element.addClass("nw-drop-list--hide"):$element.removeClass("nw-drop-list--hide"),$scope.$emit("drop-list.isEmpty",value)})}}}])}();
;"use strict";!function(){function dLinkMobileAppAvailable(){return"undefined"!=typeof dlinkMobileApp}function getBrowserBridge(){return{"void":function(){return function(){}},promise:function(){return function(){return Promise.reject("not mobile app")}},withArgs:function(){return function(){}},promiseWithArgs:function(){return function(){return Promise.reject("not mobile app")}},isExist:function(){return!1},customLocalDomainCheck:!1}}function getAndroidBridge(){return{"void":function(name){return function(){dlinkMobileApp[name]()}},promise:function(name){return function(){return Promise.resolve(dlinkMobileApp[name]())}},withArgs:function(name,stringify){return function(arg){var data=arg;stringify&&(data=JSON.stringify(arg)),dlinkMobileApp[name](data)}},promiseWithArgs:function(name,stringify){return function(arg){var data=arg;return stringify&&(data=JSON.stringify(arg)),Promise.resolve(dlinkMobileApp[name](data))}},isExist:function(name){return"undefined"!=typeof dlinkMobileApp[name]},customLocalDomainCheck:!0}}function getIosBridge(){function callNativeIOS(methodName,params){return new Promise(function(resolve,reject){var promiseId=generateUUID();promises[promiseId]={resolve:resolve,reject:reject};try{params.promiseId=promiseId,window.webkit.messageHandlers[methodName].postMessage(params)}catch(exception){reject("error while calling native function")}})}function generateUUID(){var d=(new Date).getTime(),uuid="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=(d+16*Math.random())%16|0;return d=Math.floor(d/16),("x"==c?r:3&r|8).toString(16)});return uuid}return{"void":function(name){return function(){window.webkit.messageHandlers[name].postMessage({})}},promise:function(name){return function(){return callNativeIOS(name,{})}},withArgs:function(name){return function(arg){window.webkit.messageHandlers[name].postMessage(arg)}},promiseWithArgs:function(name){return function(arg){return callNativeIOS(name,{data:arg})}},isExist:function(name){return"undefined"!=typeof window.webkit.messageHandlers[name]},customLocalDomainCheck:!1}}var mobileAppModule=angular.module(regdep("dlink-mobile-app"),[]);mobileAppModule.service("mobileapp",["$rootScope","$injector",function($rootScope,$injector){function radioToAccessPoint(radio){if("undefined"!=typeof radio){var firstAccessPoint,accessPoint={};return radio.AccessPoint&&(accessPoint.frequency=radio.OperatingFrequencyBand,firstAccessPoint=radio.AccessPoint[1])?(accessPoint.index=1,accessPoint.ssid=firstAccessPoint.SSID,accessPoint.password=firstAccessPoint.Security.PreSharedKey,accessPoint):void 0}}function saveWrapperForIpChangedFunc(ipConfig){var funcName="ipAddressChangedAdvanced";current.isExist(funcName)&&current.withArgs(funcName,!0)(ipConfig)}function saveWrapperForDomainNameFunc(domainName){var funcName="domainNameChanged";current.isExist(funcName)&&current.withArgs(funcName,!1)(domainName)}function getValue(key){return current.isExist("getValue")?current.promiseWithArgs("getValue",!1)(key):Promise.reject("function does not exist")}function saveValue(key,value){var data;current.isExist("saveValue")&&(data={},data.key=key,data.value=value,current.withArgs("saveValue",!0)(data))}var current,translate,devinfo,util,snackbars;current=/DRCU\/IOS/i.test(navigator.userAgent)?getIosBridge():dLinkMobileAppAvailable()?getAndroidBridge():getBrowserBridge();var allServicesAvailable=$injector.has("translate")&&$injector.has("devinfo")&&$injector.has("systemUtil")&&$injector.has("snackbars");return dLinkMobileAppAvailable()&&allServicesAvailable&&(translate=$injector.get("translate"),devinfo=$injector.get("devinfo"),util=$injector.get("systemUtil"),snackbars=$injector.get("snackbars"),dlinkMobileApp.askUserToChangeLanguage=function(message,userLanguageCode){devinfo.once("version").then(function(result){var lang,overlay,overlayId;result.lang!==userLanguageCode&&"eng chs cht kor rus".indexOf(userLanguageCode)>=0&&(confirm(message)?(lang=userLanguageCode,overlay=$rootScope.overlay.circular,overlayId=overlay.start(),util.changeLang(lang).then(translate.changeLanguage.bind(translate,lang))["catch"](snackbars.add.bind(snackbars,translate("sysconfig_change_lang_error")))["finally"](overlay.stop.bind(overlay,overlayId))):current["void"]("userRefuseToChangeLanguage")())})}),{isUserInMobileApp:function(){return dLinkMobileAppAvailable()},closeWebInterface:current["void"]("exit"),openWifiSettings:current["void"]("openWifiSettings"),askUserToLogout:current["void"]("askUserToLogout"),deviceResetStarted:current["void"]("deviceReset"),isPhoneConnectedToRouter:current.promise("isPhoneConnectedToRouter"),isNotificationsBlocked:current.promise("isNotificationsBlocked"),ipAddressChanged:current.withArgs("ipAddressChanged",!1),hasAdvancedIpAddressChanged:current.isExist("ipAddressChangedAdvanced"),ipAddressChangedAdvanced:current.withArgs("ipAddressChangedAdvanced",!0),updatePassword:current.withArgs("updatePassword",!0),wifiConnectionChanged:function(platformFunc){return function(newWifiSettings){if("undefined"==typeof newWifiSettings)return Promise.reject("no new wifi settings");if("undefined"==typeof newWifiSettings.ProfileId)return Promise.reject("no profile id");if("undefined"==typeof newWifiSettings.SSID)return Promise.reject("no ssid");if("undefined"==typeof newWifiSettings.Frequency)return Promise.reject("no frequency");"undefined"==typeof newWifiSettings.PreSharedKey&&(newWifiSettings.PreSharedKey=null);var converted={index:newWifiSettings.ProfileId,ssid:newWifiSettings.SSID,password:newWifiSettings.PreSharedKey,frequency:newWifiSettings.Frequency};return platformFunc(JSON.stringify(converted)),Promise.resolve()}}(current.withArgs("wifiPointChanged",!1)),getCredentials:function(promiseFunc){return function(){return promiseFunc().then(function(data){var credentials=JSON.parse(data);return"undefined"==typeof credentials?Promise.reject("credentials undefined"):"undefined"==typeof credentials.username?Promise.reject("credentials.username undefined"):"undefined"==typeof credentials.password?Promise.reject("credentials.password undefined"):Promise.resolve(credentials)})}}(current.promise("getCredentials")),isDomainNameUsing:current.promise("isDomainNameUsing"),customLocalDomainCheck:current.customLocalDomainCheck,wizardCompleted:function(passwordFunc,wifiFunc,ipAddressFunc,domainNameFunc){return function(native){if(dLinkMobileAppAvailable()){var passwords,point,ip,domainName,converted,config=native.Config;config.SystemPassword&&(passwords={},passwords.username=config.SystemPassword.Login,passwords.password=config.SystemPassword.Password,passwordFunc(passwords)),config.WiFi&&config.WiFi.Radio&&(point=radioToAccessPoint(config.WiFi.Radio[1]),point&&wifiFunc(JSON.stringify(point)),point=radioToAccessPoint(config.WiFi.Radio[2]),point&&wifiFunc(JSON.stringify(point))),config.LAN&&config.LAN[1]&&(ip=config.LAN[1].IPv4,ip.StaticIP[1]&&ip.StaticIP[1].AddnHostname&&(domainName=ip.StaticIP[1].AddnHostname,domainNameFunc(domainName)),converted={disconnect:!1,save:!0},"Static"===ip.AddressingMode&&ip.StaticIP[1]?(converted.address=ip.StaticIP[1].Address,ipAddressFunc(converted)):"Dynamic"===ip.AddressingMode&&domainName&&(converted.address=domainName,ipAddressFunc(converted)))}}}(current.withArgs("updatePassword",!0),current.withArgs("wifiPointChanged",!1),saveWrapperForIpChangedFunc,saveWrapperForDomainNameFunc),getValue:getValue,saveValue:saveValue,hasSaveValueFunc:current.isExist("saveValue"),hasGetValueFunc:current.isExist("getValue")}}]).run(["$rootScope","mobileapp",function($rootScope,mobileapp){$rootScope.dlinkMobileApp=mobileapp}])}();
;"use strict";!function(){var getMobileApp=angular.module(regdep("nw-get-mobile-app"),[]),appleDefault="en-us";getMobileApp.constant("langIndex",{eng:{android:"en",ios:"en-us"},rus:{android:"ru",ios:"ru-ru"},ukr:{android:"ua",ios:appleDefault},heb:{android:"iw",ios:appleDefault},tur:{android:"tr",ios:"tr-tr"},arm:{android:"hy",ios:appleDefault},fra:{android:"fr",ios:"fr-fr"},ara:{android:"ar",ios:appleDefault},fas:{android:"fa",ios:appleDefault},kaz:{android:"kk",ios:appleDefault},lit:{android:"lt",ios:appleDefault},kor:{android:"ko",ios:"ko-kr"},ger:{android:"de",ios:"de-de"},spa:{android:"es",ios:"es-es"},por:{android:"pt",ios:"pt-pt"},ita:{android:"it",ios:"it-it"},chs:{android:"zh-cn",ios:"zh-cn"},cht:{android:"zh-tw",ios:"zh-tw"},afr:{android:"af",ios:appleDefault},alb:{android:"sq",ios:appleDefault},amh:{android:"am",ios:appleDefault},aze:{android:"az",ios:appleDefault},bas:{android:"eu",ios:appleDefault},bel:{android:"be",ios:appleDefault},bos:{android:"bs",ios:appleDefault},ben:{android:"bn",ios:appleDefault},bul:{android:"bg",ios:appleDefault},bur:{android:"my",ios:appleDefault},cat:{android:"ca",ios:appleDefault},cro:{android:"hr",ios:appleDefault},cze:{android:"cs",ios:appleDefault},dan:{android:"da",ios:"da-dk"},dut:{android:"nl",ios:appleDefault},est:{android:"et",ios:appleDefault},fil:{android:"fil",ios:appleDefault},fin:{android:"fi",ios:"fi-fi"},gal:{android:"gl",ios:appleDefault},geo:{android:"ka",ios:appleDefault},gre:{android:"el",ios:appleDefault},hin:{android:"hi",ios:appleDefault},hun:{android:"hu",ios:appleDefault},ice:{android:"is",ios:appleDefault},ind:{android:"id",ios:"id-id"},jap:{android:"ja",ios:"ja-jp"},kan:{android:"kn",ios:"fr-ca"},kyr:{android:"ky",ios:appleDefault},lat:{android:"lv",ios:appleDefault},mac:{android:"mk",ios:appleDefault},mon:{android:"mn",ios:appleDefault},nep:{android:"ne",ios:appleDefault},nor:{android:"no",ios:"no-no"},pol:{android:"pl",ios:appleDefault},rom:{android:"ro",ios:appleDefault},ser:{android:"sr",ios:appleDefault},slo:{android:"sk",ios:appleDefault},swe:{android:"sv",ios:"sv-se"},vie:{android:"vi",ios:"vi-vn"}}),getMobileApp.directive("nwGetMobileApp",["translate","langIndex","$rootScope",function(translate,langIndex,$rs){return{restrict:"A",controller:"getMobileController",scope:{utmCampaign:"@",utmSource:"@",nwGetAppText:"="},link:function(scope,element){function init(){element.empty(),element.css("display","none");var androidBadge=getAndroidBadge(),iosBadge=getIosBadge(),text=angular.element("<div></div>");text.text(scope.nwGetAppText),element.append(text),element.append(iosBadge),element.append(androidBadge)}function getCurrentLang(){var currentLang=translate.getLang();return"undefined"!=typeof langIndex[currentLang]?langIndex[currentLang]:langIndex.eng}function checkIsNeedShowGetMobileApp(){var userAgent=navigator.userAgent;return isAndroid=!!function(){return userAgent.match(/Android/i)}(),isIos=!!function(){return userAgent.match(/like Mac OS X/i)&&userAgent.match(/Mobile/i)}(),isDesktop=!!function(){return userAgent.match(/Windows NT/i)||userAgent.match(/Linux/i)&&!userAgent.match(/Android/i)||userAgent.match(/Macintosh/i)}(),isMobileApp="undefined"!=typeof window.dlinkMobileApp||/DRCU\/IOS/i.test(navigator.userAgent),{main:(isAndroid||isDesktop||isIos)&&!isMobileApp,isAndroid:isAndroid,isIos:isIos,isDesktop:isDesktop}}function getAndroidBadge(){var imgHref="https://play.google.com/intl/en_us/badges/images/generic/"+getCurrentLang().android+"_badge_web_generic.png",utm_source=scope.utmSource?"&utm_source="+scope.utmSource:"",utm_campaign=scope.utmCampaign?"&utm_campaign="+scope.utmCampaign:"",img=angular.element('<img class="googlePlay-badge-img">');img.attr("src",imgHref),img.attr("style","width: 170px; margin: 0px 5px"),img[0].onload=scope.onloadAndroidImg.bind(element);var a=angular.element("<a></a>");return a.attr("href","https://play.google.com/store/apps/details?id=ru.dlink.drcu"+utm_source+utm_campaign+"&pcampaignid=MKT-Other-global-all-co-prtnr-py-PartBadge-Mar2515-1"),a.css("display",checkShow.isAndroid||checkShow.isDesktop?"inline-block":"none"),a.append(img),a}function getIosBadge(){var imgHref="https://linkmaker.itunes.apple.com/"+getCurrentLang().ios+"/badge-lrg.svg?releaseDate=2016-03-10&kind=iossoftware&bubble=ios_apps",a=angular.element("<a></a>"),img=angular.element('<img class="appStore-badge-img">');return img.attr("src",imgHref),img.attr("style","width: 147px; padding-bottom: 11px; margin-top: 10px; margin-left: 5px; margin-right: 5px"),img[0].onload=scope.onloadIosImg.bind(element),a.attr("href","https://itunes.apple.com/ru/app/d-link-assistant/id1342564878?mt=8"),a.css("display",checkShow.isIos||checkShow.isDesktop?"inline-block":"none"),a.append(img),a}var checkShow=checkIsNeedShowGetMobileApp();if(!checkShow.main)return void element.remove();init(),$rs.$on("changelang",function(){init()});var isAndroid=null,isDesktop=null,isMobileApp=null,isIos=null}}}]),getMobileApp.controller("getMobileController",["$scope",function($scope){var isAndroidLoad=!1,isIosLoad=!1;$scope.onloadAndroidImg=function(){isAndroidLoad=!0,isIosLoad&&this.css("display","block")},$scope.onloadIosImg=function(){isIosLoad=!0,isAndroidLoad&&this.css("display","block")}}])}();
;"use strict";!function(){var nw=angular.module(regdep("nw-circles"),[]);nw.directive("nwCircles",["$rootScope",function($rootScope){return{restrict:"AEC",scope:{nwCircles:"=",nwCirclesPause:"=",nwCirclesCallback:"&"},template:'<div class="mycircle_wrap"></div>',link:function($scope,$element){function callback(status){$scope.nwCirclesCallback&&$scope.nwCirclesCallback({status:status})}var intervalID,paused=!1;$scope.$watch("nwCirclesPause",function(isPaused){paused=!!isPaused}),$scope.$watch("nwCircles",function(progress_max){var progress_max,circles,circle_count,progress,i,lastStamp;if(callback("started"),progress_max&&parseInt(progress_max)>=0){var calcApplyCircleMargin=function(index){return Math.min((progress-progress_max/circle_count*(index+1))/(progress_max/10)*11,0)},calcApplyCircleShow=function(index){return progress>=progress_max/circle_count*index};for(circles=$element.find("div")[0],circle_count=10,progress_max=parseInt($scope.nwCircles),progress=0,angular.element(circles).empty(),i=0;circle_count>i;i++)angular.element(circles).append('<span class="circle"><div class="bg"></div></span>');lastStamp=_.now(),intervalID=setInterval(function(){if(!paused){progress+=_.now()-lastStamp,lastStamp=_.now();var i,circlesArray=angular.element(circles).find("div");if(!circlesArray||0==circlesArray.length)return void clearTimeout(intervalID);for(i=0;circle_count>i;i++)angular.element(circlesArray[i]).css("margin-left",calcApplyCircleMargin(i)+"px"),angular.element(circlesArray[i]).css("display",calcApplyCircleShow(i)?"block":"none");progress>=progress_max&&($rootScope.$broadcast("cricle_bar_finished"),clearTimeout(intervalID),callback("finished"))}},200)}else clearTimeout(intervalID)})}}}]),nw.directive("nwStepCircles",["$interval",function($interval){return{restrict:"AEC",scope:{nwStepCirclesCount:"=",nwStepCirclesValue:"=",nwAutoAnim:"=",nwAutoAnimFinished:"="},template:'<div class="mycircle_wrap"> 					<span class="circle" ng-repeat="i in count"> 						<div ng-if="!nwAutoAnim" class="bg" ng-style="{display: (nwStepCirclesValue > i)?\'block\':\'none\'}"></div> 						<div ng-if="nwAutoAnim" class="bg" ng-style="{display: (incr > i)?\'block\':\'none\'}"></div> 					</span> 				</div>',link:function($scope){var intervalID;$scope.count=_.range($scope.nwStepCirclesCount),$scope.incr=0,$scope.nwAutoAnim&&(intervalID=$interval(function(){$scope.incr++,$scope.nwAutoAnimFinished&&$scope.incr==$scope.nwStepCirclesCount?$interval.cancel(intervalID):$scope.incr>$scope.nwStepCirclesCount&&($scope.incr=0)},2e3),$scope.$on("$destroy",function(){$interval.cancel(intervalID)}))}}}])}();
;"use strict";!function(){var nw=angular.module(regdep("nw-progress-bar"),[]);nw.directive("nwProgressBar",function(){function pbTypeClass(pbType){return pbTypeClasses[pbType]||""}var pbTypeClasses={indeter:"indeter"};return{template:'<div class="nw-progress-bar {{pbTypeClass}} {{pbHidden ? \'hidden\' : \'\'}}"><div class="nw-progress-text">{{pbText}}</div><div class="nw-progress-bg"></div><div class="nw-progress-band" ng-class="{ unicolor : isUnicolor }" ng-style="{\'width\':pbValue + \'%\', \'background-color\': getProgressColor()}"></div></div>',replace:!0,plain:!0,restrict:"AE",scope:{pbValue:"=",pbText:"=",pbType:"=",pbHidden:"=",pbUnicolor:"="},link:function($scope){var maxColorChannelValue=215;$scope.pbTypeClass=pbTypeClass($scope.pbType),$scope.getProgressColor=function(){return $scope.pbUnicolor?void($scope.isUnicolor=!0):$scope.pbValue?$scope.pbValue<=50?"rgb("+parseInt(maxColorChannelValue*$scope.pbValue/50)+","+maxColorChannelValue+",0)":"rgb("+maxColorChannelValue+","+(maxColorChannelValue-parseInt(maxColorChannelValue*($scope.pbValue-50)/50))+",0)":"'inherit'"}}}}),nw.directive("nwAutoProgressBar",["$interval","$rootScope",function($interval,$rootScope){return{template:'<nw-progress-bar pb-unicolor="pbUnicolor" pb-value="calcValue()"></nw-progress-bar>',restrict:"AE",scope:{pbDuration:"=",pbPause:"=",pbCallback:"&",pbUnicolor:"="},link:function($scope){function start(){value=0,$interval.cancel(promise),pbCallback("started"),promise=$interval(function(){value+=intervalValue,value>=$scope.pbDuration&&($rootScope.$broadcast("cricle_bar_finished"),$interval.cancel(promise),pbCallback("finished"))},intervalValue)}function stop(){$interval.cancel(promise)}function pbCallback(status){$scope.pbCallback&&$scope.pbCallback({status:status})}var promise=null,intervalValue=1e3,value=0;$scope.calcValue=function(){return value/$scope.pbDuration*100},$scope.$watch("pbPause",function(pbPause){pbPause===!1?start():stop()})}}}])}();
;"use strict";!function(){var nw=angular.module(regdep("nw-progress-circular"),[]);nw.directive("nwProgressCircular",function(){return{plain:!0,restrict:"AE",replace:!0,template:'<div class="circular_spinner svg_spinner"><svg class="circular" viewBox="25 25 50 50"><circle class="path" cx="50" cy="50" r="20" fill="none" stroke-width="4" stroke-miterlimit="10"/></svg></div>',link:function($scope){$scope.dots=_.range(8)}}}),nw.directive("nwProgressMiniCircular",function(){return{plain:!0,restrict:"AE",replace:!0,template:'<div class="circular_spinner_mini svg_spinner"><svg class="mini_circular" viewBox="16 16 16 16"><circle class="mini_path" cx="8" cy="8" r="5" fill="none" stroke-width="4" stroke-miterlimit="10"/></svg></div>',link:function($scope){$scope.dots=_.range(8)}}})}();
;"use strict";!function(){var nw=angular.module(regdep("nw-nocache"),[]);nw.filter("nocache",function(){var rand=_.random(1e5,999999);return function(input){return input+"?"+rand}})}();
;"use strict";angular.module(regdep("nw-data-href"),[]).directive("nwDataHref",["base64",function(base64){return{restrict:"AEC",scope:{nwDataHref:"="},link:function($scope,$element){$scope.$watch("nwDataHref",function(val){var data;_.isString(val)&&(_.isFunction(window.navigator.msSaveBlob)?$element[0].onclick=function(){window.navigator.msSaveBlob(new Blob([val]),$element.attr("download"))}:(data="data:application/octet-stream;base64,"+base64.encode(val),$element.attr("href",data)))})}}}]);
;"use strict";!function(){angular.module(regdep("nw-menu"),[]).directive("nwMenu",function($document,$timeout){return{plain:!0,restrict:"A",transclude:!0,template:'<div class="nw-menu"><div svg-icon="toggle-menu" class="nw-menu__toggler" ng-click="toggleMenuState($event)"></div><div class="nw-menu__list" ng-transclude ng-class="{\'nw-menu__list--hidden\': !menuOpened}"></div></div>',link:function($scope){$scope.menuOpened=!1,angular.element($document).on("click",function(){$scope.setMenuState(!1)}),$scope.toggleMenuState=function($event){$event.stopPropagation(),$scope.setMenuState(!$scope.menuOpened)},$scope.setMenuState=function(opened){$timeout(function(){$scope.menuOpened=opened})}}}}).directive("nwMenuItem",function(){return{plain:!0,restrict:"A",scope:{itemLabel:"@nwItemLabel",itemHandler:"&nwItemSelect"},template:'<div class="nw-menu__item" ng-click="selectItem()">{{itemLabel | translate}}</div>',link:function($scope){$scope.selectItem=function(){$scope.itemHandler()}}}})}();
;"use strict";!function(){function SvgIconDirective(){var _template=oldBrowser?'<svg class="icon"><use ng-href="{{\'/general/img/svg/sprite.symbol.svg#\' + svgIcon}}" xlink:href="{{\'/general/img/svg/sprite.symbol.svg#\' + svgIcon}}"></use></svg>':'<svg class="icon"><use ng-href="{{\'/general/img/svg/sprite.symbol.svg#\' + svgIcon}}" xlink:href=""></use></svg>';return{restrict:"A",replace:!0,scope:{svgIcon:"@"},template:function(elem,attr){return attr.svgIcon&&/^[a-zA-Z]/.test(attr.svgIcon)?oldBrowser?'<svg class="icon"><use ng-href="/general/img/svg/sprite.symbol.svg#'+attr.svgIcon+'" xlink:href="{{\'/general/img/svg/sprite.symbol.svg#\' + svgIcon}}"></use></svg>':'<svg class="icon"><use ng-href="/general/img/svg/sprite.symbol.svg#'+attr.svgIcon+'" xlink:href=""></use></svg>':_template}}}var match,begin,end,major,oldBrowser=!1,matches=navigator.userAgent.match(/Chrome\/\d+\.[\d.\s]*Mobile/g);matches&&matches.length>0&&(match=matches[0],begin=match.indexOf("/")+1,end=match.indexOf("."),major=Number.parseInt(match.substring(begin,end)),oldBrowser=48>=major);var svgIconModule=angular.module(regdep("svgIcon"),[]);svgIconModule.directive("svgIcon",[SvgIconDirective])}();
;"use strict";!function(){var nw=angular.module(regdep("nw-password"),[]);nw.directive("nwPassword",["translate","nwPasswordService",function(translate,passwordService){return{restrict:"A",replace:!0,template:"<div><input type='password' name='autocomplete_off_trick' style='display: none;' ng-if='!password.autocomplete' /><div nw-field nw-label='{{password.label}}' nw-required='password.required'><input type='password' tab-index='{{password.tabindex}}' ng-model='password.value' ng-change=passwordChange(password.value) nw-custom-valid='passwordValidation(value, password, password.model)' nw-eye='nwPasswordHideEye'name='login_password'nw-set-focus='{{password.focus}}' nw-hide-value /></div><div class='note description' ng-if='password.description'>{{ password.description | translate }}</div></div>",scope:{nwPasswordValue:"=",nwPasswordValid:"&",nwPasswordChange:"&",nwPasswordHideEye:"="},link:function($scope,$element,$attrs){$scope.password={label:"",value:"",required:!1,autocomplete:_.has($attrs,"nwPasswordAutocomplete"),novalidation:_.has($attrs,"nwPasswordNovalidation"),focus:_.has($attrs,"nwPasswordFocus")?"true":"false",tabindex:_.has($attrs,"nwPasswordTabIndex")?$attrs.nwPasswordTabIndex:"0"},$attrs.$observe("nwPasswordDescription",function(value){$scope.password.description=value||""}),$attrs.$observe("nwPasswordRequired",function(value){$scope.password.required=value||""===value}),$attrs.$observe("nwPasswordLabel",function(value){$scope.password.label=value||"password"}),$scope.$watch("nwPasswordValue",function(value){_.isUndefined(value)||($scope.password.value=value)}),$scope.passwordChange=function(value){_.isFunction($scope.nwPasswordChange)&&$scope.nwPasswordChange({value:value}),$scope.nwPasswordValue=value},$scope.passwordValidation=function(value,password,model){var customValid=$attrs.nwPasswordValid&&_.isFunction($scope.nwPasswordValid);return $scope.password.novalidation?null:customValid?$scope.nwPasswordValid({value:value}):passwordService.validation(value,password,model)}}}}]),nw.directive("nwPasswordConfirm",["translate","nwPasswordService",function(translate,passwordService){return{restrict:"A",replace:!0,template:"<div><input type='password' name='autocomplete_off_trick' style='display: none;' /><div nw-field nw-label='{{password.label}}' nw-required><input type='password' ng-model='password.value' ng-change=passwordChange(password.value) nw-custom-valid='passwordValidation(value, password, password.model)' /></div><div class='note' ng-if='password.description'>{{ password.description | translate }}</div><input type='password' name='autocomplete_off_trick' style='display: none;' /><div nw-field nw-label='{{password.confirm.label}}' nw-required><input type='password' ng-model='password.confirm.value' nw-custom-valid='passwordValidation(value, password, password.confirm.model)' /></div></div>",scope:{nwPasswordConfirmValue:"=",nwPasswordConfirmCheck:"&",nwPasswordConfirmReset:"=",nwPasswordConfirmValid:"&"},link:function($scope,$element,$attrs){function getModel(input){return input?angular.element(input).data("$ngModelController"):null}$scope.password={label:"",value:"",model:getModel($element.find("input")[1]),confirm:{label:"",value:"",model:getModel($element.find("input")[3])}};var password=$scope.password;$attrs.$observe("nwPasswordDescription",function(value){password.description=value||""}),$attrs.$observe("nwPasswordConfirmLabel",function(value){password.label=value||"password"}),$attrs.$observe("nwPasswordConfirmLabel2",function(value){password.confirm.label=value||"confirm_password"}),$scope.$watch("nwPasswordConfirmValue",function(value){_.isUndefined(value)||(password.value=value)}),$scope.$watch(function(){return""!=password.confirm.value?password.value==password.confirm.value:!1},function(value){$scope.nwPasswordConfirmCheck({value:value})}),$scope.$watch("nwPasswordConfirmReset",function(value){value&&(password.value="",password.confirm.value="",password.model.$setPristine(),password.confirm.model.$setPristine(),$scope.nwPasswordConfirmReset=!1)}),$scope.passwordValidation=function(value,password,model){var customValid=$attrs.nwPasswordConfirmValid&&_.isFunction($scope.nwPasswordConfirmValid);return customValid?$scope.nwPasswordConfirmValid({value:value}):passwordService.validation(value,password,model)},$scope.passwordChange=function(value){$scope.nwPasswordConfirmValue=value}}}}]),nw.service("nwPasswordService",[function(){return{validation:function(value,password,model){var reCyrill=/[А-яЁё]+/g,reLegal=/^[\x20-\x7E]*$/g,passwordsNotEqual=password&&password.confirm&&""!==password.confirm.value&&password.value!==password.confirm.value&&model.$dirty;return value.length>31?"msg_invalid_password_length":reCyrill.test(value)?"msg_password_contains_cirill":reLegal.test(value)?passwordsNotEqual?"msg_passwords_not_equal":null:"msg_password_contains_illegal"}}}])}();
;"use strict";!function(){function NotificationDirective(){return{link:function($scope){$scope.hasActions=function(){return _.size($scope.notification.actions)}},restrict:"A",scope:{notification:"=nwNotification",showCloseBtn:"=nwShowCloseBtn"},plain:!0,replace:!0,template:'<div class="nw-notification card"><div class="nw-notification__icon" svg-icon="{{notification.icon}}"></div><div class="nw-notification__content"><div class="nw-notification__title" ng-bind="\'notification\' | translate"></div><div class="nw-notification__description" ng-class="{\'small\': hasActions(), \'big\': !hasActions()}"ng-bind="notification.getDescription() | translate"></div><div class="nw-notification__actions-block" ng-if="hasActions()"><button class="flat nw-notification__action"ng-repeat="action in notification.actions"ng-class="{\'colored\': action.primary}"ng-click="action.handler()"><span class="button__svg-icon" svg-icon="{{action.icon}}"></span>{{action.text | translate}}</button></div></div><div class="nw-notification__close-btn" ng-if="notification.close" ng-click="notification.close()"><div svg-icon="cross-medium"></div></div><div class="nw-notification__close-btn" ng-if="showCloseBtn" ng-click="showCloseBtn()"><div svg-icon="cross-medium"></div></div></div>'}}angular.module(regdep("nw-notification"),[]).directive("nwNotification",NotificationDirective),NotificationDirective.$inject=[]}();
;"use strict";!function(){function statusInfo(){return{link:function($scope,element,attrs){function statusClass(status){return statusClasses[status]}function updateState(){$scope.className=statusClass($scope.status),$scope.statusString=$scope[$scope.status]}var statusClasses={on:"on",off:"off",pending:"pending",disconnected:"disconnected"};attrs.$observe("status",updateState),attrs.$observe("on",updateState),attrs.$observe("off",updateState),attrs.$observe("pending",updateState),attrs.$observe("disconnected",updateState)},restrict:"E",template:'<span class="status-info">{{statusString}}</span>                        <div ng-if="status == loading" class="circular_spinner_mini svg_spinner">                            <svg class="mini_circular" viewBox="16 16 16 16">                                <circle class="mini_path" cx="8" cy="8" r="5" fill="none" stroke-width="4" stroke-miterlimit="10"/>                            </svg>                        </div>                        <span ng-if="status != loading" class="status-circle {{className}}"></span>',scope:{status:"@",on:"@",off:"@",pending:"@",disconnected:"@"}}}angular.module(regdep("nw-status-info"),[]).directive("statusInfo",statusInfo),statusInfo.$inject=[]}();
;"use strict";!function(){function nwDownload(authDigest,authDigestHelper,cookie){function postLink($scope,$element,$attrs){function setAuthCookie(link){var header=authDigestHelper.generateHeader({url:link,method:"GET"});cookie.set("Authorization",header,3,"sec")}var path=$attrs.nwDownloadPath,filepath=$attrs.nwDownloadFilePath,filename=$attrs.nwDownloadFileName;$element.bind("click",function(){var link=path;filepath&&(link+="?filepath="+filepath),filename&&(link+="&filename="+filename),setAuthCookie(path),document.location.href=link})}return{restrict:"A",replace:!0,compile:function($element,$attrs){var mode=$attrs.nwDownloadMode?"nw-download--"+$attrs.nwDownloadMode:"",template="<span class='nw-download "+mode+"'>";return template+="<svg class='nw-download__icon' svg-icon='download'></svg>",$attrs.nwDownloadLabel&&(template+='<span class="nw-download__text" ng-bind="\''+$attrs.nwDownloadLabel+"' | translate \"></span>"),template+="</span>",$element.append(template),postLink}}}angular.module(regdep("nw-download"),[]).directive("nwDownload",["authDigest","authDigestHelper","cookie",nwDownload]),nwDownload.$inject=[]}();
;"use strict";!function(){var nw=angular.module(regdep("nw-time"),[]);nw.directive("nwTime",["funcs","translate",function(funcs,translate){return{restrict:"AEC",link:function($scope){$scope.$watch("nwTime",function(sec){var obj,result;sec?(obj=funcs.format.time(sec,["day","hour","minute"]),result=[],obj.day&&result.push(obj.day+" "+translate("units_day")),obj.hour&&result.push(obj.hour+" "+translate("units_hour")),result.push(obj.minute+" "+translate("units_minute")),$scope.result=result.join(", ")):$scope.result="-"})},scope:{nwTime:"="},template:"{{result}}"}}])}();
;"use strict";!function(){var nw=angular.module(regdep("nw-siglevel"),[]);nw.directive("nwSiglevel",["$compile",function($compile){return{restrict:"A",template:"",scope:{nwSiglevel:"="},link:function(scope,element){scope.$watch("nwSiglevel",function(siglevel){var template,siglvl,isMatch,bars,percent,signal;if(siglevel&&parseInt(siglevel)>=0){if(siglvl=scope.nwSiglevel,angular.element(element[0]).empty(),isMatch=siglvl.match(/^(\d{1,2}|100)%$/),bars='<div class="first-bar bar"></div><div class="second-bar bar"></div><div class="third-bar bar"></div><div class="fourth-bar bar"></div><div class="fifth-bar bar"></div>',_.isNull(isMatch))template="<span>"+siglvl+"</span>";else switch(percent=isMatch[1],signal=Math.ceil(parseInt(percent)/20)){case 0:template='<div class="signal-bars mt1 sizing-box absent one-bar">'+bars+"</div> <span>"+percent+"%</span>";break;case 1:template='<div class="signal-bars mt1 sizing-box bad one-bar">'+bars+"</div> <span>"+percent+"%</span>";break;case 2:template='<div class="signal-bars mt1 sizing-box bad two-bars">'+bars+"</div> <span>"+percent+"%</span>";break;case 3:template='<div class="signal-bars mt1 sizing-box ok three-bars">'+bars+"</div> <span>"+percent+"%</span>";break;case 4:template='<div class="signal-bars mt1 sizing-box good four-bars">'+bars+"</div> <span>"+percent+"%</span>";break;case 5:template='<div class="signal-bars mt1 sizing-box best fifth-bars">'+bars+"</div> <span>"+percent+"%</span>"}$compile(template)(scope),element.append(template)}})}}}])}();
;"use strict";angular.module(regdep("nw-up-time"),[]).directive("upTime",["translate",function(translate){return{restrict:"AE",template:"<span>{{sumTime}}</span>",scope:{upTime:"=time"},link:function(scope){scope.$watch("upTime",function(time){var time=scope.upTime;if(time){var day=1==time.d?"summary_uptimeday":Math.floor(time.d/10)%10==1||time.d%10==0||time.d%10>4?"summary_uptimedays":time.d%10==2||time.d%10==3||time.d%10==4?"summary_uptimedays1":"summary_uptimeday1";scope.sumTime=0==time.d?time.h+":"+time.m+":"+time.s:time.d+" "+translate(day)+" "+time.h+":"+time.m+":"+time.s}})}}}]);
;"use strict";!function(){angular.module(regdep("nw-slider-serif"),[]).directive("nwSliderSerif",["translate",function(){return{template:'<span><div class="nw-progress-bar" style="overflow:inherit!important"><div class="nw-progress-text" style="margin-bottom: 3px">{{slText | translate}}</div><div class="nw-progress-band" style="{{sliderColor}}"></div></div><span ng-if="slShowDesc" class="note state_desc">{{slDesc | translate}}</span></span>',replace:!0,plain:!0,restrict:"AE",scope:{slValue:"=",slText:"=",slMaxCount:"=",slDesc:"=",slShowDesc:"="},link:function($scope){var maxColorChannelValue=215;$scope.$watch("slValue",function(value){if(!value||value>$scope.slMaxCount)return"'inherit'";var i,seperateColor="#FFF",blockCount=value,seperateCount=value-1,sliderMaxCount=$scope.slMaxCount,gradientStep=11>=sliderMaxCount?2:0,gradientValue=9>=sliderMaxCount?100:120,percent=(100-2*seperateCount)/blockCount,sumPercent=percent,bgColor="linear-gradient(to right, ",rgb="rgb("+maxColorChannelValue+","+(maxColorChannelValue-parseInt(maxColorChannelValue*(gradientValue-50)/50))+",0)";for(bgColor+=1==blockCount?rgb+"0%, "+rgb+"100%)":rgb+" "+percent+"%, ",i=1;blockCount>i;i++)i<=parseInt(blockCount/2)?rgb="rgb("+maxColorChannelValue+","+(maxColorChannelValue-parseInt(maxColorChannelValue*(gradientValue-10*(i+gradientStep)-50)/50))+",0)":i+1!=blockCount?rgb="rgb("+parseInt(maxColorChannelValue*(gradientValue-10*(i+gradientStep))/50)+","+maxColorChannelValue+",0)":i+1==sliderMaxCount&&(rgb="rgb("+parseInt(-1*maxColorChannelValue/50)+","+maxColorChannelValue+",0)"),bgColor+=seperateColor+" "+sumPercent+"%, "+seperateColor+" "+(sumPercent+=2)+"%, "+rgb+" "+sumPercent+"%, "+rgb+" "+(sumPercent+=percent)+"%",bgColor+=i+1!=blockCount?", ":"";$scope.sliderColor="width: "+(value*((100-2*(sliderMaxCount-1))/sliderMaxCount)+2*seperateCount)+"%; background: "+bgColor})}}}])}();
;"use strict";!function(){var nw=angular.module(regdep("nw-syspass"),[]);nw.directive("nwSyspass",function(){return{restrict:"A",require:"ngModel",link:function($scope,$element,$attrs,$model){function validator(value){var reCyrill=/[А-яЁё]+/g,reLegal=/^[А-яЁё\x20-\x7E]*$/g;return _.isUndefined(value)||!value.toString().length||$attrs.disabled?($model.$setValidity("msg_invalid_password_length",!0),$model.$setValidity("msg_password_contains_cirill",!0),$model.$setValidity("msg_password_contains_illegal",!0)):($model.$setValidity("msg_invalid_password_length",value.length<32),$model.$setValidity("msg_password_contains_cirill",!reCyrill.test(value)),$model.$setValidity("msg_password_contains_illegal",reLegal.test(value))),value}$model.$parsers.unshift(validator),$model.$formatters.unshift(validator)}}})}();
;"use strict";!function(){function main(){return{link:function($scope){$scope.doAction=function(){$scope.actionHandler()}},restrict:"E",template:'<div class="nw-tile">                            <div class="nw-tile-caption" ng-click="doAction()">                                <div class="icon"><svg svg-icon="{{ icon }}"></svg></div>                                <div class="nw-tile-name">                                    <h5>{{ name | translate }}</h5>                                </div>                            </div>                            <div class="nw-tile-desc">{{ desc | translate }}</div>                            <div class="nw-tile-action" style="display: none;">                                <button class="flat colored" ng-click="doAction()">{{ actionName | translate }}</button>                            </div>                        </div>',scope:{icon:"@",name:"@",desc:"@",actionName:"@",actionHandler:"&"}}}angular.module(regdep("nw-tile"),[]).directive("nwTile",main),main.$inject=[]}();
;"use strict";!function(){var authDigest=angular.module(regdep("auth-digest"),["angular-md5","LocalStorageModule"]);authDigest.provider("authDigest",["$httpProvider",function($httpProvider){function setCredentials(helper,credentialsStorage){return function(credentials,authHeader){var newCredentials={username:credentials.username,realm:authHeader.realm,qop:authHeader.qop,nonce:authHeader.nonce,ha1:helper.generateHA1(credentials.username,credentials.password,authHeader.realm)};credentialsStorage.set(authHeader.realm,newCredentials)}}function cleanAuthorizationCredentials(realmStorage,credentialsStorage){return function(currentOnly){var realm;currentOnly?(realm=realmStorage.getCurrent(),credentialsStorage.remove(realm)):credentialsStorage.removeAll()}}function getDeviceSessionId(localStorage){return function(){return localStorage.get(providerObj.deviceSessionHeaderName)}}var providerObj={authHeaderName:null,autologinHeaderName:null,repeatRequestHeaderName:null,authDefaultUsername:null,authDefaultPassword:null,getCredentialsCallback:null,$get:function($injector){var helper=$injector.get("authDigestHelper"),realmStorage=$injector.get("authDigestRealmStorage"),credentialsStorage=$injector.get("authDigestCredentialsStorage"),localStorage=$injector.get("localStorageService");return{setCredentials:setCredentials(helper,credentialsStorage),cleanCredentials:cleanAuthorizationCredentials(realmStorage,credentialsStorage),getDeviceSessionId:getDeviceSessionId(localStorage)}}};return $httpProvider.interceptors.push(["$rootScope","$q","$injector",function($rootScope,$q,$injector){function getAndSaveCredentialsFromUser(headers,authHeader){$injector.invoke(providerObj.getCredentialsCallback,null,{authParams:headerService.getAnwebParams(headers)}).then(function(credentials){$rootScope.dlinkMobileApp&&$rootScope.dlinkMobileApp.updatePassword(credentials),reAuthorization(credentials,authHeader)})}function reAuthorization(credentials,authHeader){setCredentials(helper,credentialsStorage)(credentials,authHeader),response401=!1,requestService.retryAll()}function reAuthorizationForMobileApp(credentials,authHeader){setCredentials(helper,credentialsStorage)(credentials,authHeader),response401=!1,authHeader.reauthorization="true",requestService.retryAll()}var helper=$injector.get("authDigestHelper"),headerService=$injector.get("authDigestHeader"),requestService=$injector.get("authDigestRequest"),realmStorage=$injector.get("authDigestRealmStorage"),credentialsStorage=$injector.get("authDigestCredentialsStorage"),response401=($injector.get("localStorageService"),!1),responseError=function(res){var deferredAuthError,config,headers,authHeader,autologinAvailable,credentials;if(401==res.status){if(deferredAuthError=$q.defer(),config=res.config,headers=res.headers(),config.headers[providerObj.repeatRequestHeaderName]=!0,requestService.append(config,deferredAuthError),$rootScope.$emit("request.not_authorized",res),!response401){if(response401=!0,authHeader=headerService.parse(headers[providerObj.authHeaderName]),autologinAvailable=headers[providerObj.autologinHeaderName],realmStorage.isPrevent(authHeader.realm)&&credentialsStorage.get(authHeader.realm))return realmStorage.set(authHeader.realm),response401=!1,requestService.retryAll(),deferredAuthError.promise;realmStorage.isCurrent(authHeader.realm)||realmStorage.set(authHeader.realm),cleanAuthorizationCredentials(realmStorage,credentialsStorage)(!0),autologinAvailable?(credentials={username:providerObj.authDefaultUsername,password:providerObj.authDefaultPassword},reAuthorization(credentials,authHeader)):!config.reauthorization&&$rootScope.dlinkMobileApp.isUserInMobileApp()?$rootScope.dlinkMobileApp.getCredentials().then(function(credentials){config.reauthorization=!0,reAuthorizationForMobileApp(credentials,authHeader)})["catch"](function(){getAndSaveCredentialsFromUser(headers,authHeader)}):getAndSaveCredentialsFromUser(headers,authHeader)}return deferredAuthError.promise}return $q.reject(res)};return{request:function(config){var authHeader,realm=realmStorage.getCurrent(),credentials=credentialsStorage.get(realm);return realm&&credentials&&credentials.username&&credentials.ha1&&credentials.nonce&&credentials.qop&&(credentials.nc=helper.getNc(),credentials.cnonce=helper.generateNonce(16),credentials.response=helper.generateResponse(config,credentials),authHeader=headerService.generate(config,credentials),authHeader&&(config.headers.Authorization=authHeader)),config},response:function(res){return res},responseError:responseError}}]),providerObj}]),authDigest.factory("authDigestRequest",["$injector",function($injector){function retryHttpRequest(config,deferred){var $http=$injector.get("$http");return $http(config).then(function(response){deferred.resolve(response)},function(response){deferred.reject(response)})}var requests=[];return{append:function(config,deferred){10==requests.length&&requests.splice(0,1),requests.push({config:config,deferred:deferred})},retryAll:function(){angular.forEach(requests,function(req){retryHttpRequest(req.config,req.deferred)}),requests.length=0}}}]),authDigest.factory("authDigestHeader",[function(){return{generate:function(config,params){var header="Digest ";return params.algorithm&&(header+='algorithm="'+params.algorithm+'", '),params.opaque&&(header+='opaque="'+(params.opaque||"")+'", '),header+='username="'+encodeURIComponent(params.username)+'", realm="'+params.realm+'", nonce="'+params.nonce+'", uri="'+config.url+'", response="'+params.response+'", qop='+params.qop+", nc="+params.nc+', cnonce="'+params.cnonce+'"'},parse:function(header){if(!header)return null;var i,re,pair,name,value,str=header.replace(/\s*Digest\s+/,""),arr=str.split(","),params={};for(i=0;i<arr.length;i++)if(re=/\s*(\w+)\s*=\s*"*(\w+)"*\s*/,pair=arr[i].match(re),pair&&3==pair.length)switch(name=pair[1],value=pair[2],name){case"username":case"realm":case"nonce":case"response":case"uri":case"qop":case"nc":case"cnonce":params[name]=value}return params},getAnwebParams:function(headers){var params={};return params.clientTryCount=angular.isDefined(headers["anweb-auth-try-count"])?headers["anweb-auth-try-count"]:0,angular.isDefined(headers["anweb-auth-try-count-remain"])&&(params.tryCountRemain=headers["anweb-auth-try-count-remain"]),angular.isDefined(headers["anweb-auth-ban-time-remain"])&&(params.banTimeRemain=headers["anweb-auth-ban-time-remain"]),angular.isDefined(headers["anweb-auth-ban-reason"])&&(params.banReason=headers["anweb-auth-ban-reason"]),angular.isDefined(headers["anweb-not-authorized"])&&(params.notAuthorized=headers["anweb-not-authorized"]),params}}}]),authDigest.factory("authDigestRealmStorage",["authDigestStorage",function(storage){var maps={current:"auth-digest-current-realm",prevent:"auth-digest-prevent-realm",preventList:"auth-digest-prevent-list-realm"};return{getCurrent:function(){var current=storage.getParam(maps.current);return current?current:null},getPrevent:function(){var prevent=storage.getParam(maps.prevent);return prevent?prevent:null},isCurrent:function(name){var current=storage.getParam(maps.current);return current==name},isPrevent:function(name){storage.getParam(maps.prevent);var preventList=storage.getParam(maps.preventList)||[];return _.contains(preventList,name)},set:function(realm){var current=storage.getParam(maps.current),prevent=storage.getParam(maps.prevent),preventList=storage.getParam(maps.preventList)||[];current&&(prevent=angular.copy(current)),current=realm,preventList=_.without(preventList,realm),preventList.unshift(prevent),storage.setParam(maps.current,current),storage.setParam(maps.prevent,prevent),storage.setParam(maps.preventList,preventList)},remove:function(){storage.removeParam(maps.current),storage.removeParam(maps.prevent)}}}]),authDigest.factory("authDigestCredentialsStorage",["authDigestStorage",function(storage){var name="auth-digest-credentials",init=function(){storage.setParam(name,{})},isInit=function(){return!!storage.getParam(name)};return{get:function(realm){isInit()||init();var credentials=storage.getParam(name);return credentials[realm]?credentials[realm]:null},set:function(realm,params){isInit()||init();var credentials=storage.getParam(name);credentials[realm]||(credentials[realm]={}),credentials[realm]=angular.extend(credentials[realm],params),storage.setParam(name,credentials)},remove:function(realm){if(isInit()){var credentials=storage.getParam(name);delete credentials[realm],storage.setParam(name,credentials)}},removeAll:function(){storage.removeParam(name)}}}]),authDigest.factory("authDigestStorage",["localStorageService",function(localStorageService){function getParam(param){return localStorageService.get(param)}function setParam(param,value){localStorageService.set(param,value)}function removeParam(param){localStorageService.remove(param)}var name="auth-digest",init=function(){setParam(name,JSON.stringify({}))},isInit=function(){return!!getParam(name)},getStorage=function(){isInit()||init();var result=getParam(name);return JSON.parse(result)},setStorage=function(storage){isInit()||init(),setParam(name,JSON.stringify(storage))};return{get:getStorage,set:setStorage,remove:function(){removeParam(name)},getParam:function(param){var storage=getStorage();return storage[param]?storage[param]:null},setParam:function(param,data){var storage=getStorage();storage[param]=data,setStorage(storage)},removeParam:function(param){var storage=getStorage();delete storage[param],setStorage(storage)}}}]),authDigest.factory("authDigestHelper",["md5","$injector",function(md5,$injector){var _nc=0,_chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",getNc=function(){_nc++;var i,zeros=8-_nc.toString().length,nc="";for(i=0;zeros>i;i++)nc+="0";return nc+_nc},generateNonce=function(length){var i,nonce=[],charsLength=_chars.length;for(i=0;length>i;++i)nonce.push(_chars[Math.random()*charsLength|0]);return nonce.join("")},generateResponse=function(config,credentials){var ha1=credentials.ha1,ha2=md5.createHash(config.method+":"+config.url);return md5.createHash(ha1+":"+credentials.nonce+":"+credentials.nc+":"+credentials.cnonce+":"+credentials.qop+":"+ha2)};return{getNc:getNc,generateNonce:generateNonce,generateHA1:function(username,password,realm){return md5.createHash(username+":"+realm+":"+password)},generateResponse:generateResponse,generateHeader:function(config){var realmStorage=$injector.get("authDigestRealmStorage"),credentialsStorage=$injector.get("authDigestCredentialsStorage"),headerService=$injector.get("authDigestHeader"),realm=realmStorage.getCurrent(),credentials=credentialsStorage.get(realm);return realm&&credentials&&credentials.username&&credentials.ha1&&credentials.nonce&&credentials.qop?(credentials.nc=getNc(),credentials.cnonce=generateNonce(16),credentials.response=generateResponse(config,credentials),headerService.generate(config,credentials)):void 0}}}])}();
;"use strict";!function(){var authHqPlaginModule=angular.module(regdep("authHqPlagin"),["devinfo"]);authHqPlaginModule.service("authHqPlaginService",["$http","$timeout","devinfo",function($http,$timeout){function start(){function success(){refresh()}function error(){refresh()}function refresh(){$timeout(function(){activeTimer=!1,start()},settings.interval)}activeTimer||(activeTimer=!0,request().success(success).error(error))}function request(){var url=settings.baseUrl+settings.url+"?need_auth=1&_="+_.random(1e4,99999),opts={timeout:settings.timeout};return $http.get(url,opts)}var activeTimer=!1,settings={baseUrl:"",url:"/devinfo",interval:1e4,timeout:2e3};return start(),{}}]),authHqPlaginModule.run(["$injector",function($injector){$injector.get("authHqPlaginService")}])}();
;"use strict";!function(){var authQueue=angular.module(regdep("auth-queue"),[]);authQueue.factory("httpQueueInterceptors",["$q","$timeout",function($q,$timeout){function isQueuedURL(url){var list=[/\/devinfo(.*)need_auth=1/,/\/jsonrpc/];return _.some(list,function(o){return o.test(url)})}function isRepeatRequest(config){return config.headers["anweb-repeat-request"]}var queue=[],inProcess=!1,request=function(config){var deferred;return isQueuedURL(config.url)?(deferred=$q.defer(),!inProcess||isRepeatRequest(config)?(deferred.resolve(config),inProcess=!0):queue.push({config:config,deferred:deferred}),deferred.promise):config};return{request:request,response:function(res){var item;return isQueuedURL(res.config.url)&&(inProcess=!1,item=queue.shift(),item&&(inProcess=!0,$timeout(function(){item.deferred.resolve(item.config)}))),res},responseError:function(res){return isQueuedURL(res.config.url)&&(isRepeatRequest(res.config)||queue.shift(),401!=res.status&&(inProcess=!1)),$q.reject(res)}}}]),authQueue.config(["$httpProvider",function($httpProvider){$httpProvider.interceptors.unshift("httpQueueInterceptors")}])}();
;"use strict";!function(){var overlayModule=angular.module(regdep("overlay"),[]);overlayModule.service("overlay-core",["overlay-simple","overlay-progress","overlay-not-available",function(simple,progress,notAvailable){return{simple:simple,progress:progress,notAvailable:notAvailable}}]),overlayModule.service("overlay-helper",["$document",function($document){function blockFunction($event){return $event.preventDefault(),$event.stopPropagation(),$event.stopImmediatePropagation(),!1}function isActivate(){return stackAction.length>0}function hasAction(action){return _.contains(stackAction,action)}function blockMainPage(action){isActivate()||($mainPage.bind(keyEvents,blockFunction),$document.bind(scrollEvents,blockFunction),$rootHtmlElement.addClass("disable_scroll")),hasAction(action)||($dialogPage=angular.element($body[0].querySelector(".ngdialog")),$dialogPage&&($dialogPage.bind(keyEvents,blockFunction),dialogsBlock[action]=dialogsBlock[action]||[],dialogsBlock[action]=dialogsBlock[action].concat($dialogPage)),stackAction.push(action))}function unblockMainPage(action){stackAction=_.without(stackAction,action),isActivate()||($mainPage.unbind(keyEvents,blockFunction),$document.unbind(scrollEvents,blockFunction),$rootHtmlElement.removeClass("disable_scroll")),dialogsBlock[action]&&(_.each(dialogsBlock[action],function(dialog){dialog.unbind(keyEvents,blockFunction)}),delete dialogsBlock[action])}var $rootHtmlElement=angular.element($document[0].documentElement),$body=angular.element($document[0].body),$mainPage=angular.element($body.children()[0]),$dialogPage=null,keyEvents="keydown keyup keypress",scrollEvents="touchmove",stackAction=[],dialogsBlock={};return{blockMainPage:blockMainPage,unblockMainPage:unblockMainPage}}]),overlayModule.service("overlay-simple",["$rootScope","$compile","$document","overlay-helper",function($rootScope,$compile,$document,helper){function start(params){stackEvents.push(params.event),helper.blockMainPage("overlay-simple")}function stop(params){params.force?stackEvents.length=0:stackEvents=_.without(stackEvents,params.event),0==stackEvents.length&&helper.unblockMainPage("overlay-simple")}var elemScope=$rootScope.$new();elemScope.dots=_.range(8);var stackEvents=[];elemScope.overlayIsHidden=function(){return!stackEvents.length},elemScope.getOverlayClass=function(){return elemScope.overlayIsHidden()?"overlay-simple--hide":"overlay-simple--show"};var $body=angular.element($document[0].body),$elem=$compile('<div class="overlay-simple" ng-class="getOverlayClass()"><nw-progress-circular ng-if="!overlayIsHidden()"></nw-progress-circular></div>')(elemScope);return $body.append($elem),{start:start,stop:stop}}]),overlayModule.service("overlay-progress",["$rootScope","$compile","$document","$timeout","translate","overlay-helper",function($rootScope,$compile,$document,$timeout,translate,helper){function stop(){elemScope.isShow=!1,elemScope.step=null,helper.unblockMainPage("overlay-progress")}var $body=angular.element($document[0].body),elemScope=$rootScope.$new();elemScope.isShow=!1,elemScope.step=null,elemScope.getOverlayClass=function(){return elemScope.isShow?"overlay-progress--show":"overlay-progress--hide"};var $elem=$compile('<div class="overlay-progress" ng-class="getOverlayClass()"><div class="overlay-progress__content"><div class="overlay-progress__logo"></div><div class="overlay-title" ng-if="title.length > 1" ng-bind="title | translate"></div> <nw-auto-progress-bar ng-if="isShow" pb-duration="step.duration" pb-callback="step.callback(status)" pb-pause="step.pause"></nw-auto-progress-bar></div></div>')(elemScope);return $body.append($elem),{start:function(params){params.duration&&(elemScope.isShow=!0,elemScope.step={duration:params.duration,callback:function(status){"finished"==status&&stop(),params.callback&&params.callback(status)},pause:params.pause||!1},elemScope.title=params.title?translate(params.title):"",helper.blockMainPage("overlay-progress"))},stop:stop}}]),overlayModule.service("overlay-not-available",["$rootScope","$compile","$document","translate","overlay-helper",function($rootScope,$compile,$document,translate,helper){function setStates(mode,count){elemScope.box=function(mode,count){switch(mode){case"basic":switch(count){case 0:return"none";case 1:return"first";case 2:return"second";default:return"main"}case"static":return"static";case"icon":return"show";default:return"none"}}(mode,count),elemScope.textBox=function(mode,count){switch(mode){case"basic":return count>2?"show":"hide";case"static":return"show";default:return"hide"}}(mode,count),elemScope.iconBox="show",elemScope.iconState=function(mode,count){return"basic"==mode?_.isNumber(count)&&3>count?"warning":"error":"warning"}(mode,count)}function clearStates(){elemScope.box="none",elemScope.textBox="hide",elemScope.iconBox="hide",elemScope.iconState||(elemScope.iconState="warning")}var elemScope=$rootScope.$new();clearStates(),elemScope.getOverlayClass=function(){return"overlay-not-available--"+elemScope.box},elemScope.getOverlayTextBoxClass=function(){return"overlay-not-available-text--"+elemScope.textBox},elemScope.getOverlayIconBoxClass=function(){return"overlay-not-available-icon--"+elemScope.iconBox},elemScope.showIcon=function(name){return elemScope.iconState===name},elemScope.getTextBoxAttention=function(){return translate("static"==elemScope.box?"msg_device_is_not_available_attention_static":"msg_device_is_not_available_attention")};var $body=angular.element($document[0].body),$elem=$compile('<div class="overlay-not-available" ng-class="getOverlayClass()"><div class="overlay-not-available-text" ng-class="getOverlayTextBoxClass()"><div class="overlay-not-available-text__title-container"><svg svg-icon="warning_circle" class="overlay-not-available-text__title-icon"></svg><div class="overlay-not-available-text__title-text" ng-bind="\'msg_device_is_not_available_title\' | translate"></div></div><div class="overlay-not-available-text__subtitle" ng-bind="\'msg_device_is_not_available_subtitle\' | translate"> </div><ul class="overlay-not-available-text__reason" ><li ng-bind="\'msg_device_is_not_available_reason_lan\' | translate"></li><li ng-bind="\'msg_device_is_not_available_reason_wifi\' | translate"></li></ul><div class="overlay-not-available-text__attention" ng-bind="getTextBoxAttention()"> </div></div></div><div class="overlay-not-available-icon" ng-class="getOverlayIconBoxClass()"><svg svg-icon="device-error" ng-show="showIcon(\'error\')" class="overlay-not-available-icon__device"></svg><svg svg-icon="device-warn"  ng-show="showIcon(\'warning\')" class="overlay-not-available-icon__device"></svg><div class="tooltip top">{{\'msg_device_is_not_available_title\' | translate}}</div>')(elemScope);return $body.append($elem),{start:function(mode,count){setStates(mode,count),helper.blockMainPage("overlay-not-available")},stop:function(){clearStates(),helper.unblockMainPage("overlay-not-available")}}}])}();
;"use strict";!function(){var maxInstance=1;angular.module(regdep("nw-overlay"),[]).directive("nwOverlay",["$document",function($document){var document=$document[0];return{restrict:"A",link:function($scope,element,attrs){var instanceId=maxInstance++,id="nw-overlay-"+instanceId;element.on("transitionend webkitTransitionEnd oTransitionEnd",function(){var $overlay=angular.element(document.querySelector("#"+id));$overlay.hasClass("transparent")?($overlay.removeClass("transparent"),$overlay.addClass("opaque")):($overlay.removeClass("opaque"),$overlay.addClass("transparent"))}),$scope.$watch(attrs.nwOverlay,function(value){var $overlay;value?(element.addClass("nw-overlay-target"),element.append("<div id="+id+' class="nw-overlay opaque"></div>'),$overlay=angular.element(document.querySelector("#"+id)),setTimeout(function(){$overlay.removeClass("opaque"),$overlay.addClass("transparent")},1e3)):angular.element(document.querySelector("#"+id)).remove()})}}}])}();
;"use strict";angular.module(regdep("snackbars"),[]).factory("snackbars",["$rootScope","$compile","$document","$timeout",function($rootScope,$compile,$document,$timeout){function kick(){isWorking||next()}function next(){return isWorking=!0,isStopped?void 0:(hide(),$timeout.cancel(hidePromise),messages.length?void $timeout(switchMessage(messages.shift())):void(isWorking=!1))}function switchMessage(nextMsg){function changeMessageAndShow(){$scope.msg=nextMsg,show()}return function(){var netxMsgTime=parseInt(nextMsg.time,10),fullShowTime=(netxMsgTime||3e3)+switchTime;return $timeout(changeMessageAndShow,switchTime/2),messages.length?void(hidePromise=$timeout(next,netxMsgTime?fullShowTime:1e3+switchTime)):(hidePromise=$timeout(hide,fullShowTime),void(isWorking=!1))}}function show(){$scope.hidden=!1}function hide(){$scope.hidden=!0}function stop(){isStopped=!0,$timeout.cancel(hidePromise)}var switchTime=600,messages=[],$scope=$rootScope.$new(),hidePromise=null,isWorking=!1,isStopped=!1;return function(){var $body=angular.element($document[0].body),$elem=$compile('<div class="snackbar_wrapper"><div class="snackbar" ng-mouseover="stop()" ng-mouseleave="start()" ng-class="{hide: hidden, show: !hidden}"><div class="msg" ng-bind="msg.text | translate"></div><button class="action flat"ng-bind="msg.action.button | translate"ng-click="msg.action.fn()"ng-if="msg.action"></button></div></div>')($scope);$body.append($elem)}(),hide(),$scope.stop=stop,$scope.start=function(){isStopped=!1,$timeout(next,1e3)},{add:function(text,time,action){messages.push({text:text,time:time,action:action}),kick()},createAction:function(fn,button){return function(fn,button){return _.isFunction(fn)&&_.isString(button)}(fn,button)?{fn:fn,button:button}:null}}}]);
;"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};angular.module(regdep("translate"),[]).run(["translate",function(translate){window.baselang||translate.fetchBaseLanguage()}]).factory("translate",["$rootScope","$http","$sce",function($rootScope,$http,$sce){function translate(key,param){function getTempInstance(key,lang){function parseParams(paramsStr,lang,abr){var result={},pairs=paramsStr.split("&"),countParams=pairs.length;return _.each(pairs,function(pair){var value,baseValue,param=pair.split("="),nameParam=param[0],keyParam=param[1];nameParam&&keyParam&&("abr"!==nameParam?(value=lang[keyParam],value?result[nameParam]=value:nameParam in abr&&(baseValue=window.baselang[keyParam],baseValue&&(result[nameParam]=baseValue))):countParams--)}),_.keys(result).length===countParams?result:null}var result,origin,abr,params,instance=key.split("?"),originPart=instance[0],paramsPart=instance[1];return originPart&&paramsPart&&(origin=lang[originPart],origin&&(abr=getAbr(paramsPart),params=parseParams(paramsPart,lang,abr),params&&(result=applyTemplate(origin,params,abr)))),result?result:null}function isTempInstance(key){return/^\w+\?\w+=\w+/.test(key)}function applyTemplate(origin,params,abr){function setParam(nameParamStr){var result,first,nameParam=nameParamStr.slice(1),isUpperCaseFirst=function(symbol){var patt=/[A-Z]/;return patt.test(symbol)}(nameParam[0]);isUpperCaseFirst&&(nameParam=nameParam.toLowerCase());var transl=params[nameParam];return transl&&(abr&&abr[nameParam]?result=transl:(first=isUpperCaseFirst?transl[0].toUpperCase():transl[0].toLowerCase(),result=first+transl.slice(1))),result?result:nameParamStr}return 1==params.trustAsHtml?$sce.trustAsHtml(origin.replace(/:\w+/g,setParam)):origin.replace(/:\w+/g,setParam)}function getAbr(params){var pairs,index,abrStr,namesParam,abr,result={};return"string"==typeof params?(pairs=params.split("&"),index=_.findIndex(pairs,function(pair){return/^abr=\w+(,\w+)*/.test(pair)}),-1!==index&&(abrStr=pairs[index],namesParam=abrStr.split("=")[1].split(","),_.each(namesParam,function(name){result[name]=!0}))):(abr=params.abr,abr&&("object"===("undefined"==typeof abr?"undefined":_typeof(abr))?_.each(abr,function(name){result[name]=!0}):result[abr]=!0)),result}var result,lang,isString,isTempInst,tempInstance,baselang,baseTempInstance,abr,params;return key&&window.lang&&window.baselang&&(lang=window.lang[key],isString=_.isString(lang),isTempInst=isTempInstance(key),lang&&(isString||lang===!0&&isTempInst)?isString?result=lang:(tempInstance=getTempInstance(key,window.lang),tempInstance?result=tempInstance:(baseTempInstance=getTempInstance(key,window.baselang),result=baseTempInstance?baseTempInstance:key)):(baselang=window.baselang[key],baselang?_.isString(baselang)?result=baselang:baselang===!0&&isTempInst?(baseTempInstance=getTempInstance(key,window.baselang),result=baseTempInstance?baseTempInstance:key):result=key:result=key),param&&(abr=getAbr(param),params=_.omit(param,"abr"),result=applyTemplate(result,params,abr))),result}var activeLang="eng";return $rootScope.lang=activeLang,console.log(),translate.checkKey=function(key){return key&&key.length?window.lang&&window.lang[key]&&""!=window.lang[key]?!0:window.baselang&&window.baselang[key]&&""!=window.baselang[key]?!0:!1:void 0},translate.changeLanguage=function(lang){$http({method:"GET",url:"/general/lang/"+lang+".js"}).success(function(data){try{eval.apply(window,[data]),$rootScope.lang=lang,activeLang=lang,$rootScope.$broadcast("changelang",lang)}catch(e){}})},translate.fetchBaseLanguage=function(){var lang=autoconf&&autoconf.__lang_arr&&autoconf.__lang_arr.length?autoconf.__lang_arr[0]:"eng";return translate.fetchLanguage(lang)},translate.fetchLanguage=function(lang){return $http({method:"GET",url:"/general/lang/"+lang+".js"}).success(function(data){try{eval.apply(window,[data])}catch(e){}})},translate.getLang=function(){return activeLang},translate.getLangNames=function(){return $http.get("/general/lang/names.json").success(function(data){return translate.langNames=data})},translate}]).filter("translate",["translate",function(translate){return function(input,hideIfEmpty){var result;if(_.isObject(input))var result=translate(input.lang,_.omit(input,"lang"));else result=translate(input);return hideIfEmpty&&input==result?"":result}}]).directive("translate",["$rootScope","translate",function($rootScope,translate){return{restrict:"AEC",scope:{translate:"@",translateParams:"="},link:function(scope,elm){function change(){elm.html(translate(scope.$langkey,scope.translateParams))}scope.$langkey||(scope.$langkey=elm.html(),scope.$langkey||(scope.$langkey=scope.translate)),$rootScope.$on("changelang",function(){change()}),change()}}}]).service("detectLang",function(){function detect(){var langAttachmentsChinese={zh:"chs","zh-cn":"chs","zh-mo":"cht","zh-hk":"cht","zh-tw":"cht","zh-sg":"chs"},langAttachments={tr:"tur",tt:"tat",uk:"ukr",fa:"fas",fr:"fra",ru:"rus",en:"eng",hy:"arm",de:"ger",he:"heb",it:"ita",kk:"kaz",ko:"kor",lt:"lit",pt:"por",es:"spa"},browserLang=navigator.language?navigator.language:navigator.userLanguage;return browserLang=browserLang.toLowerCase(),browserLang in langAttachmentsChinese?langAttachmentsChinese[browserLang]:(browserLang=browserLang.substr(0,2),browserLang in langAttachments?langAttachments[browserLang]:"eng")}return detect});
;"use strict";angular.module(regdep("captrans"),[]).factory("captrans",["translate",function(translate){return function(key,param){var result=translate(key,param);return result[0].toUpperCase()+result.slice(1)}}]).filter("captrans",["captrans",function(captrans){return function(input,hideIfEmpty){var result;if(_.isObject(input))var result=captrans(input.lang,_.omit(input,"lang"));else result=captrans(input);return hideIfEmpty&&input==result?"":result}}]).directive("captrans",["$rootScope","captrans",function($rootScope,captrans){return{restrict:"AEC",scope:{captrans:"@",captransParams:"="},link:function(scope,elm){function change(){elm.html(captrans(scope.$langkey,scope.captransParams))}scope.$langkey||(scope.$langkey=elm.html(),scope.$langkey||(scope.$langkey=scope.captrans)),$rootScope.$on("changelang",function(){change()}),change()}}}]);
;"use strict";!function(){var cookies=angular.module(regdep("cookies"),[]);cookies.service("cookie",function(){this.is=function(){return navigator.cookieEnabled||"cookie"in $document?!0:!1},this.get=function(key){if(!this.is())return"";var i,thisCookie,cookies=document.cookie&&document.cookie.split(";")||[];for(i=0;i<cookies.length;i++){for(thisCookie=cookies[i];" "===thisCookie.charAt(0);)thisCookie=thisCookie.substring(1,thisCookie.length);if(0===thisCookie.indexOf(key+"="))return decodeURIComponent(thisCookie.substring(key.length+1,thisCookie.length))}return""},this.set=function(key,value,expires,measure){var today=new Date;if(expires)switch(measure){case"sec":expires=1e3*expires;break;case"min":expires=1e3*expires*60;break;case"hour":expires=1e3*expires*3600;break;default:expires=1e3*expires*3600*24}document.cookie=key+"="+encodeURIComponent(value)+(expires?"; path = /; expires="+new Date(today.getTime()+expires).toGMTString():"")},this.remove=function(key){this.set(key,"",-30)},this.deleteAll=function(){var i,key,thisCookie=null,cookies=document.cookie.split(";");for(i=0;i<cookies.length;i++){for(thisCookie=cookies[i];" "===thisCookie.charAt(0);)thisCookie=thisCookie.substring(1,thisCookie.length);key=thisCookie.substring(0,thisCookie.indexOf("=")),this.remove(key)}}})}();
;"use strict";!function(){function Devinfo(inject){this.__$http=inject.$http,this.__$timeout=inject.$timeout,this.__$q=inject.$q,this.__setting={min_interval:4,interval:4,timeout:1e4,url:"/devinfo"},this.__handlers=[],this.__activeTimer=!1,this.__isSuspended=!1}function __start(){function success(data){var min=_.min(data.infoAreasStatus,function(a){return a.expTimeSec});this.__setting.interval=min.expTimeSec&&min.expTimeSec>this.__setting.min_interval?min.expTimeSec:this.__setting.min_interval,refresh.call(this)}function refresh(){var _this2=this;this.__$timeout(function(){_this2.__activeTimer=!1,__start.call(_this2)},1e3*this.__setting.interval)}this.__handlers.length&&!this.__isSuspended&&(this.__activeTimer||(this.__activeTimer=!0,__pull.call(this).then(success.bind(this),refresh.bind(this))))}function __pull(s_area){var _this3=this,handlersCopy=_.clone(this.__handlers),getActualHandlers=function(){return _.intersection(handlersCopy,_this3.__handlers)};_.isEmpty(s_area)&&(s_area=handlersCopy.reduce(function(a,handler){return _.union(a,handler.area)},[]).join("|"));var deferred=this.once(s_area,null,"pull");return deferred.then(function(data){return __startHandlers(data,getActualHandlers())}),deferred["catch"](function(){getActualHandlers().forEach(function(handler){return handler.func(null,"pull error")})}),deferred}function __startHandlers(fulldata,actualHandlers){actualHandlers.forEach(function(handler){var infoAreasStatus=fulldata.infoAreasStatus,mask=[],data={};handler.area.forEach(function(area){!infoAreasStatus[area]||!infoAreasStatus[area].mask||infoAreasStatus[area].error&&4==infoAreasStatus[area].error.code||(mask=_.union(mask,infoAreasStatus[area].mask,["infoAreasStatus."+area+"."]))}),mask.length&&(data=__parse(fulldata,mask),handler.func(data,null))})}function __parse(data,mask){if(!data||!_.isArray(mask))return!1;var s_path,resObj={};for(var index in mask)s_path=mask[index],_.has(data,s_path)?resObj[s_path]=data[s_path]:("."==_.last(s_path)&&(s_path+="*"),__valueToMask(data,s_path,resObj));return resObj}function __valueToMask(inObj,s_path,outObj){var outObj,a_path,keys,key,value,new_s_path;if(inObj){if(outObj=outObj||(_.isArray(inObj)?[]:{}),a_path=s_path.split("."),keys=[],""==s_path)return;if("*"==a_path[0]){if(_.isEmpty(a_path[1])&&(_.isFunction(inObj)||!_.isObject(inObj)))return;keys=_.keys(inObj)}else keys.push(a_path[0]);for(var index in keys)if(key=keys[index],value=inObj[key],_.isFunction(value))outObj[key]=_.after(value);else if(_.isArray(value)||_.isObject(value))new_s_path="*"==a_path[0]?"*.*":s_path.substring(a_path[0].length+1),""==new_s_path&&_.isArray(value)&&(new_s_path="*.*"),outObj[key]=__valueToMask(value,new_s_path,outObj[key]);else{if("*"!=a_path[0]&&"*"==a_path[1])return outObj[a_path[0]]=void 0,outObj;outObj[key]=_.clone(value)}return outObj}}var devInfoModule=angular.module(regdep("devinfo"),[]);devInfoModule.service("devinfo",["$http","$timeout","$q",function($http,$timeout,$q){var inject={$http:$http,$timeout:$timeout,$q:$q},devinfo=new Devinfo(inject);return devinfo.init({need_auth:!0}),devinfo.auth=new Devinfo(inject),devinfo.auth.init({need_auth:!0}),devinfo.skipAuth=new Devinfo(inject),devinfo.skipAuth.init({need_auth:autoconf.BR2_PACKAGE_ANWEB_MULTI_DOMAIN_AUTH?!0:!1}),devinfo.longTimeout=new Devinfo(inject),devinfo.longTimeout.init({need_auth:!0}),devinfo.suspendAll=function(){devinfo.suspend(),devinfo.skipAuth.suspend(),devinfo.longTimeout.suspend()},devinfo.resumeAll=function(){devinfo.resume(),devinfo.skipAuth.resume(),devinfo.longTimeout.resume()},devinfo}]),Devinfo.prototype.init=function(obj){_.extend(this.__setting,obj)},Devinfo.prototype.once=function(s_area,config,mode){function success(data){return _.isObject(data)?void deferred.resolve(data.result):deferred.reject()}var url,opts,deferred=this.__$q.defer();return s_area&&s_area.length>0&&(url=this.__setting.url+("?area="+s_area)+("&_="+_.random(1e4,99999))+(this.__setting.need_auth?"&need_auth=1":"")+("pull"!=mode?"&mandatory=1":""),opts={timeout:config&&config.timeout?config.timeout:this.__setting.timeout},this.__$http.get(url,opts).success(success).error(function(){return deferred.reject()})),deferred.promise},Devinfo.prototype.subscribe=function(s_area,handler,scope){var _this=this;if(!_.isString(s_area)||!_.isFunction(handler))return{status:!1,mess:"Incorrect arguments"};if(scope){if(scope._willBeDestroyed)return{status:!1,mess:"Scope will be destroyed"};scope.$on("$destroy",function(){_this.unsubscribe(s_area,handler)})}var a_area=s_area.split("|"),found_handler=_.findWhere(this.__handlers,{func:handler});return found_handler?(a_area=_.difference(a_area,found_handler.area),a_area.length?(found_handler.area=_.union(found_handler.area,a_area),this.__handlers=this.__handlers.filter(function(h){return h.func!=handler}),this.__handlers.push(found_handler),{status:!0,mess:"Successfully added area for the handler"}):{status:!1,mess:"Such handler already exists"}):(this.__handlers.push({func:handler,area:a_area}),__start.call(this),{status:!0,mess:"Successfully added"})},Devinfo.prototype.onceAndSubscribe=function(s_area,handler,scope){this.once(s_area).then(handler)["finally"](this.subscribe.bind(this,s_area,handler,scope))},Devinfo.prototype.unsubscribe=function(s_area,handler){if(_.isEmpty(s_area))return this.__handlers.length=0,{status:!0,mess:"All handlers successfully removed"};var incorrectHandler=handler&&!_.isFunction(handler);if(!_.isString(s_area)||incorrectHandler)return{status:!1,mess:"Incorrect arguments"};var a_area=s_area.split("|");if(!handler)return this.__handlers.forEach(function(h){return h.area=_.difference(h.area,a_area)}),this.__handlers=this.__handlers.filter(function(h){return h.area.length}),{status:!0,mess:"Successfully deleted area for all handlers"};var found_handler=_.findWhere(this.__handlers,{func:handler});if(!found_handler)return{status:!1,mess:"The handler is not found"};var old_area=found_handler.area;return found_handler.area=_.difference(found_handler.area,a_area),found_handler.area.length?old_area.length>found_handler.area.length?{status:!0,mess:"Successfully deleted area for the handler"}:{status:!1,mess:"Area for handler is not found"}:(this.__handlers=this.__handlers.filter(function(h){return h.func!=handler}),{status:!0,mess:"Successfully deleted handler"})},Devinfo.prototype.suspend=function(){this.__isSuspended=!0},Devinfo.prototype.resume=function(){this.__isSuspended&&(this.__isSuspended=!1,__start.call(this))}}();
;"use strict";!function(){var deviceAvailableModule=angular.module(regdep("deviceAvailable"),["devinfo"]);deviceAvailableModule.provider("deviceAvailable",[function(){return this.getNotAvailableCallback=null,this.getAvailableAgainCallback=null,this.getMACAddressChangeCallback=null,this.getNotAvailableCountCallback=null,this.getAvailableCountCallback=null,this.$get=["$injector","$http","$timeout","$window","deviceAvailableInfo","deviceMacInfo",function($injector,$http,$timeout,$window,available){function init(options){settings=_.extend(settings,options)}function complete(){wasStarted=!1,available.clean(),$injector.invoke(providerObj.getAvailableAgainCallback,null,{deviceAvailableMode:mode})}function cors(hostname){var baseUrl,proto,port;hostname?(baseUrl="",proto=$window.location.protocol,port=$window.location.port,baseUrl+=proto+"//"+hostname,port&&(baseUrl+=":"+port),settings.baseUrl=baseUrl,headers["X-CORS-Header"]=!0):delete headers["X-CORS-Header"]}function request(){var url=settings.baseUrl+settings.url+"?&_="+_.random(1e4,99999),opts={timeout:settings.timeout,headers:headers};return $http.get(url,opts)}function __pull(){function success(response){if(_.isString(response)&&"fwupdate.local"==mode)console.log("old fw detected");else if(!response||!response.error||!response.error.code)return void error();__monitoring({}),refresh()}function error(){__monitoring(null,"pull error"),refresh()}function refresh(){$timeout(function(){activeTimer=!1,__pull()},settings.interval)}wasStarted&&(activeTimer||(activeTimer=!0,request().success(success).error(error)))}function __monitoring(data,error){wasStarted&&(available.update(data,error),__analyze(data))}function __analyze(){var availableStatus=available.getStatus(),availableState=available.getState();availableStatus?(notAvailableCount=0,"device_available_again"==availableState&&providerObj.getAvailableAgainCallback&&$injector.invoke(providerObj.getAvailableAgainCallback,null,{deviceAvailableMode:mode}),availableCount++,providerObj.getAvailableCountCallback&&$injector.invoke(providerObj.getAvailableCountCallback,null,{deviceAvailableMode:mode,deviceAvailableCount:availableCount})):(availableCount=0,"device_become_unavailable"==availableState&&providerObj.getNotAvailableCallback&&$injector.invoke(providerObj.getNotAvailableCallback,null,{deviceAvailableMode:mode}),notAvailableCount++,providerObj.getNotAvailableCountCallback&&$injector.invoke(providerObj.getNotAvailableCountCallback,null,{deviceAvailableMode:mode,deviceNotAvailableCount:notAvailableCount}))}var providerObj=this,wasStarted=!1,activeTimer=!1,settings={baseUrl:"",url:"/devinfo",interval:3e3,timeout:2e3},headers={},mode="pending",availableCount=0,notAvailableCount=0;return{init:init,once:request,start:function(){wasStarted=!0,__pull()},stop:function(){wasStarted=!1,available.clean()},cors:cors,complete:complete,setMode:function(name){mode=name,availableCount=0,notAvailableCount=0}}}],this}]),deviceAvailableModule.factory("deviceAvailableInfo",[function(){function isChangeStatus(){return status!=statusOld}function isNegativeStatusSet(){return isChangeStatus()&&status!==!0}function isPositiveStatusAgain(){return isChangeStatus()&&!_.isUndefined(statusOld)&&status===!0}function updateState(){state=isNegativeStatusSet()?"device_become_unavailable":isPositiveStatusAgain()?"device_available_again":"device_not_change_available"}function isResponseError(data,error){return error||!data}function updateStatus(data,error){statusOld=_.clone(status),status=!isResponseError(data,error)}var status,statusOld,state,getState=function(){return state},getStatus=function(){return status};return{clean:function(){status=void 0,statusOld=void 0,state=void 0},update:function(data,error){updateStatus(data,error),updateState()},getState:getState,getStatus:getStatus}}]),deviceAvailableModule.factory("deviceMacInfo",[function(){function parseMacAddress(data){return data&&data.lan&&data.lan[0]?data.lan[0].mac:void 0}var mac=void 0,update=function(newMac){mac=newMac},compare=function(data){var compareMac=parseMacAddress(data);return _.isUndefined(compareMac)||compareMac==mac};return{init:function(data){var newMac=parseMacAddress(data);return _.isUndefined(newMac)?!1:(update(newMac),!0)},update:update,compare:compare}}]),deviceAvailableModule.run(["deviceAvailable",function(da){da.start()}])}();
;"use strict";!function(){function NotificationsProvider(){var $container=null;this.setContainer=function(container){$container=container},this.getContainer=function(){return $container},this.$get=createNotificationsServiceFactory(this.getContainer)}function createNotificationsServiceFactory(_getContainer){function NotificationsServiceFactory($timeout,$rootScope,$compile){function notificationInQueueAlready(notification){if(!notification.name)return!1;if(config.currentNotification&&config.currentNotification.name==notification.name)return!0;var exists=_.findWhere(config.queue,{name:notification.name});return exists?!0:!1}function onNotificationClose(notification){removeFromDom(notification),start()}function removeFromDom(){config.getContainer().empty()}function addToDom(notification){config.$scope.notification=notification;var $elem=$compile('<div class="nw-popup-notification nw-popup-notification--hidden" nw-notification="notification"></div>')(config.$scope);$timeout(function(){return $elem.removeClass("nw-popup-notification--hidden")},0),config.getContainer().append($elem)}function nextNotification(){return _.size(config.queue)?(config.currentNotification=config.queue.shift(),addToDom(config.currentNotification),void stop()):void(config.currentNotification=null)}function start(){config.refreshCanceler=$timeout(nextNotification,config.refreshTime)}function stop(){config.refreshCanceler&&$timeout.cancel(config.refreshCanceler),config.refreshCanceler=null}function inShowing(){return!config.refreshCanceler}var config={queue:[],currentNotification:null,refreshTime:1e3,refreshCanceler:null,getContainer:function(){return angular.element(_getContainer())},$scope:$rootScope.$new()};return start(),{add:function(notification){function attachOnClose(action){return function(){_.isFunction(action)&&action(),onNotificationClose(closableNotification)}}if(!notificationInQueueAlready(notification)){var closableNotification=_.extend({},notification,{close:attachOnClose(notification.close,closableNotification)});_.each(closableNotification.actions,function(action){action.handler=attachOnClose(action.handler)}),config.queue.push(closableNotification),inShowing()||nextNotification()}}}}return NotificationsServiceFactory.$inject=["$timeout","$rootScope","$compile"],NotificationsServiceFactory}angular.module(regdep("notifications"),[]).provider("notifications",NotificationsProvider),NotificationsProvider.$inject=[]}();
;"use strict";!function(){var eventHandlerModule=angular.module(regdep("eventHandler"),["devinfo","deviceAvailable","app-module-funcs"]);eventHandlerModule.provider("eventHandler",[function(){var providerObj=this;return this.notUseHandlers=null,this.deviceRebootTime=null,this.deviceResetConfigTime=null,this.deviceLocalFwUploadTime=null,this.deviceLocalFwUpdateTime=null,this.overlaySimpleStart=null,this.overlaySimpleStop=null,this.overlayNotAvailableStart=null,this.overlayNotAvailableStop=null,this.getDeviceActionStartedCallback=null,this.getDeviceActionSucceedCallback=null,this.getDeviceActionFailedCallback=null,this.$get=["$injector","$rootScope","$timeout","$window","devinfo","deviceAvailable","funcs","overlay-core",function($injector,$rootScope,$timeout,$window,devinfo,deviceAvailable,funcs){function __callCallback(name,params){params=params||{},providerObj[name]&&$injector.invoke(providerObj[name],null,{callbackParams:params,$rootScope:$rootScope})}var handler={},flags={requestOverlaySuspend:!1};return handler.request=function(){function activate(){events.push($rootScope.$on("request.started",requestStarted)),events.push($rootScope.$on("request.succeed",requestComplited)),events.push($rootScope.$on("request.failed",requestComplited)),events.push($rootScope.$on("request.finally",requestFinally)),events.push($rootScope.$on("request.not_authorized",requestNotAuthorized))}function requestStarted($event,request){isExcludeRequest(request.config)||(devinfo.suspendAll(),deviceAvailable.setMode("request"),flags.requestOverlaySuspend||__callCallback("overlaySimpleStart",{event:request.config.url,request:request}))}function requestComplited($event,response){isExcludeRequest(response.config)||(devinfo.resumeAll(),deviceAvailable.setMode("pending"),__callCallback("overlaySimpleStop",{event:response.config.url}))}function requestFinally($event,request){isExcludeRequest(request.config)||actionDefinition(request)}function requestNotAuthorized($event,response){isExcludeRequest(response.config)||(deviceAvailable.setMode("pending"),__callCallback("overlaySimpleStop",{event:response.config.url}))}function isExcludeRequest(config){return _.some(excludeRequest,function(re){return config&&re.test(config.url)})}function actionDefinition(request){(function(request){return funcs.is.somovdRequest(request,"cmd",{id:6})})(request)&&handler.deviceAction.pub.started(null,{action:"reboot"}),function(request){return funcs.is.somovdRequest(request,"cmd",{id:8})}(request)&&handler.deviceAction.pub.started(null,{action:"save.and.reboot"}),function(request){return funcs.is.somovdRequest(request,"cmd",{id:10})}(request)&&handler.deviceAction.pub.started(null,{action:"reset"})}var events=[],excludeRequest=[/devinfo*/,/fwupdate*/,/\.html$/,/\.js$/];return{activate:activate,suspend:function(){for(var event;events.length>0;)event=events.splice(0,1),event[0]()},resume:activate,pub:{}}}(),handler.deviceAction=function(){function activate(){events.push($rootScope.$on("device.action.started",actionStarted)),events.push($rootScope.$on("device.action.suspend",actionSuspend)),events.push($rootScope.$on("device.action.resume",actionResume)),events.push($rootScope.$on("device.action.succeed",actionSucceed)),events.push($rootScope.$on("device.action.failed",actionFailed)),pub.started=actionStarted}function actionStarted($event,params){var duration,checkStarted,precheckSuspend;switch(params.action){case"reboot":case"save.and.reboot":var duration=providerObj.deviceRebootTime,checkStarted=duration-.5*duration,precheckSuspend=!1;break;case"reset":var duration=providerObj.deviceResetConfigTime,checkStarted=duration-.5*duration,precheckSuspend=!1;break;case"fwupdate.local":var duration=providerObj.deviceLocalFwUploadTime+providerObj.deviceLocalFwUpdateTime+providerObj.deviceRebootTime,checkStarted=3e4+providerObj.deviceLocalFwUploadTime,precheckSuspend=!1;break;case"fwupdate.remote":var duration=providerObj.deviceLocalFwUploadTime+providerObj.deviceLocalFwUpdateTime+providerObj.deviceRebootTime,checkStarted=3e4,precheckSuspend=!0;break;case"dcc.apply":duration=13e4,checkStarted=15e3,precheckSuspend=!1}deviceAvailable.setMode(params.action+".pending"),devinfo.suspendAll(),precheckSuspend&&deviceAvailable.stop(),__callCallback("getDeviceActionStartedCallback",{action:params.action,duration:duration}),checkTimer=$timeout(function(){precheckSuspend&&deviceAvailable.start(),deviceAvailable.setMode(params.action)},checkStarted),endTimer=$timeout(function(){switch(params.action){case"fwupdate.local":return actionFailed(null,params);default:return actionSucceed(null,params)}},duration)}function actionSuspend($event,params){deviceAvailable.setMode(params.action+".pending")}function actionResume($event,params){deviceAvailable.setMode(params.action)}function actionSucceed($event,params){actionTimeoutBreak(),actionDevinfoResume(),deviceAvailable.setMode("pending"),__callCallback("getDeviceActionSucceedCallback",params)}function actionFailed($evenet,params){actionTimeoutBreak(),actionDevinfoResume(),__callCallback("getDeviceActionFailedCallback",params)}function actionTimeoutBreak(){$timeout.cancel(checkTimer),$timeout.cancel(endTimer)}function actionDevinfoResume(){devinfo.init({timeout:5e3}),devinfo.resumeAll()}var checkTimer,endTimer,events=[],pub={};return{activate:activate,suspend:function(){for(var event;events.length>0;)event=events.splice(0,1),event[0]();_.each(pub,function(func,key){pub[key]=function(){}})},resume:activate,pub:pub}}(),handler.deviceAvailable=function(){function activate(){events.push($rootScope.$on("device.state.not_available",notAvailable)),events.push($rootScope.$on("device.state.available_again",availableAgain))}function notAvailable($event,params){__callCallback("overlayNotAvailableStart",params)}function availableAgain(){__callCallback("overlayNotAvailableStop")}var events=[];return{activate:activate,suspend:function(){for(var event;events.length>0;)event=events.splice(0,1),event[0]()},resume:activate,pub:{}}}(),handler.uiRouter=function(){function activate(){events.push($rootScope.$on("$stateChangeStart",stateChangeStart)),events.push($rootScope.$on("$stateChangeError",stateChangeError)),events.push($rootScope.$on("stateChangeBreak",stateChangeBreak)),events.push($rootScope.$on("pageload",pageload))}function stateChangeStart($event,toState){(toState.controller||toState.views&&toState.views[""])&&__callCallback("overlaySimpleStart",{event:"pageload"})}function stateChangeError(){__callCallback("overlaySimpleStop",{event:"pageload"})}function stateChangeBreak(){__callCallback("overlaySimpleStop",{event:"pageload"})}function pageload(){__callCallback("overlaySimpleStop",{event:"pageload"})}var events=[];return{activate:activate,suspend:function(){for(var event;events.length>0;)event=events.splice(0,1),event[0]()},resume:activate,pub:{}}}(),handler.navigation=function(){function activate(){$window.onunload=onuload}function onuload(){devinfo.suspendAll(),deviceAvailable.complete()}return{activate:activate,suspend:function(){$window.onunload=null},resume:activate,pub:{}}}(),function(){providerObj.notUseHandlers&&_.each(providerObj.notUseHandlers,function(key){delete handler[key]})}(),function(){_.each(handler,function(elem){elem.activate()})}(),{suspend:function(){_.each(handler,function(elem){elem.suspend()})},resume:function(){_.each(handler,function(elem){elem.resume()})},setFlag:function(name,value){_.has(flags,name)&&(flags[name]=value)}}}],this}]),eventHandlerModule.config(["$injector","$provide","eventHandlerProvider",function($injector,$provide,eventHandler){var deviceAvailable=$injector.get("deviceAvailableProvider");deviceAvailable.getNotAvailableCallback=["$rootScope","deviceAvailableMode",function($rootScope,mode){"pending"==mode&&$rootScope.$emit("device.state.not_available",{mode:"basic",count:1})}],deviceAvailable.getAvailableAgainCallback=["$rootScope","deviceAvailableMode",function($rootScope,mode){switch(mode){case"pending":case"request":case"reboot.pending":case"save.and.reboot.pending":case"reset.pending":$rootScope.$emit("device.state.available_again")}}],deviceAvailable.getAvailableCountCallback=["$rootScope","deviceAvailableMode","deviceAvailableCount",function($rootScope,mode,count){switch(mode){case"reboot":case"save.and.reboot":case"reset":case"fwupdate.local":case"fwupdate.remote":3==count&&$rootScope.$emit("device.action.succeed",{action:mode})}}],deviceAvailable.getNotAvailableCountCallback=["$rootScope","deviceAvailableMode","deviceNotAvailableCount",function($rootScope,mode,count){switch(mode){case"pending":count=3>count?0:count,$rootScope.$emit("device.state.not_available",{mode:"basic",count:count});break;case"request":case"reboot.pending":case"save.and.reboot.pending":case"reset.pending":$rootScope.$emit("device.state.not_available",{mode:"icon"});break;case"reboot":case"save.and.reboot":case"reset":5==count&&$rootScope.$emit("device.action.failed",{action:mode})}}],eventHandler.deviceRebootTime=parseInt(autoconf.BR2_PACKAGE_ANWEB_DEVICE_REBOOT_TIME),eventHandler.deviceResetConfigTime=parseInt(autoconf.BR2_PACKAGE_ANWEB_DEVICE_RESET_CONFIG_TIME),eventHandler.deviceLocalFwUploadTime=parseInt(autoconf.BR2_PACKAGE_ANWEB_DEVICE_LOCAL_FIRMWARE_UPLOAD_TIME),eventHandler.deviceLocalFwUpdateTime=parseInt(autoconf.BR2_PACKAGE_ANWEB_DEVICE_LOCAL_FIRMWARE_UPDATE_TIME),eventHandler.overlaySimpleStart=["overlay-core","funcs","callbackParams","$rootScope",function(overlay,funcs,params,$rootScope){(function(params){if(params.request){if(funcs.is.silentSomovdRequest(params.request))return!1;if(funcs.is.somovdRequest(params.request,"write",{id:250}))return!1}return!0})(params)&&("pageload"==params.event?$rootScope.pageReady=!1:$rootScope.pageReady&&overlay.simple.start(params))}],eventHandler.overlaySimpleStop=["overlay-core","callbackParams","$rootScope",function(overlay,params,$rootScope){"pageload"==params.event?$rootScope.pageReady=!0:overlay.simple.stop(params)}],eventHandler.overlayNotAvailableStart=["overlay-core","callbackParams",function(overlay,params){overlay.notAvailable.start(params.mode,params.count)}],eventHandler.overlayNotAvailableStop=["overlay-core","callbackParams",function(overlay,params){overlay.notAvailable.stop(params.mode,params.count)}],eventHandler.getDeviceActionStartedCallback=["overlay-core","callbackParams",function(overlay,params){switch(params.action){case"fwupdate.local":case"fwupdate.remote":params.title="wizard_update_in_progress"}overlay.progress.start(params)}],eventHandler.getDeviceActionSucceedCallback=["$location","$window","deviceAvailable","authDigest","callbackParams",function($location,$window,deviceAvailable,authDigest,params){function fwupdateLocal(response){_.isString(response.data)?(window.onbeforeunload=null,location.href=$location.protocol()+"://"+$location.host()+":"+$location.port()):$window.location.reload()}switch(params.action){case"fwupdate.local":case"fwupdate.remote":return void deviceAvailable.once().then(fwupdateLocal);case"save.and.reboot":case"reboot":case"reset":authDigest.cleanCredentials();break;case"dcc.apply":}$window.location.reload()}],eventHandler.getDeviceActionFailedCallback=["$location","deviceAvailable","overlay-core","authDigest","funcs","lanIPChange","callbackParams","$rootScope",function($location,deviceAvailable,overlay,authDigest,funcs,lanIPChange,params,$rootScope){function rebootHandler(){authDigest.cleanCredentials(),function(){return!isLocalhost()&&!isDomain()&&lanIPChange.isChange()}()?goToNewIPWithDelay(lanIPChange.getNewIP()):showErrorOverlay(),lanIPChange.clear()}function resetHandler(){authDigest.cleanCredentials();var defaultIP=autoconf.BR2_PACKAGE_ANWEB_DEVICE_DEFAULT_IP?autoconf.BR2_PACKAGE_ANWEB_DEVICE_DEFAULT_IP:"192.168.0.1";!function(ip){return!isLocalhost()&&!isDomain()&&$location.host()!=ip}(defaultIP)?showErrorOverlay():goToNewIPWithDelay(defaultIP),lanIPChange.clear()}function showErrorOverlay(){overlay.progress.stop(),overlay.notAvailable.start("static")}function isLocalhost(){var host=$location.host();return"localhost"==host||"127.0.0.1"==host}function isDomain(){var host=$location.host();return!funcs.is.ipv4(host)}function goToNewIPWithDelay(ip){var count,myInterval;$rootScope.dlinkMobileApp&&$rootScope.dlinkMobileApp.isUserInMobileApp()?(count=0,$rootScope.dlinkMobileApp.ipAddressChanged(ip),myInterval=window.setInterval(function(){console.log("Wait for network"),$rootScope.dlinkMobileApp.isPhoneConnectedToRouter().then(function(connected){connected&&goToNewIP(ip),count++,(connected||count>=5)&&(window.clearInterval(myInterval),connected||$rootScope.dlinkMobileApp.closeWebInterface())})},5e3)):goToNewIP(ip)}function goToNewIP(ip){var url=getNewURL(ip);window.onbeforeunload=null,location.href=url}function goToRoot(){var url=$location.protocol()+"://"+$location.host()+":"+$location.port();window.onbeforeunload=null,location.href=url}function getNewURL(ip){var oldURL=$location.absUrl();return oldURL.replace(/(\:\/\/)([^:\/]*)/,function(str,p1){return p1+ip})}switch(params.action){case"save.and.reboot":case"reboot":rebootHandler();break;case"reset":resetHandler();break;default:deviceAvailable.once().then(goToRoot,showErrorOverlay)}}],$provide.decorator("$http",function($delegate,$rootScope){function $generateHttpEvent(method){function __formRequestData(config,data,method){var rq={config:{}};return _.isString(config)?(rq.config.url=config,rq.config.method=method?method.toUpperCase():""):rq.config=_.extend(rq.config,config),data&&(rq.data=data),rq}function __rqStarted(request){$rootScope.$emit("request.started",request)}function __rqFinally(request){$rootScope.$emit("request.finally",request)}function __rqSucceed(response){$rootScope.$emit("request.succeed",response)}function __rqFailed(response){$rootScope.$emit("request.failed",response)}return function(config,data){var http=method?$http[method]:$http,requestData=__formRequestData(config,data,method);__rqStarted(requestData);var request=http.apply($http,arguments);return request.then(__rqSucceed,__rqFailed),request["finally"](function(){__rqFinally(requestData)}),request}}var $http=$delegate,wrapper=$generateHttpEvent();return Object.keys($http).filter(function(key){return"function"==typeof $http[key]}).forEach(function(method){wrapper[method]=$generateHttpEvent(method)}),wrapper})}])}();
;"use strict";!function(){angular.module(regdep("modewatch"),["devinfo","app-module-funcs","ngDialog"]).service("checkDeviceModeChange",["$rootScope","$controller","devinfo","ngDialog","funcs","cookie",function($rs,$controller,devinfo,ngDialog,funcs,cookie){function handler(res){if(res&&res.deviceMode){currentMode=res.deviceMode,initedMode=initedMode||currentMode;var cookieMode=cookie.get("device_mode");if("Firewall"==res.deviceMode&&cookieMode!=res.deviceMode)return cookie.set("device_mode",res.deviceMode),void showDialog();initedMode===currentMode||isModeChanged||($rs.deviceMode=currentMode,isModeChanged=!0,showDialog()),initedMode===currentMode&&isModeChanged&&(isModeChanged=!1,closeDialog())}}function showDialog(){var config;ngDialog.isOpen(dialogID)||(config={template:"dialogs/check_device_mode_change/dialog.tpl.html",className:"check_device_mode_change_dialog",closeByDocument:!1,closeByEscape:!1,controller:"CheckDeviceModeChangeDialogCtrl",showClose:!1},lazyLoad&&(config.resolve=funcs.getLazyResolve("dialogs/check_device_mode_change/ctrl.lazy.js","CheckDeviceModeChangeDialogCtrl")),dialogID=ngDialog.open(config).id)}function closeDialog(){ngDialog.isOpen(dialogID)&&ngDialog.close(dialogID)}var currentMode,areas="notice",initedMode=null,isModeChanged=!1,dialogID=null,isRun=!1,lazyLoad=function(){try{return $controller("CheckDeviceModeChangeDialogCtrl",{$scope:{}},!0),!1}catch(ex){return!0}}();this.start=function(){isRun||(isRun=!0,devinfo.skipAuth.subscribe(areas,handler),console.info("Checking the device mode change is started"))},this.stop=function(){return devinfo.skipAuth.unsubscribe(areas,handler)}}]).run(["checkDeviceModeChange",function(checkDeviceModeChange){checkDeviceModeChange.start()}])}();
;"use strict";!function(){var constants={CONFIG_ID_WAN_TEMP:1,CMD_SAVE_AND_REBOOT:8,CMD_SAVE_CONFIG:20},lanIPChangeModule=angular.module(regdep("lanIPChange"),["device","devinfo","anweb-storage"]);lanIPChangeModule.service("lanIPChange",["$location","devinfo","somovd","funcs","$timeout","anwebStorage",function(location,devinfo,somovd,funcs,$timeout,storageService){function __checkChangeIP(error,result){if(!error&&funcs.is.RPCSuccess(result)){var data=result.request.params.data;(function(data){return data&&data.br0&&data.br0.services.br0})(data)&&storage.set("newIP",function(data){return data.br0.services.br0.ip}(data))}}function __checkSaveConfig(error,result){!error&&funcs.is.RPCSuccess(result)&&storage.set("isSaveConfigAfterChange",__isChangeIP()?!0:!1)}function __isChangeIP(){var oldIP=storage.get("oldIP"),newIP=storage.get("newIP");return oldIP&&newIP&&oldIP!=newIP}var storage=storageService.make("lan-ip-change");return function(){function pull(){function hasIP(result){return result&&result.lan&&result.lan.length&&result.lan[0].ip}devinfo.skipAuth.once("net|notice").then(function(result){if(!hasIP(result))return void $timeout(pull,3e3);var oldIP=storage.get("oldIP"),ip=result.lan[0].ip,systemNotice=result.systemNotice;oldIP&&oldIP!=ip?(storage.set("newIP",ip),storage.set("isSaveConfigAfterChange","NeedSave"!=systemNotice&&"NeedSaveAndReboot"!=systemNotice)):(storage.set("newIP",""),storage.set("isSaveConfigAfterChange",!1))})}var host=location.host();storage.set("oldIP",funcs.is.ipv4(host)?host:""),somovd.subscribe("write",{id:constants.CONFIG_ID_WAN_TEMP},__checkChangeIP),somovd.subscribe("cmd",{id:constants.CMD_SAVE_AND_REBOOT},__checkSaveConfig),somovd.subscribe("cmd",{id:constants.CMD_SAVE_CONFIG},__checkSaveConfig),pull()}(),{isChange:function(){return storage.get("isSaveConfigAfterChange")&&__isChangeIP()},getNewIP:function(){return storage.get("newIP")},clear:function(){storage.clearAll()}}}]),lanIPChangeModule.run(["$injector",function($injector){$injector.get("lanIPChange")}])}();
;"use strict";!function(){var slacker=angular.module(regdep("slacker"),[]);slacker.run(["$rootScope","devinfo","slacker-helper",function($rootScope,devinfo,helper){function init(){var api=autoconf.BR2_PACKAGE_ANWEB_DSYSINIT?devinfo.auth:devinfo.skipAuth;return api.once("version").then(function(data){data&&data.logoutTime&&(logoutTime=data.logoutTime,reset())})}function reset(){logoutTime&&(clearInterval(timeoutID),timeoutID=setInterval(logout,logoutTime))}function logout(){helper.isNeedLogout()&&helper.logout()}var timeoutID,logoutTime=null;$rootScope.$on("slacker.reload",function(){init()}),init().then(function(){angular.element(document).on("scroll",reset),angular.element(document).find("body").on("keydown mousedown contextmenu mousemove",reset)})}])}();
;"use strict";!function(){var slacker=angular.module(regdep("slacker"));slacker.service("slacker-helper",["$http","authDigest",function($http,authDigest){return{logout:function(){authDigest.cleanCredentials(),window.location.href="/",$http.get("/logout"),document.cookie="device-session-id=; path = /; expires="+new Date((new Date).getTime()-3e4).toGMTString()},isNeedLogout:function(){return!0}}}])}();
;"use strict";!function(){var anwebStorage=angular.module("anweb-storage",["LocalStorageModule"]);anwebStorage.service("anwebStorage",["localStorageService",function(localStorageService){function Storage(name,initData){function getStorage(){var result=getParam(name);return JSON.parse(result)}function setStorage(storage){setParam(name,JSON.stringify(storage))}function getParam(param){return localStorageService.get(param)}function setParam(param,value){localStorageService.set(param,value)}function removeParam(param){localStorageService.remove(param)}return function(){return!!getParam(name)}()||function(initData){initData||(initData={}),setParam(name,JSON.stringify(initData))}(initData),{get:function(param){var storage=getStorage();return _.isUndefined(storage[param])?null:storage[param]},set:function(param,value){var storage=getStorage();storage[param]=value,setStorage(storage)},getStorage:getStorage,setStorage:setStorage,clearAll:function(){removeParam(name)}}}return{make:function(name){return new Storage(name)}}}])}();
;"use strict";!function(){function routerHelperProvider($locationProvider,$stateProvider,$urlRouterProvider){function RouterHelper($state){function setOtherwise(otherwisePath){otherwisePath&&!hasOtherwise&&(hasOtherwise=!0,$urlRouterProvider.otherwise(otherwisePath))}var hasOtherwise=!1;return{configureStates:function(states){states.forEach(function(state){$stateProvider.state(state.state,state.config)})},setOtherwise:setOtherwise,getStates:function(){return $state.get()}}}this.$get=RouterHelper,RouterHelper.$inject=["$state"]}angular.module(regdep("ui.router.helper"),["ui.router"]).provider("routerHelper",routerHelperProvider),routerHelperProvider.$inject=["$locationProvider","$stateProvider","$urlRouterProvider"]}();
;"use strict";!function(){var nw=angular.module(regdep("nw-name"),[]);nw.directive("nwName",function(){return{restrict:"A",require:"ngModel",link:function($scope,$element,$attrs,$model){function validator(value){return $attrs.ngMaxlength||$attrs.disabled||_.isUndefined(value)||!value.toString().length||$model.$setValidity("msg_invalid_name_length",value.length<33),value}$model.$parsers.unshift(validator),$model.$formatters.unshift(validator)}}})}();
;"use strict";!function(){var nw=angular.module(regdep("nw-changing-list"),[]);nw.directive("nwChangingList",["translate",function(){return{restrict:"A",template:function(elem,attr){var fields='<div class="input_with_action" ng-repeat="value in list | limitTo:limit track by $index"><div nw-field nw-required="required" nw-disabled="disabled"> <input type="text" '+function(property){return property?'ng-model="list[$index][property]" ':'ng-model="list[$index]" '}(attr.nwChangingListProperty)+'nw-type="{{type}}" placeholder="{{placeholder | translate}}" nw-set-focus="{{focus === true}}" nw-custom-valid="validation(value, $index)" class="under_cross_change" > </div> <div class="input_action" ng-if="showRemoveButton()" ng-click="removeRow($index)">×</div> </div> ';return'<div class="changing_list"><div class="{{getLabelClass()}} label">{{label | translate}}<font color="red" ng-show="required && !disabled && list.length">*</font></div><div class="empty" ng-if="!list.length"> <div class="note"><span ng-bind="\'changing_list_empty\' | translate"></span><span ng-if="default"> ({{"by_default" | translate}} {{default}})</span> </div></div>'+fields+'<div class="button_block right"> <input type="button" ng-disabled="disabledAddRow()" ng-click="addRow()" value="{{\'act_add\' | translate}}" class="colored flat" ></div></div>'},scope:{label:"@nwChangingListLabel",labelClass:"@nwChangingListLabelClass",placeholder:"@nwChangingListPlaceholder",type:"@nwChangingListType",list:"=nwChangingList",defNewRow:"=nwChangingListDefaultNewRow",limit:"@nwChangingListLimit",disabled:"=nwChangingListDisabled",property:"@nwChangingListProperty","default":"@nwChangingListDefault"},link:function($scope,$element,$attrs){var needUniq=_.has($attrs,"nwChangingListUniq"),notEmpty=_.has($attrs,"nwChangingListNotEmpty"),notCyrillic=_.has($attrs,"nwChangingListNotCyrillic");$scope.addRow=function(){$scope.focus=!0;var obj,defNewRow=$scope.defNewRow?_.clone($scope.defNewRow):"";$scope.property&&(obj={},obj[$scope.property]=defNewRow,defNewRow=_.clone(obj)),$scope.list.push(defNewRow)},$scope.removeRow=function(index){$scope.list.splice(index,1)},$scope.disabledAddRow=function(){return $scope.list&&($scope.list.length>=$scope.limit||$scope.disabled)},$scope.validation=function(value,index){return needUniq&&!function(value,without){var checkList=_.clone($scope.list);return!_.isUndefined(without)&&without<checkList.length&&checkList.splice(without,1),!_.contains(_.compact(checkList),value)}(value,index)?"msg_error_rule_is_not_uniq":notCyrillic&&function(value){var reg=/[а-яА-Я]/;return reg.test(value)}(value)?"msg_invalid_not_cyrillic_char":null},$scope.getLabelClass=function(){return $scope.labelClass?$scope.labelClass:"card-title"},$scope.showRemoveButton=function(){var result;return result=$scope.disabled?!1:notEmpty?$scope.list.length>1:!0},$attrs.$observe("nwChangingList",function(){_.isArray($scope.list)||($scope.list=[]),!_.size($scope.list)&&notEmpty&&$scope.list.push("")}),$attrs.$observe("@nwChangingListLimit",function(){$scope.limit=$scope.limit||100}),$attrs.$observe("nwChangingListRequired",function(value){$scope.required=_.isUndefined(value)?!1:""===value?!0:!!value})}}}])}();
;"use strict";angular.module(regdep("nw-local-domain"),[]).directive("nwLocalDomain",[function(){return{restrict:"A",require:"ngModel",link:function($scope,$element,$attrs,$model){function validator(host){$scope.dom=host||"";var host=punycode.toASCII(host)||"",regDomain=/^(xn--)?(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9\-]*[a-zA-Z0-9])\.)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9\-]*[A-Za-z0-9])\.local$/;return host=host.replace(/(^\s+|\s+$)/g,""),host.length&&host.length>64?$model.$setValidity("msg_invalid_domain",!1):host.length&&!regDomain.test(host)?$model.$setValidity("msg_invalid_domain",!1):$model.$setValidity("msg_invalid_domain",!0),host}$model.$parsers.unshift(validator),$model.$formatters.unshift(validator),$model.$formatters.unshift(function(value){return punycode.toUnicode(value)}),$model.$parsers.unshift(function(value){return punycode.toASCII(value)})}}}]);
;"use strict";!function(){var tools=angular.module(regdep("url-parser"),[]);tools.constant("queryString",function(a){if(""==a)return{};var i,p,b={};for(i=0;i<a.length;++i)p=a[i].split("=",2),2==p.length&&(b[p[0]]=decodeURIComponent(p[1].replace(/\+/g," ")));return b}(window.location.search.substr(1).split("&")))}();
;"use strict";!function(){angular.module(regdep("wifi-backup"),[]).run(["$q","somovd","$rootScope",function($q,somovd,$rootScope){function isResetAndReboot(req){return 10==req.params.id&&"cmd"==req.method}function saveMbssid(defer,res){try{$rootScope.dlinkMobileApp.isUserInMobileApp()&&$rootScope.dlinkMobileApp.saveValue&&$rootScope.dlinkMobileApp.hasSaveValueFunc?(mbssidToAppStorage(res.data,"mbssid"),mbssidToAppStorage(res.data,"5G_mbssid")):(mbssidToSessionStorage(res.data,"mbssid"),mbssidToSessionStorage(res.data,"5G_mbssid"))}catch(e){}finally{defer.resolve()}}function mbssidToSessionStorage(data,key){sessionStorage.setItem(key,JSON.stringify(data[key]))}function mbssidToAppStorage(data,key){$rootScope.dlinkMobileApp.saveValue(key,JSON.stringify(data[key]))}somovd.prepareHook(function(reqs){var defer=$q.defer();return reqs.some(isResetAndReboot)?somovd.read(35,saveMbssid.bind(null,defer)):defer.resolve(),defer.promise})}])}();
;"use strict";!function(){var nw=angular.module(regdep("nw-hostname"),[]);nw.directive("nwHostname",function(){return{restrict:"A",require:"ngModel",link:function($scope,$elem,$attrs,$model){function validator(value){return _.isUndefined(value)||$attrs.disabled||($model.$setValidity("msg_invalid_hostname",isHostname(value)),$model.$setValidity("msg_invalid_name_length",value.length<255)),value}function isHostname(hostname){hostname=hostname.replace(/(^\s+|\s+$)/g,""),hostname=punycode.toASCII(hostname);var allowSymbol="";$attrs.nwHostnameAllow&&(allowSymbol=$attrs.nwHostnameAllow);var patt="^(xn--)?(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9-"+allowSymbol+"]*[a-zA-Z0-9]).)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9-]*[A-Za-z0-9])$";_.isUndefined($attrs.nwHostnamePart)||(patt="^[.]{0,1}(([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9-"+allowSymbol+"]*[a-zA-Z0-9]).)*([A-Za-z0-9]|[A-Za-z0-9][A-Za-z0-9-]*[A-Za-z0-9.])$");var re=new RegExp(patt);return hostname?re.test(hostname):!0}$model.$parsers.unshift(validator),$model.$formatters.unshift(validator),$model.$formatters.unshift(function(value){return punycode.toUnicode(value)}),$model.$parsers.unshift(function(value){return punycode.toASCII(value)})}}}),nw.directive("nwPunycode",function(){return{restrict:"A",scope:{text:"=nwPunycode"},link:function($scope,$elem){$scope.$watch("text",function(){$elem.html(punycode.toUnicode($scope.text))})}}})}();
;"use strict";!function(){var nw=angular.module(regdep("nw-client-list"),["devinfo"]);nw.directive("nwClientList",["$compile","funcs","nwClientListUtil",function($compile,funcs,util){function link($scope,$element,$attrs){function addDropList(){$attrs.$set("nwClientList","false"),$element.attr("nw-drop-list",""),$element.attr("nw-drop-list-options",key+".info"),$compile($element)($scope)}function updateClientsInfo(){if($scope[key].clients){var clients=util.prepareClientsList($scope[key].clients,$scope[key].version,$scope[key].direction,$scope[key].exclude,$scope[key].filterFn);$scope[key].info=util.formClientsInfo(clients,$attrs.nwClientListType,$scope[key].iface,$scope[key].band)}}if("false"!=$attrs.nwClientList){clientListNumber++;var key="clientList_"+clientListNumber;$scope[key]={info:[],exclude:[],clients:null,version:null,direction:null,band:null},function(){return _.has($attrs,"nwDropList")&&_.has($attrs,"nwDropListOptions")}()||function(){addDropList(),util.pull($element.attr("nw-client-list-source")).then(function(result){$scope[key].clients=result.clients,$scope[key].iface=result.iface,updateClientsInfo()})}(),$attrs.$observe("nwClientListVersion",function(value){$scope[key].version!=value&&($scope[key].version=value,updateClientsInfo())}),$attrs.$observe("nwClientListDirection",function(value){$scope[key].direction!=value&&($scope[key].direction=value,updateClientsInfo())}),$attrs.$observe("nwClientListExclude",function(value){value&&($scope[key].exclude=$scope.$eval(value),updateClientsInfo())}),$attrs.$observe("nwClientListBand",function(value){value&&($scope[key].band=$scope.$eval(value),updateClientsInfo())})}}return funcs.is,{restrict:"A",require:"ngModel",link:link}}]);var clientListNumber=0;nw.directive("nwClientListCore",["nwClientListUtil",function(util){return{restrict:"A",link:function($scope,$element,$attrs,$model){function setValue(value){_.isUndefined($attrs.nwHostname)||(value=punycode.toUnicode(value)),$model.$setViewValue(value),$model.$render()}util.pull("all").then(function(result){var model,knownClients=result.clients,clientMac=$attrs.nwClientListCoreMac?$attrs.nwClientListCoreMac:null,clientIp=$attrs.nwClientListCoreIp?$attrs.nwClientListCoreIp:null,clientHostname=$attrs.ngModel?$attrs.ngModel:null;model=$attrs.nwClientListCoreIp?clientIp:clientMac,$scope.$watchCollection("["+model+", "+clientHostname+"]",function(newVal,oldVal){var client,oldModel=oldVal&&oldVal[0]?oldVal[0].toLowerCase():null,newModel=newVal&&newVal[0]?newVal[0].toLowerCase():null,oldHostname=oldVal&&oldVal[1]?oldVal[1]:null,newHostname=newVal&&newVal[1]?newVal[1]:null;if(model===clientMac&&(client=newVal&&newVal[0]?util.findClient(knownClients,newModel,"mac"):null),model===clientIp&&(client=newVal&&newVal[0]?util.findClient(knownClients,newModel,"ip"):null),client){if(newModel==oldModel)return;setValue(util.getHostname(client))}else newVal&&newHostname&&setValue(newHostname!=oldHostname&&""!=newHostname||newModel!=oldModel?newHostname:oldHostname)})})},require:"ngModel"}}])}();
;"use strict";!function(){var nw=angular.module("nw-client-list");nw.service("nwClientListUtil",["$q","funcs","devinfo",function($q,funcs,devinfo){function pull(source){function error(){isLoading=!1,deferred.reject()}var areaList={all:"187",wifi:"64",macfilter:"42",leasesv4:"34",leasesv6:"193"},source=source&&source.split(" "),area=_.chain(source).map(function(el){return areaList[el]}).compact().value().join("|");area||(area=areaList.all);var deferred=$q.defer();return isLoading?promise:(isLoading=!0,promise=deferred.promise,devinfo.init({need_auth:!0}),devinfo.once(area).then(function(data){var clients,wifi,macfilter,leasesv4,leasesv6;return isLoading=!1,data?(clients=[],wifi=[],macfilter=[],leasesv4=[],leasesv6=[],data[187]&&(clients=data[187]),data[64]&&(wifi=_.chain(data[64]).map(function(el){return el.mac=el.mac&&el.mac.toUpperCase(),el.name="WLAN",el}).filter(function(el){return!_.some(clients,function(cl){return cl.mac==el.mac})}).value()),data[42]&&(_.each(_.omit(data[42].MacFilterList,"max_instance"),function(elem){macfilter.push(elem)}),data[42]["5G_MacFilterList"]&&_.each(_.omit(data[42]["5G_MacFilterList"],"max_instance"),function(elem){macfilter.push(elem)})),data[34]&&(leasesv4=_.chain(data[34]).map(function(el){return el.mac=el.MACAddress&&el.MACAddress.toLowerCase(),el}).filter(function(el){return!_.some(clients,function(cl){return cl.mac==el.mac})}).value()),data[193]&&(leasesv6=_.chain(data[193]).map(function(el){return el.mac=el.MACAddress&&el.MACAddress.toLowerCase(),el}).filter(function(el){return!_.some(clients,function(cl){return cl.mac==el.mac})}).value()),deferred.resolve({clients:_.union(clients,wifi,macfilter,leasesv4,leasesv6)}),void 0):error()},error),deferred.promise)}var promise,is=funcs.is,isLoading=!1;return{pull:pull,formClientsInfo:function(clients,clientType,iface,band){var curentBand,bandArray;return band&&(curentBand=1==band?"2.4 GHz":"5 GHz",bandArray=[]),_.chain(clients).sortBy(function(el){return is.ipv4(el.ip)?-1:1}).map(function(item){return band&&_.has(item,"band")&&bandArray.push({mac:item.mac.toUpperCase(),band:item.band}),item}).uniq(!1,function(el){return"mac"==clientType?el.mac.toUpperCase():el.ip}).map(function(elem){var obj={};switch(band&&(elem.band=_.findWhere(bandArray,{mac:elem.mac.toUpperCase()}).band),clientType){case"mac":band&&elem.band==curentBand?(obj.value=elem.mac.toUpperCase(),obj.title=elem.mac.toUpperCase(),obj.subtitle=elem.ip):band||(obj.value=elem.mac.toUpperCase(),obj.title=elem.mac.toUpperCase(),obj.subtitle=elem.ip);break;default:obj.value=elem.ip,obj.title=elem.ip,obj.subtitle=elem.mac}return elem.hostname&&(obj.subtitle=punycode.toUnicode(elem.hostname)+" / "+obj.subtitle),obj}).filter(function(elem){return _.has(elem,"value")}).value()},prepareClientsList:function(clients,version,direction,exclude,filterFn){function isWifiClient(elem){return"WLAN"===elem.name}function excludeRule(rule){function compare(rule,compareRule){return _.every(rule,function(value,name){return compareRule[name]==value})}return _.some(exclude,function(elem){return compare(elem,rule)})}return _.filter(clients,function(elem){return excludeRule(elem)?!1:filterFn&&!filterFn(elem)?!1:("wifi"!=direction||isWifiClient(elem))&&("ipv4"!=version||is.ipv4(elem.ip))&&("ipv6"!=version||is.ipv6(elem.ip))?!0:!1})},findClient:function(knownClients,addr,type){return"ip"==type?_.findWhere(knownClients,{ip:addr}):_.findWhere(knownClients,{mac:addr})},getHostname:function(client){return client.hostname}}}])}();
;"use strict";angular.module(regdep("app.views"),[]).constant("views",{home:{"":"home","wifi_mac_filter@home":"wifiMacFilter"},wanInfo:{"":"wanInfo","connections@info":"wanInfoConnections","connections_simple@info":"wanSimpleConnections","gwif@info":"wanInfoGwif"},wanAdd:{"":"wanAdd","header@add":"wanHeader","content@add":"wanContent"},wanEdit:{"":"wanEdit","header@edit":"wanHeader","content@edit":"wanContent"},wanDynip:{general:"wanGeneral",media:"wanMedia",connection:"wanDynIPv4oE",auth8012x:"wanAuth8012x",kabinet:"wanAuthKabinet",flags:"wanFlags",vlan:"wanVlan"},wanStatip:{general:"wanGeneral",media:"wanMedia",connection:"wanStatIPv4oE",auth8012x:"wanAuth8012x",kabinet:"wanAuthKabinet",flags:"wanFlags",vlan:"wanVlan"},wanIpv4oa:{general:"wanGeneral",media:"wanMedia",connection:"wanStatIPv4oE",flags:"wanFlags"},wanDynipv6:{general:"wanGeneral",media:"wanMedia",connection:"wanDynIPv6oE",flags:"wanFlags",vlan:"wanVlan"},wanStatipv6:{general:"wanGeneral",media:"wanMedia",connection:"wanStatIPv6oE",flags:"wanFlags",vlan:"wanVlan"},wanPpp:{general:"wanGeneral",media:"wanMedia",connection:"wanPPP",authl2tp:"wanAuthL2TP",flags:"wanFlags",vlan:"wanVlan"},wanLte:{general:"wanGeneral",media:"wanUsbModem",connection:"wanDynIPv4oE",health_check:"wanHealthCheck",flags:"wanFlags"},wan3g:{general:"wanGeneral",media:"wanUsbModem",connection:"wanPPP",flags:"wanFlags"},wanUsb:{general:"wanGeneral",media:"wanUsb",flags:"wanFlags",health_check:"wanHealthCheck"},wanBridge:{general:"wanGeneral",media:"wanMedia",vlan:"wanVlan"},wanIpoedual:{general:"wanGeneral",media:"wanMedia",addition:"wanDynIPv4oE",connection:"wanDynIPv6oE",flags:"wanFlags",vlan:"wanVlan"},wanL2TPv3:{general:"wanGeneral",connection:"wanL2TPv3"},wifiClient:{"":"wifiClient","table@client":"wifiClientTable"},wifiChannelmgm:{"":"wifiChannelMgm","table@workload":"wifiWorkloadTable"}});
;"use strict";angular.module(regdep("app.navigation"),["app.views"]).factory("navigation",function(views){var navigation={home:{menu:{name:"apps_hq_admin_nav_home",desc:"navSummaryDesc",sref:"home",icon:"home",openPage:!0},page:views.home,url:"/home",title:"apps_hq_admin_nav_home"},settings:{menu:{name:"apps_hq_admin_nav_settings",desc:"navSettingsDesc",sref:"settings.wan.info",icon:"settings",isGroup:!0},url:"/settings",title:"apps_hq_admin_nav_settings"},"settings.wizard":{menu:{name:"apps_hq_admin_nav_wizard",desc:"navSettingsWizardDesc",sref:"settings.wizard"},external:!0,url:"/wizard/index-wizard.html",title:"apps_hq_admin_nav_wizard",page:"wizard"},"settings.internet":{menu:{name:"apps_hq_admin_nav_settings_internet",isGroup:!0},hideInAPMode:!0,url:"/internet",title:"apps_hq_admin_nav_settings_internet"},"settings.internet.wan":{menu:{name:"WAN",desc:"wan_nav_desc",sref:"settings.internet.wan.info"},hideInAPMode:!0,title:"WAN",url:"/wan",page:"wanCore",params:{concatParams:"/"}},"settings.internet.wan.info":{url:"/info",page:views.wanInfo,title:"WAN"},"settings.internet.wan.connection":{url:"/connection",page:"wanConnection"},"settings.internet.wan.connection.add":{page:views.wanAdd,url:"/add",title:"WAN/act_adding",params:{concatParams:"/"}},"settings.internet.wan.connection.add.dynip":{page:views.wanDynip,params:{type:null,actualType:null}},"settings.internet.wan.connection.add.statip":{page:views.wanStatip,params:{type:null,actualType:null}},"settings.internet.wan.connection.add.ipv4oa":{page:views.wanIpv4oa,params:{type:null,actualType:null}},"settings.internet.wan.connection.add.dynipv6":{page:views.wanDynipv6,params:{type:null,actualType:null}},"settings.internet.wan.connection.add.statipv6":{page:views.wanStatipv6,params:{type:null,actualType:null}},"settings.internet.wan.connection.add.ppp":{page:views.wanPpp,params:{type:null,actualType:null}},"settings.internet.wan.connection.add.lte":{page:views.wanLte,params:{type:null,actualType:null}},"settings.internet.wan.connection.add.3g":{page:views.wan3g,params:{type:null,actualType:null}},"settings.internet.wan.connection.add.bridge":{page:views.wan3g,params:{type:null,actualType:null}},"settings.internet.wan.connection.edit":{page:views.wanEdit,url:"/edit?type&inx",title:"WAN/act_editing",params:{concatParams:"/"}},"settings.internet.wan.connection.edit.dynip":{page:views.wanDynip},"settings.internet.wan.connection.edit.statip":{page:views.wanStatip},"settings.internet.wan.connection.edit.ipv4oa":{page:views.wanIpv4oa},"settings.internet.wan.connection.edit.dynipv6":{page:views.wanDynipv6},"settings.internet.wan.connection.edit.statipv6":{page:views.wanStatipv6},"settings.internet.wan.connection.edit.ppp":{page:views.wanPpp},"settings.internet.wan.connection.edit.lte":{page:views.wanLte},"settings.internet.wan.connection.edit.3g":{page:views.wan3g},"settings.internet.wan.connection.edit.bridge":{page:views.wanBridge},"settings.internet.vlan":{menu:{name:"vlan_nav",desc:"navAdvancedVLANDesc",sref:"settings.internet.vlan.list"},hideInAPMode:!0,title:"navVLAN",url:"/vlan",page:"vlan"},"settings.internet.vlan.list":{page:"vlanList",url:"/list",title:"vlan_nav"},"settings.internet.vlan.add":{page:"vlanForm",url:"/add",title:"vlan_nav_add"},"settings.internet.vlan.edit":{page:"vlanForm",url:"/edit?inx",title:"vlan_nav_edit"},"settings.internet.dns":{menu:{name:"dns_nav",desc:"dns_nav_desc",sref:"settings.internet.dns"},page:"dns",title:"dns_nav",url:"/dns"},"settings.wanFailover":{menu:{name:"wanreserv_nav_failover",desc:"navNetworkWANFailoverDesc",sref:"settings.wanFailover"},hideInAPMode:!0,page:"wanReserv",url:"/wanreserv",title:"wanreserv_nav_failover"},"settings.wifi":{menu:{name:"wifi_nav_desc",desc:"wifi_nav_desc",sref:"settings.wifi.common",isTabsBar:!0},url:"/wifi"},"settings.wifi.common":{hidden:!0,menu:{name:"wifi_nav_desc",desc:"wifi_nav_desc",sref:"settings.wifi.common"},page:"wifiCommon",title:"wifi_nav_desc",url:"/common?freq"},"settings.wifi.ap":{hidden:!0,url:"/ap"},"settings.wifi.ap.add":{page:"wifiAP",url:"/add?freq",title:"wifi_nav_add_ap"},"settings.wifi.ap.edit":{page:"wifiAP",url:"/edit?freq&inx",title:"wifi_nav_edit_ap"},"settings.lan":{menu:{name:"apps_hq_admin_nav_lan",desc:"lan_nav_desc",sref:"settings.lan"},title:"apps_hq_admin_nav_lan",url:"/lan",page:"lan"},"settings.lanInterface":{hidden:!0,url:"/lanInterface"},"settings.lanInterface.add":{page:"lanInterface",url:"/add?inx&ipversion",title:"act_adding_of",params:{langParams:{name:"LAN",abr:"name"}}},"settings.lanInterface.edit":{page:"lanInterface",url:"/edit?inx&ipversion",title:"act_editing_of",params:{langParams:{name:"LAN",abr:"name"}}},"settings.usbmodem":{menu:{name:"usb_modem_nav",sref:"settings.usbmodem.basic",isGroup:!0,isTabsBar:!1},url:"/usbmodem",title:"usb_modem_nav"},"settings.usbmodem.basic":{menu:{name:"usb_modem_basic_nav",sref:"settings.usbmodem.basic"},url:"/basic",title:"usb_modem_basic_nav",page:"usbmodemBasic"},"settings.usbmodem.pin":{menu:{name:"usb_modem_pin_nav",sref:"settings.usbmodem.pin"},url:"/pin",title:"usb_modem_pin_nav",page:"usbmodemPIN"},"settings.usbmodem.sms":{menu:{name:"usb_modem_sms_nav",sref:"settings.usbmodem.sms"},url:"/sms",title:"usb_modem_sms_nav",page:"usbmodemSMS"},"settings.usbmodem.ussd":{menu:{name:"usb_modem_ussd_nav",sref:"settings.usbmodem.ussd"},url:"/ussd",title:"usb_modem_ussd_nav",page:"usbmodemUssd"},"function":{menu:{name:"apps_hq_admin_nav_functions",decs:"navFunctionsDesc",icon:"features"},url:"/functions",title:"apps_hq_admin_nav_functions"},"function.firewallHeader":{menu:{name:"firewall_nav",isGroup:!0,isTabsBar:!1},url:"/firewall",title:"firewall_nav"},"function.firewallHeader.ipfilter":{menu:{name:"ipflt_nav",sref:"function.firewallHeader.ipfilter.info"},title:"ipflt_nav",url:"/ipfilter",hideInAPMode:!0},"function.firewallHeader.ipfilter.info":{url:"/info",page:"ipfilterInfo",title:"ipflt_nav"},"function.firewallHeader.ipfilter.add":{url:"/add",title:"ipflt_nav/act_adding",page:"ipfilterRule",params:{concatParams:"/"}},"function.firewallHeader.ipfilter.edit":{url:"/edit?inx",title:"ipflt_nav/act_editing",page:"ipfilterRule",params:{concatParams:"/"}},"function.firewallHeader.dmz":{menu:{name:"DMZ",sref:"function.firewallHeader.dmz"},title:"DMZ",page:"dmz",url:"/dmz",hideInAPMode:!0},"function.firewallHeader.macfilter":{menu:{name:"macflt_nav",desc:"navMacFilterDesc",sref:"function.firewallHeader.macfilter"},page:"macfilter",title:"macflt_nav",url:"/macfilter"},"function.firewallHeader.urlfilter":{menu:{name:"apps_hq_admin_nav_func_url_filter",desc:"navUrlfilterDesc",sref:"function.firewallHeader.urlfilter"},url:"/urlfilter",title:"apps_hq_admin_nav_func_url_filter",page:"urlfilter",hideInAPMode:!0},"function.firewallHeader.dos_settings":{menu:{name:"dosflt_nav",desc:"navDosSettingsDesc",sref:"function.firewallHeader.dos_settings"},page:"dos_settings",title:"dosflt_nav",url:"/dos"},"function.wifiHeader":{menu:{name:"wifi",isGroup:!0},url:"/wifi",title:"wifi"},"function.wifiHeader.wifi_clientmgm":{menu:{name:"wifi_client_mgm_nav",desc:"wifi_client_mgm_nav_desc",sref:"function.wifiHeader.wifi_clientmgm"},page:"wifiClientMgm",title:"wifi_client_mgm_nav",url:"/clientmgm"},"function.wifiHeader.wps":{menu:{name:"wifi_wps_nav",desc:"wifi_wps_nav_desc",sref:"function.wifiHeader.wps",isTabsBar:!0},title:"wifi_wps_nav",url:"/wps?freq",page:"wifiWps"},"function.wifiHeader.wmm":{menu:{name:"wifi_wmm_nav",desc:"wifi_wmm_nav_desc",sref:"function.wifiHeader.wmm"},title:"wifi_wmm_nav",page:"wifiWMM",url:"/wmm"},"function.wifiHeader.client":{menu:{name:"wifi_client_nav",desc:"wifi_client_nav_desc",sref:"function.wifiHeader.client"},title:"wifi_client_nav",page:views.wifiClient,url:"/client?freq"},"function.wifiHeader.clientshaping":{menu:{name:"wifi_client_shaping_nav",desc:"navWIFIClientShapingDesc",sref:"function.wifiHeader.clientshaping"},page:"wifiClientShaping",title:"wifi_client_shaping_nav",url:"/clientshaping"},"function.wifiHeader.adv":{menu:{name:"wifi_advanced_nav",desc:"wifi_advanced_nav_desc",sref:"function.wifiHeader.adv",isTabsBar:!0},title:"wifi_advanced_nav",url:"/adv?freq",page:"wifiAdv"},"function.wifiHeader.wifiMac":{menu:{name:"wifi_mac_nav",desc:"navWIFIMacDesc",sref:"function.wifiHeader.wifiMac"},page:"wifiMac",title:"wifi_mac_nav",url:"/wifiMac"},"function.wifiHeader.roaming":{menu:{name:"wifi_roaming_nav",desc:"navWIFIRoamingDesc",sref:"function.wifiHeader.roaming"},page:"wifiRoaming",title:"wifi_roaming_nav",url:"/wifiRoaming"},"function.advancedHeader":{menu:{name:"advanced_nav",isGroup:!0},url:"/advanced",title:"advanced_nav"},"function.advancedHeader.dns":{menu:{name:"dns_nav",desc:"dns_nav_desc",sref:"function.advancedHeader.dns"},hideInRouterMode:!0,page:"dns",title:"dns_nav",url:"/dns"},"function.advancedHeader.qos_sw":{menu:{name:"apps_hq_admin_nav_func_qos",sref:"function.advancedHeader.qos_sw.info",isTabsBar:!0},hideInAPMode:!0,title:"apps_hq_admin_nav_func_qos",url:"/qos"},"function.advancedHeader.qos_sw.info":{url:"/info",title:"QoS",page:"qosSwInfo"},"function.advancedHeader.qos_sw.add":{url:"/add",title:"QoS/act_adding",page:"qosSwRule",params:{concatParams:"/"}},"function.advancedHeader.qos_sw.edit":{url:"/edit?type&id",title:"QoS/act_editing",page:"qosSwRule",params:{concatParams:"/"}},"function.advancedHeader.snmp":{menu:{name:"snmp_nav",sref:"function.advancedHeader.snmp"},page:"snmp",title:"snmp_nav",url:"/snmp"},"function.advancedHeader.upnp":{menu:{name:"upnp_nav",sref:"function.advancedHeader.upnp"},page:"upnp",url:"/upnp",title:"upnp_nav",hideInAPMode:!0},"function.advancedHeader.raccess":{menu:{name:"raccess_nav",desc:"navFunctionPortRaccessDesc",sref:"function.advancedHeader.raccess"},url:"/raccess",title:"raccess_nav",page:"raccess",hideInAPMode:!0},"function.advancedHeader.vservers":{menu:{name:"vservers_nav",desc:"vservers_nav_desc",sref:"function.advancedHeader.vservers.info"},hideInAPMode:!0,title:"vservers_nav",url:"/vservers"},"function.advancedHeader.vservers.info":{url:"/url",page:"vserversInfo",title:"vservers_nav"},"function.advancedHeader.vservers.add":{url:"/add",title:"vservers_nav_add",page:"vserversRule"},"function.advancedHeader.vservers.edit":{url:"/edit?inx",title:"vservers_nav_edit",page:"vserversRule"},"function.advancedHeader.tr69":{menu:{name:"tr69_nav",desc:"tr69_nav_desc",sref:"function.advancedHeader.tr69"},hideInAPMode:!0,page:"tr69",title:"tr69_nav",url:"/tr69"},"function.advancedHeader.routing":{menu:{name:"apps_hq_admin_nav_func_stat_routing",desc:"navFunctionRoutingDesc",sref:"function.advancedHeader.routing"},url:"/routing",title:"apps_hq_admin_nav_func_stat_routing",page:"routing"},"function.advancedHeader.dinamic_dns":{menu:{name:"apps_hq_admin_nav_dns",desc:"navFunctionsDnsDesc",sref:"function.advancedHeader.dinamic_dns.info"},url:"/dinamic_dns",title:"apps_hq_admin_nav_dns"},"function.advancedHeader.dinamic_dns.info":{url:"/info",title:"apps_hq_admin_nav_dns",page:"ddnsInfo"},"function.advancedHeader.dinamic_dns.add":{url:"/add",title:"act_adding_of",page:"ddnsRule",params:{langParams:{name:"DDNS",abr:"name"}}},"function.advancedHeader.dinamic_dns.edit":{url:"/edit?inx",title:"act_editing_of",page:"ddnsRule",params:{langParams:{name:"DDNS",abr:"name"}}},"function.advancedHeader.bandwidth":{menu:{name:"bandwidth_nav",desc:"navBandwidthControlDesc",sref:"function.advancedHeader.bandwidth"},page:"bandwidth_control",title:"bandwidth_nav",url:"/bandwidth_control"},"function.advancedHeader.ipsec":{menu:{name:"IPsec",sref:"function.advancedHeader.ipsec.info"},hideInAPMode:!0,title:"IPsec",url:"/ipsec"},"function.advancedHeader.ipsec.info":{url:"/info",title:"IPsec",page:"ipsecInfo"},"function.advancedHeader.ipsec.add":{url:"/add",title:"IPsec/act_adding",page:"ipsecRule",params:{concatParams:"/"}},"function.advancedHeader.ipsec.edit":{url:"/edit?inx",title:"IPsec/act_editing",page:"ipsecRule",params:{concatParams:"/"}},"function.advancedHeader.portsSettings":{menu:{name:"portctrl_nav",desc:"portctrl_nav_desc",sref:"function.advancedHeader.portsSettings"},page:"ports",title:"portctrl_nav",url:"/portsSettings"},"function.advancedHeader.redirect":{menu:{name:"redirect_nav",desc:"navAdvancedRedirectDesc",sref:"function.advancedHeader.redirect"},page:"redirect",title:"redirect_nav",url:"/redirect",hideInAPMode:!0},"function.advancedHeader.udpxy":{menu:{name:"udpxy_nav",desc:"udpxy_nav_desc",sref:"function.advancedHeader.udpxy"},page:"udpxy",url:"/udpxy",title:"udpxy_nav",hideInAPMode:!0},"function.advancedHeader.igmp":{menu:{name:"igmp_nav",desc:"igmp_nav_desc",sref:"function.advancedHeader.igmp"},hideInAPMode:!0,page:"igmp",title:"igmp_nav",url:"/igmp"},"function.advancedHeader.misc":{menu:{name:"miscel_nav",desc:"miscel_nav_desc",sref:"function.advancedHeader.misc"},page:"misc",title:"miscel_nav",url:"/misc",hideInAPMode:!0},"function.advancedHeader.quick_vpn":{menu:{name:"openvpn_nav",desc:"navFunctionVpnDesc",sref:"function.advancedHeader.quick_vpn.status",openPage:!0,isTabsBar:!0},url:"/quick_vpn",title:"openvpn_nav"},"function.advancedHeader.quick_vpn.status":{menu:{name:"status",desc:"navFunctionVpnStatusDesc",sref:"function.advancedHeader.quick_vpn.status"},url:"/status",title:"status",page:"openVpnStatus"},"function.advancedHeader.quick_vpn.settings":{menu:{name:"settings",desc:"navFunctionVpnSettingsDesc",sref:"function.advancedHeader.quick_vpn.settings"},url:"/settings",title:"settings",page:"openVpnSettings"},"function.advancedHeader.quick_vpn.keys":{menu:{name:"openvpn_keys_nav",desc:"navFunctionVpnKeysDesc",sref:"function.advancedHeader.quick_vpn.keys"},url:"/keys",title:"openvpn_keys_nav",page:"openVpnKeys"},control:{menu:{name:"apps_hq_admin_nav_control",desc:"navControlDesc",icon:"management"},url:"/control",title:"apps_hq_admin_nav_control"},"control.ntp":{menu:{name:"ntp_nav",desc:"navControlNtpDesc",sref:"control.ntp"},url:"/ntp",title:"ntp_nav",page:"ntp"},"control.syslog":{menu:{name:"apps_hq_admin_nav_control_syslog",desc:"navControlSyslogDesc",sref:"control.syslog"},title:"apps_hq_admin_nav_control_syslog",url:"/syslog",page:"syslog"},"control.admin":{menu:{name:"apps_hq_admin_nav_control_admin",desc:"navControlAdminDesc",sref:"control.admin"},url:"/admin",title:"apps_hq_admin_nav_control_admin",page:"sysConfig"},"control.telnet":{menu:{name:"telnet_nav",desc:"navSystemTelnetDesc",sref:"control.telnet"},page:"telnet",title:"telnet_nav",url:"/telnet"},"control.device":{menu:{name:"apps_hq_admin_nav_control_device",desc:"navControlDeviceDesc",sref:"control.device.settings",isGroup:!0,isTabsBar:!1},url:"/device",title:"apps_hq_admin_nav_control_device",hideInAPMode:!0},"control.device.settings":{menu:{name:"settings",sref:"control.device.settings"},url:"/settings",title:"settings",page:"yandexDnsSettings"},"control.device.rules":{menu:{name:"yadns_nav_devices",sref:"control.device.rules"},url:"/rules",title:"yadns_nav_devices",page:"yandexDnsRules"},"control.firmware":{menu:{name:"firmware_nav",desc:"navControlFirmwareDesc",sref:"control.firmware"},url:"/firmware",title:"firmware_nav",page:"firmware"},"control.stats":{menu:{name:"stats_nav",desc:"navControlsStatDesc",isGroup:!0},url:"/stats",title:"stats_nav"},"control.stats.network":{menu:{name:"stats_nav_desc",desc:"navControlsStatDesc",sref:"control.stats.network"},url:"/network",title:"stats_nav_desc",page:"statsNetwork"},"control.stats.ports":{menu:{name:"stats_ports_nav",desc:"navStatsPortsDesc",sref:"control.stats.ports"},url:"/ports",title:"stats_ports_nav",page:"statsPorts"},"control.stats.portDetails":{url:"/ports/{portAlias:LAN1|LAN2|LAN3|LAN4|WAN|lan1|lan2|lan3|lan4|wan}",title:"stats_ports_nav_desc",page:"statsPortDetails",hidden:!0},"control.stats.routing":{menu:{name:"stats_routing_nav",desc:"stats_routing_nav_desc",sref:"control.stats.routing"},hideInAPMode:!0,url:"/routing",title:"stats_routing_nav",page:"statsRouting"},"control.stats.sessions":{menu:{name:"stats_sessions_nav",desc:"stats_sessions_nav_desc",sref:"control.stats.sessions"},hideInAPMode:!0,url:"/sessions",title:"stats_sessions_nav",page:"statsSessions"},"control.stats.dhcp":{menu:{name:"stats_dhcp_nav",desc:"stats_dhcp_nav_desc",sref:"control.stats.dhcp"},url:"/dhcp",title:"stats_dhcp_nav",page:"statsDhcp"},"control.stats.clients":{menu:{name:"stats_clients_nav",desc:"stats_clients_nav_desc",sref:"control.stats.clients"},url:"/clients",title:"stats_clients_nav",page:"statsClients"},"control.stats.igmp":{menu:{name:"stats_igmp_nav",desc:"stats_igmp_nav_desc",sref:"control.stats.igmp"},url:"/igmp",title:"stats_igmp_nav",page:"statsIgmp"},"control.diag":{menu:{name:"apps_hq_admin_nav_diag",desc:"navControlsStatDesc",isGroup:!0,isTabsBar:!1},url:"/diag",title:"apps_hq_admin_nav_diag"},"control.diag.ping":{menu:{name:"ping_nav",desc:"navControlsStatDesc",sref:"control.diag.ping"},url:"/ping",title:"ping_nav",page:"ping"},"control.diag.trace":{menu:{name:"traceroute_nav",desc:"navControlsStatDesc",sref:"control.diag.trace"},url:"/trace",title:"traceroute_nav",page:"traceroute"},error:{page:"error",params:{code:null,message:null}},notice:{page:"notice",url:"/notice",title:"notifications_nav"}};return navigation});
;"use strict";!function(){var m=angular.module(regdep("navigation-filter"),["app.page-details"]);m.service("navigationFilter",["navigation","pageDetails","funcs",function(navigation,pageDetails,funcs){function getRulesDummy(){var rules={};return _.each(pageDetails,function(pages,pageKey){_.each(pages,function(page){_.each(page.features,function(feature,featureKey){funcs.setValue("pages."+pageKey+"."+featureKey,{hide:!1},rules)})})}),rules}var _filters=[],_rules=[];return{addRules:function(cb){_rules.push(cb)},rules:function(){var composeRules,dummy=getRulesDummy();return _rules.length?(composeRules=_.compose.apply(null,_rules))(dummy):dummy},addFilter:function(cb){_filters.push(cb)},filter:function(){var composeFilter;return _filters.length?(composeFilter=_.compose.apply(null,_filters))(navigation):navigation}}}])}();
;"use strict";!function(){angular.module(regdep("navfilters-generic"),[]).run(["navigationFilter","cookie",function(nfilter,cookie){nfilter.addFilter(function(navs){var deviceMode=cookie.get("device_mode"),exclude=[];return"ap"===deviceMode?_.each(navs,function(state,name){state.hideInAPMode&&exclude.push(name)}):"Firewall"==deviceMode?_.each(navs,function(state,name){state.hideInFirewallMode&&exclude.push(name)}):_.each(navs,function(state,name){state.hideInRouterMode&&exclude.push(name)}),_.omit(navs,exclude)})}])}();
;"use strict";!function(){var modname="menu-list";window.appDeps.push(modname);var menuList=angular.module(modname,[]);menuList.value("menus",[]),menuList.run(["menus",function(menus){menus.push("home"),menus.push("settings"),menus.push("function"),menus.push("control")}]),menuList.factory("menuFuncs",["menus","translate",function(menus,translate){function makeSubMenuList(navs,parent,pageList){function isPage(menuItem){var pageExists=!1;return _.isString(menuItem.page)?pageExists=!!pageList[menuItem.page]:_.isObject(menuItem.page)&&(pageExists=!!pageList[menuItem.page[""]]),pageExists}function hasPage(menuItem,menuId){var arr;return isPage(menuItem)||menuItem.external?!0:(arr=_.filter(navs,function(elem,key){return key.indexOf(menuId+".")>-1}),_.find(arr,function(elem){return isPage(elem)}))}return _.chain(navs).map(function(elem,id){var submenu,needTabsBar,arr=[],spliter=id.lastIndexOf(".");return-1!=spliter&&(arr[0]=id.substring(0,spliter),arr[1]=id.substring(spliter+1)),elem.menu?hasPage(elem,id)&&arr[0]==parent&&!elem.hidden?(submenu=makeSubMenuList(navs,id,pageList)||[],1==submenu.length?(submenu[0].name=elem.menu.name,_.extend({},submenu[0])):(needTabsBar=elem.menu.isGroup&&_.isUndefined(elem.menu.isTabsBar)&&2==submenu.length,_.extend({},elem.menu,{id:id,sref:elem.menu.sref,external:elem.external,url:elem.url,state:elem,submenu:submenu,isGroup:!needTabsBar&&elem.menu.isGroup,isTabsBar:needTabsBar||elem.menu.isTabsBar}))):null:elem.delimiter&&arr[0]==parent&&2==arr.length&&!elem.hidden?_.extend({},{name:elem.name,delimiter:!0}):null}).filter(function(elem){return elem}).value()}function updateNavs($scope){var sep,i,domBackRect,domTitleRect,navs=linkNavs,domBack=document.querySelector("#back_anchor"),domIcon=document.querySelector("#icon-anchor"),domTitle=document.querySelector("#title-anchor"),domTitleMobile=document.querySelector("#title_anchor_mobile"),domDescript=document.querySelector("#descript-anchor"),backState=$scope.backState(),scopeState=$scope.state();if(scopeState){if(domBack)if($scope.backState()){if($scope.backState().params&&!$scope.backState().params.concatParams&&(domBack.innerHTML=$scope.backState().params&&$scope.backState().params.langParams?translate($scope.backState().title,$scope.backState().params.langParams):translate($scope.backState().title)),$scope.backState().params&&$scope.backState().params.concatParams){var sep=$scope.backState().params.concatParams;domBack.innerHTML=scope.backState().title.split(sep)[1]?translate($scope.backState().title.split(sep)[0])+sep+translate($scope.backState().title.split(sep)[1]):translate($scope.backState().title.split(sep)[0])}}else domBack.innerHTML="";var info="undefined"==typeof info_text?{}:getInfoText(scopeState.name);if(!_.isEmpty(info)){if(domTitle&&scopeState&&(scopeState.params&&!scopeState.params.concatParams&&(domTitle.innerHTML=scopeState.params&&scopeState.params.langParams?translate(scopeState.title,scopeState.params.langParams):translate(scopeState.title)),scopeState.params&&scopeState.params.concatParams)){var sep=scopeState.params.concatParams;domTitle.innerHTML=scopeState.title.split(sep)[1]?translate(scopeState.title.split(sep)[0])+sep+translate(scopeState.title.split(sep)[1]):translate(scopeState.title.split(sep)[0])}if(domTitleMobile&&scopeState&&(scopeState.params&&!scopeState.params.concatParams&&(domTitleMobile.innerHTML=scopeState.params&&scopeState.params.langParams?translate(scopeState.title,scopeState.params.langParams):translate(scopeState.title)),scopeState.params&&scopeState.params.concatParams)){var sep=scopeState.params.concatParams;domTitleMobile.innerHTML=scopeState.title.split(sep)[1]?translate(scopeState.title.split(sep)[0])+sep+translate(scopeState.title.split(sep)[1]):translate(scopeState.title.split(sep)[0])}domDescript&&(domDescript.innerHTML=translate(info.descript)||""),domIcon&&domIcon.setAttribute("src",info.image||"")}var pathPage=scopeState.name.split("."),concatPath="",strPathPage="";for(i=0;i<pathPage.length;i++)concatPath.length>1&&(concatPath+="."),concatPath+=pathPage[i],(4!=pathPage.length||2!=i)&&void 0!=navs[concatPath].title&&(strPathPage.length>1&&(strPathPage+=" >> "),navs[concatPath].params&&!navs[concatPath].params.concatParams&&(strPathPage+=translate(navs[concatPath].title,navs[concatPath].params.langParams)),navs[concatPath].params&&navs[concatPath].params.concatParams&&(sep=navs[concatPath].params.concatParams,strPathPage+=navs[concatPath].title.split(sep)[1]?translate(navs[concatPath].title.split(sep)[0])+sep+translate(navs[concatPath].title.split(sep)[1]):translate(navs[concatPath].title.split(sep)[0])),navs[concatPath].params||(strPathPage+=translate(navs[concatPath].title)));var domPathPage=document.querySelector("#path-page");domPathPage&&(domPathPage.innerHTML=strPathPage),domBack&&domTitle&&(domBackRect=domBack.getBoundingClientRect(),domTitleRect=domTitle.getBoundingClientRect(),domBackRect.right+20>domTitleRect.left?angular.element(domBack).css("visibility","hidden"):angular.element(domBack).css("visibility","visible")),backState?angular.element(domIcon).css("visibility","visible"):(angular.element(domBack).css("visibility","hidden"),angular.element(domIcon).css("visibility","hidden"))}}function getInfoText(name){if(!info_text||!name)return{};var nameArr=name.split("."),parent=_.initial(nameArr).join("."),current=_.last(nameArr);return info_text[name]||info_text[current]||getInfoText(parent)}function makeTabsList(menu,state){function getTabs(menu,namePage){var current,parent=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",tabs=[];return namePage&&namePage.length&&(current=parent+_.first(namePage),_.each(menu,function(item){item.id==current&&(tabs=item.isTabsBar?item.submenu:getTabs(item.submenu,_.rest(namePage),current+"."))})),tabs}var namePage=state.name.split(".");return getTabs(menu,namePage)}var linkNavs;return{makeMenuList:function(navs,pageList){return linkNavs=navs,_.chain(menus).filter(function(elem){return navs[elem]}).map(function(elem){return _.extend({},navs[elem].menu,{id:elem,sref:navs[elem].menu.sref,submenu:makeSubMenuList(navs,elem,pageList)})}).filter(function(elem){return navs[elem.id].page||elem.submenu.length}).value()},updateNavs:updateNavs,selectSecondLevelMenu:function($scope,$state,menu){return $state.current.name==menu.id&&$state.reload(),menu.isGroup?($scope.showGroup=$scope.showGroup==menu.id?"":menu.id,0):($scope.tabsList=makeTabsList($scope.menuList,$state.current),1)},selectSubMenu:function($scope,menu,event,mousemove){$scope.selectedSubMenu=$scope.selectedSubMenu!=menu.id?menu.id:void 0,menu.external&&(location.href=menu.url),menu.openPage&&!mousemove&&($state.go(menu.sref,null,{reload:!0}),$scope.collapseMobileMenu())},makeTabsList:makeTabsList}}])}();
;"use strict";angular.module(regdep("app.page-details"),["app.config","app.navigation"]).factory("pageDetails",["navigation","pageList",function(navigation,pageList){function getUrl(state){var ancs=getStateAncestors(state),parts=[];for(var s in ancs)parts.push(navigation[ancs[s]].url);return"#"+parts.join("")}function getMenuPath(state){var menu,ancs=getStateAncestors(state),parts=[];for(var s in ancs)menu=navigation[ancs[s]].menu,menu&&parts.push(menu.name);return parts}function makeInfoObj(state,page){var menu,obj={state:state,url:getUrl(state,"url"),features:page.features};navigation[state].title&&(obj.title=navigation[state].title);var menuState=findMenuState(state);return menuState&&(menu=navigation[menuState].menu,obj.menu={name:menu.name,desc:menu.desc,path:getMenuPath(state),state:menuState}),obj}function findMenuState(state){var i,s,ancs=getStateAncestors(state);for(i=ancs.length-1;i>=0;i--)if(s=navigation[ancs[i]],s.menu&&s.menu.sref==state)return ancs[i];return null}function getStateAncestors(state){var i,ancestors=[],parts=state.split(".");for(i=1;i<=parts.length;i++)ancestors.push(parts.slice(0,i).join("."));return ancestors}var navs,page,obj,defaultView,pages={};for(var pageName in pageList){navs=[],page=pageList[pageName];for(var key in navigation)obj=navigation[key],_.isString(obj.page)?obj.page==pageName&&navs.push(makeInfoObj(key,page)):_.isObject(obj.page)&&(defaultView=obj.page[""],defaultView==pageName&&navs.push(makeInfoObj(key,page)));navs.length&&(pages[pageName]=navs)}return pages}]);
;"use strict";function ChangePassDialogCtrl($scope,changePassword,translate,device,devinfo,$q,navigationFilter,cookie){function pull(){function pullDevinfo(){return devinfo.once("version").then(function(result){$scope.deviceMac=result.deviceMac})}return device.wifi.pullCommon?function(){var deferred=$q.defer();return device.wifi.pullCommon(function(error){error?deferred.reject():deferred.resolve()}),deferred.promise}().then(pullDevinfo):pullDevinfo()}function changePass(){function success(){deferred.resolve()}function error(msg){$scope.passwd.errorMessage=translate(msg),deferred.reject($scope.passwd.errorMessage)}var login,password,deferred=$q.defer();return $scope.needChangePass?(login=cookie.get("user_login")||"admin",password=$scope.passwd.value,changePassword(login,password).then(success,error)):success(),deferred.promise}function saveSsid(){var deferred=$q.defer();return _.keys($scope.ssids).length?(_.each(_.values($scope.ssids),function(ssidConfig){ssidConfig.apply()}),device.wifi.push(function(){deferred.resolve()},!0)):deferred.resolve(),deferred.promise}function formValid(){return $scope.form_change_password.$valid&&(!$scope.needChangePass||$scope.passwd.value.length&&$scope.passwd.confirmValue.length)}var SUPPORT_WIFI_5GHZ=autoconf.BR2_PACKAGE_ANWEB_WIFI_5GHZ;$scope.customRules=navigationFilter.rules()||{},_.extend($scope,{applying:!1,ssids:{},passwd:{value:$scope.customRules.DialogChangePasswordValue||"",change:function(){$scope.passwd.errorMessage=null},confirmValue:$scope.customRules.DialogChangePasswordValue||""},ssid:{},needChangeSSID24:$scope.ngDialogData.needChangeSSID24,needChangeSSID5:$scope.ngDialogData.needChangeSSID5,needChangePass:$scope.ngDialogData.needChangePass,deviceMac:null,save:function(){formValid()&&($scope.applying=!0,changePass().then(saveSsid).then(function(){$scope.closeThisDialog()})["finally"](function(){$scope.applying=!1}))},saveEnabled:function(){return $scope.ngDialogData.needChangePass&&$scope.customRules.DialogChangePasswordValue?formValid():formValid()&&!$scope.applying}}),function(){function SsidConfig(band,name){var config={},ap=function(band){return device.wifi.getBand(0,band+"GHz").ap}(band),base=ap.getBase(),postfix=$scope.deviceMac?$scope.deviceMac.replace(/:/g,"").slice(-4):device.funcs.randomString(4);return config.name=name,config.band=band,config.value=base.SSID+"-"+postfix,config.defaultSSID=angular.copy(base.SSID),config.apply=function(){base.SSID=config.value},config}pull().then(function(){var name=translate("wifi_network_name"),ssid24name=SUPPORT_WIFI_5GHZ?name+" 2.4 "+translate("units_GHz")+" (SSID)":name+" (SSID)";$scope.needChangeSSID24&&($scope.ssids[2.4]=new SsidConfig("2.4",ssid24name)),$scope.needChangeSSID5&&SUPPORT_WIFI_5GHZ&&($scope.ssids[5]=new SsidConfig("5",name+" 5 "+translate("units_GHz")+" (SSID)"))})}(),$scope.validateSSID=function(origin,value){var reCyrill=/[А-яЁё]+/g;return reCyrill.test(value)?"msg_defssid_not_cyrillic_error":value&&value.length?value==origin?"msg_change_pass_ssid_def_error":null:"msg_input_is_empty"},$scope.validatePassword=function(value){var reCyrill=/[А-яЁё]+/g;return reCyrill.test(value)?"msg_password_contains_cirill":"admin"==value?"msg_change_pass_def_error":value&&!/^[\x20-\x7E]+$/g.test(value)?"msg_password_contains_illegal":value.length>31?"msg_invalid_password_length":null},$scope.confirmPasswordValidate=function(value){return value&&value!=$scope.passwd.value?"msg_passwords_not_equal":null}}
;"use strict";function ConfirmDialogCtrl($scope){$scope.cancel=function(){$scope.closeThisDialog(!1)},$scope.confirm=function(){$scope.closeThisDialog(!0)}}ConfirmDialogCtrl.$inject=["$scope"];
;"use strict";function ConfirmDialog3Ctrl($scope,$state){var warnings=$scope.ngDialogData.warnings;$scope.isWanReservWarning=!1,$scope.isVoIPWarning=!1;for(var i in warnings)"wan_reserv"==warnings[i].warning&&($scope.isWanReservWarning=!0),"voip_error"==warnings[i].warning&&($scope.isVoIPWarning=!0);$scope.confirm=function(){return $scope.isWanReservWarning?($state.go("settings.wanFailover"),void $scope.closeThisDialog(!1)):void $scope.closeThisDialog({confirm:!0,isVoIp:$scope.isVoIPWarning})},$scope.cancel=function(){$scope.closeThisDialog(!1)}}ConfirmDialog3Ctrl.$inject=["$scope","$state"];
;"use strict";function DeviceClientsListDialogCtrl($scope,$q,devinfo,funcs,nwClientListUtil,device){function make(list,iface){function addItem(item){var hasFilter=_.some(filterList,function(elem){var subtitle=elem.subtitle.split(" / "),mac=subtitle.length>1?subtitle[1]:subtitle[0];return elem.value==item.ip&&mac==item.mac});hasFilter&&$scope.clients.list.push(item)}var list=nwClientListUtil.prepareClientsList(list,options.ipversion);list=_.filter(list,function(item){return!_.findWhere(usedRules,{IPAddress:item.ip,MACAddress:item.mac?item.mac.toUpperCase():""})});var filterList=nwClientListUtil.formClientsInfo(list,"ip",iface);_.each(filterList,function(data){("ipv4"==options.ipversion&&data.value==staticIp||"ipv6"==options.ipversion&&(funcs.ipv6.address.full(data.value)==funcs.ipv6.address.full(staticIp)||checkLinklocal(data.value)))&&(filterList=_.without(filterList,data))}),_.each(list,addItem)}function checkLinklocal(data){var addr=funcs.ipv6.address.full(data),splitAddr=addr.split(":");return"fe80"==splitAddr[0].toLowerCase()}function clean(){$scope.clients.list.length=0,$scope.clients.selected.length=0}function activate(){$scope.clients.isError=!1,$scope.clients.isLoading=!0;var sourses="ipv6"==options.ipversion?"all leasesv6":"all leasesv4";nwClientListUtil.pull(sourses).then(function(output){clean(),make(output.clients,output.iface),$scope.clients.isLoading=!1},function(){$scope.clients.isLoading=!1,$scope.clients.isError=!0})}var options=$scope.ngDialogData,version="ipv4"==options.ipversion?"IPv4":"IPv6",staticIp=device.lan.data()[1][version].StaticIP[1];staticIp&&(staticIp=staticIp.Address);var iface=device.lan["interface"].getCurrent(),usedRules=iface[options.ipversion].dhcp.staticAddress.list();$scope.clients={isLoading:!0,isError:!1,list:[],selected:[],make:make,clean:clean,apply:function(){var selectedItems=_.pluck($scope.clients.selected,"item");$scope.closeThisDialog(selectedItems)},refresh:function(){activate()},cancel:function(){$scope.closeThisDialog(null)},isEmpty:function(){return 0==$scope.clients.list.length},isSelected:function(){return $scope.clients.selected.length>0},getTitle:function(item){return item.hostname?item.ip?item.ip+" ("+item.hostname+") ":item.hostname:item.ip?item.ip:""}},options.comment&&($scope.clients.comment=options.comment),activate()}
;"use strict";function DHCPOptionsDialogCtrl($scope,funcs,dhcpCustomOpts,translate){var options=$scope.ngDialogData,iface=$scope.device.lan["interface"].getCurrent();$scope.knownOptions=dhcpCustomOpts,$scope.DHCPOption={data:{Option:"",Value:"",Tag:"",Force:!1},tmp:{option:"",tag:"",force:!1},initData:null,instance:void 0,init:function(util,data,instance){this.isNew=data?!1:!0,self=this,this.util=util,void 0!=instance&&(this.instance=instance),this.initData=angular.copy(this.data),this.usedValues=this.util.usedValues(this.instance),$scope.getInitOption=function(){var opt,index;return data?(self.data.Value=data.Value,self.data.Force=data.Force,opt=_.findWhere($scope.knownOptions,{option:$scope.DHCPOption.getOptionName(data.Tag)}),index=_.indexOf($scope.knownOptions,opt),$scope.knownOptions[index]):$scope.knownOptions[0]}},isUsedRule:function(tag){return this.isNew&&_.contains(this.usedValues.Tag,tag)?"msg_error_rule_is_not_uniq":null},validation:function(value,param){function isNumber(data){var patt_number=/(^-?[0-9]+$)/;return patt_number.test(data)?!0:!1}function isAscii(str){return/^[\000-\177]*$/.test(str)}function isHex(data){var patt_hex=/(^(0x)?[0-9a-fA-F]+$)/;return patt_hex.test(data)?!0:!1}value&&(value=value.replace(/(^\s+|\s+$)/g,""));var ipList,i,ipMask,tempArr,temp,elemCount,netPrefix,gw,net,prefix,mask,ipIp,regHostname,domainList,hostList,hexArr,findElem,errors=[];switch(param||value&&errors.push("dhcp_options_not_selected"),value&&value.length>64&&errors.push(translate("msg_maxlength_symb")+" 64"),param){case"mask":value&&!funcs.is.mask(value)&&errors.push("msg_invalid_mask");break;case"ip":value&&!funcs.is.ipv4(value)&&errors.push("msg_invalid_ipv4");break;case"moreIP":if(value){var ipList=value.split(",");ipList.length>_.uniq(ipList).length&&errors.push("dhcp_options_invalid_value");for(var i=0;i<ipList.length;i++)funcs.is.ipv4(ipList[i])||errors.push("dhcp_options_invalid_value")}break;case"moreIPOr0":if(value&&"0"!=value){ipList=value.split(","),ipList.length>_.uniq(ipList).length&&errors.push("dhcp_options_invalid_value");for(var i=0;i<ipList.length;i++)funcs.is.ipv4(ipList[i])||errors.push("dhcp_options_invalid_value")}break;case"ipMask":value&&(ipMask=value.split("/"),(!funcs.is.ipv4(ipMask[0])||!isNumber(ipMask[1])||ipMask[1]<1||ipMask[1]>32)&&errors.push("dhcp_options_invalid_value"));break;case"ipMaskIp":if(value){tempArr=value.split(","),tempArr.length&&tempArr.length%2!=0&&errors.push("dhcp_options_invalid_value"),temp=[],elemCount=0;for(var i=0;i<tempArr.length/2;i++)temp[i]=tempArr[elemCount]+","+tempArr[elemCount+1],elemCount+=2;temp.length>_.uniq(temp).length&&errors.push("dhcp_options_invalid_value");for(var i=0;i<temp.length;i++)netPrefix=temp[i].split(",")[0],gw=temp[i].split(",")[1],net=netPrefix.split("/")[0],prefix=netPrefix.split("/")[1],mask=funcs.ipv4.mask["long"](prefix),netPrefix&&gw||errors.push("dhcp_options_invalid_value"),net&&prefix&&(net!=funcs.ipv4.subnet.getNetworkAddress(net,mask)||!isNumber(prefix)||1>prefix||prefix>32||!funcs.is.ipv4(gw)||gw==funcs.ipv4.subnet.getNetworkAddress(net,mask))&&errors.push("dhcp_options_invalid_value")}break;case"ipIp":value&&(ipIp=value.split(","),funcs.is.ipv4(ipIp[0])&&funcs.is.ipv4(ipIp[1])&&ipIp[0]!=ipIp[1]||errors.push("dhcp_options_invalid_value"));break;case"domain":value&&!funcs.is.hostname(value)&&errors.push("msg_invalid_domain");break;case"hostname":regHostname=/^([a-zA-Zа-яА-Я]([а-яА-Яa-zA-Z0-9\-]{0,62}[а-яА-Яa-zA-Z0-9]){0,1})$/,value=value.replace(/(^\s+|\s+$)/g,""),value&&!regHostname.test(value)&&errors.push("msg_invalid_hostname");break;case"vendor":break;case"moreDomain":if(value){domainList=_.compact(value.split(",")),domainList.length>_.uniq(domainList).length&&errors.push("dhcp_options_invalid_value");for(var i=0;i<domainList.length;i++)funcs.is.domain(domainList[i])||errors.push("dhcp_options_invalid_value")}break;case"moreHost":if(value)for(hostList=_.compact(value.split(",")),hostList.length>_.uniq(hostList).length&&errors.push("dhcp_options_invalid_value"),i=0;i<hostList.length;i++)funcs.is.domain(hostList[i])||funcs.is.ipv4(hostList[i])||errors.push("dhcp_options_invalid_value");break;case"host":!value||funcs.is.domain(value)||funcs.is.ipv4(value)||errors.push("msg_invalid_host");break;case"string":value&&!isAscii(value)&&errors.push("dhcp_options_invalid_value");break;case"hex":value&&(hexArr=value.split(":"),findElem=_.find(hexArr,function(elem){return 2!=elem.length||!isHex(elem)}),void 0!=findElem&&errors.push("dhcp_options_invalid_value"));break;case"bool":value&&"0"!=value&&"1"!=value&&errors.push("dhcp_options_invalid_value");break;case"8unsig":value&&(!isNumber(value)||0>value||value>255)&&errors.push("dhcp_options_invalid_value");break;case"16unsig":value&&(!isNumber(value)||0>value||value>65535)&&errors.push("dhcp_options_invalid_value");break;case"16unsigMin576":value&&(!isNumber(value)||576>value||value>65535)&&errors.push("dhcp_options_invalid_value");break;case"16unsigMin68":value&&(!isNumber(value)||68>value||value>65535)&&errors.push("dhcp_options_invalid_value");break;case"32unsig":value&&(!isNumber(value)||0>value||value>4294967295)&&errors.push("dhcp_options_invalid_value");break;case"32sig":value&&(!isNumber(value)||-2147483648>value||value>2147483647)&&errors.push("dhcp_options_invalid_value");break;case"32sigMin0":value&&(!isNumber(value)||0>value||value>2147483647)&&errors.push("dhcp_options_invalid_value")}return errors.length?errors[0]:null},getOptionName:function(tag){var elem=_.find(dhcpCustomOpts,function(item){return item.tag==tag});return elem?elem.option:""},changeOpt:function(tmp){this.data.Tag=tmp.tag},isChange:function(){return!_.isEqual(this.initData,this.data)}},$scope.DHCPOption.dialog={action:options.action,data:{},onApply:function(){$scope.form.$valid&&(this.data.Value=$scope.DHCPOption.data.Value,this.data.Option=$scope.DHCPOption.tmp.option,this.data.Tag=$scope.DHCPOption.tmp.tag,this.data.Type=$scope.DHCPOption.tmp.type,this.data.Force=$scope.DHCPOption.data.Force,$scope.closeThisDialog({action:this.action,data:this.data,instance:$scope.DHCPOption.instance}))},onCancel:function(){$scope.closeThisDialog(null)}},$scope.DHCPOption.init(iface.ipv4.dhcp.DHCPOption,options.data,options.instance)}
;"use strict";function DHCPServerAddressPoolDialogCtrl($scope){var ranges=$scope.ngDialogData.ranges;$scope.range={value:null,list:[]},function(){_.each(ranges,function(range){$scope.range.list.push({label:range.start+" - "+range.end,value:range})})}(),function(){$scope.range.list,$scope.range.value=$scope.range.list[0].value}(),$scope.dialog={apply:function(){$scope.closeThisDialog($scope.range.value)},cancel:function(){$scope.closeThisDialog(null)}}}
;"use strict";function DHCPStaticAddressDialogCtrl($scope,funcs){var options=$scope.ngDialogData,iface=$scope.device.lan["interface"].getCurrent(),version=$scope.ngDialogData.version,dnsHostsHostnames=function(version){var hosts=iface[version].dns.list(),currentHosts=[],isCurrentIP="ipv4"==version?funcs.is.ipv4:funcs.is.ipv6;return _.each(hosts,function(host){isCurrentIP(host.IPAddress)&&currentHosts.push(host.Hostname)}),currentHosts}(version);$scope.version=version,$scope.staticAddress={data:{IPAddress:"",MACAddress:"",Hostname:"",LeaseTime:""},initData:null,instance:null,init:function(util,data,instance){this.util=util,data&&_.extend(this.data,data),instance&&(this.instance=instance),this.initData=angular.copy(this.data),this.usedValues=this.util.usedValues(this.instance),this.network=$scope.$parent[version].data.StaticIP[1],"ipv4"==version&&(this.subnet=funcs[version].subnet.getNetworkAddress(this.network.Address,this.network.SubnetMask),this.mask=funcs[version].mask["short"](this.network.SubnetMask)),"ipv6"==version&&this.network&&(this.subnet=funcs[version].subnet.getNetworkAddress(this.network.Address,this.network.SubnetMask),this.prefix=this.network.Prefix)},validation:function(value,param){var leasetime,errors=this.util.validation(this.data),usedValues=this.usedValues[param],gatewayAddress=this.network?this.network.Address:void 0;return"IPAddress"==param&&gatewayAddress==value&&errors[param].push("lan_error_ip_address_is_used_as_lan_ip"),_.contains(usedValues,value)&&("IPAddress"==param&&errors[param].push("msg_ip_address_is_used"),"MACAddress"==param&&errors[param].push("msg_mac_address_is_used"),"Hostname"==param&&""!=value&&errors[param].push("msg_error_value_is_not_uniq")),"Hostname"==param&&_.contains(dnsHostsHostnames,value)&&errors[param].push("msg_error_value_is_not_uniq"),"LeaseTime"==param&&(leasetime=value?value.toString():void 0,leasetime&&leasetime.length>8&&errors[param].push("msg_input_lenght_more_max")),errors[param]&&errors[param].length?errors[param][0]:null},warning:function(){var isIncludedToNetwork;return this.network&&(isIncludedToNetwork=this.util.checkForEntryInSubnet(this.data.IPAddress,this.network),!isIncludedToNetwork)?"msg_ip_address_is_not_included_to_network":null},isChange:function(){return!_.isEqual(this.initData,this.data)}},$scope.staticAddress.dialog={action:options.action,onApply:function(){$scope.form.$valid&&$scope.closeThisDialog({action:this.action,data:$scope.staticAddress.data,instance:$scope.staticAddress.instance})},onRemove:function(){$scope.closeThisDialog({action:"remove",instance:$scope.staticAddress.instance})},onCancel:function(){$scope.closeThisDialog(null)}},$scope.staticAddress.init(iface[version].dhcp.staticAddress,options.data,options.instance)}
;"use strict";function LoginDialogCtrl($scope,$interval,nwPasswordService,devinfo,translate){function startBanTimer(banTimeRemain){function formatStr(count){return new Date(1e3*count).toUTCString().match(/\d\d:\d\d:\d\d/)[0]}$scope.fm.banTimeRemainStr=formatStr(banTimeRemain),intervalID=$interval(function(){banTimeRemain--,0>=banTimeRemain?($scope.fm.banTimeRemain=null,$scope.fm.banTimeRemainStr="",$scope.fm.errorMessage="",$interval.cancel(intervalID)):$scope.fm.banTimeRemainStr=formatStr(banTimeRemain)},1e3)}var body=angular.element(document.getElementsByTagName("body")),bodyClass="login_dialog_opened",intervalID=null;$scope.langList=autoconf.__lang_arr||["eng","rus"];var devInfo=devinfo;devInfo.init({need_auth:!1}),devInfo.once("version").then(function(res){$scope.devInfo={},$scope.devInfo.fw_name=res.modelName,$scope.devInfo.hwRevision=res.hwRevision,$scope.devInfo.fw_version=res.version,res.lang&&translate.changeLanguage(res.lang)},function(err){console.log(err)}),$scope.fm={username:"",password:"",tryCountRemain:$scope.ngDialogData.tryCountRemain,clientTryCount:$scope.ngDialogData.clientTryCount,banTimeRemain:$scope.ngDialogData.banTimeRemain,notAuthorized:$scope.ngDialogData.notAuthorized};var banTimeRemain=$scope.ngDialogData.banTimeRemain;banTimeRemain?(startBanTimer(banTimeRemain),$scope.fm.errorMessage="try-count-limit"==$scope.ngDialogData.banReason?"dlg_login_max_count_exc":"dlg_login_max_users_exc"):$scope.fm.errorMessage="",$scope.login=function(){var errorMessage="",username=$scope.fm.username,password=$scope.fm.password;username&&password||(errorMessage=username?"dlg_login_password_req":"dlg_login_username_req"),errorMessage?$scope.fm.errorMessage=errorMessage:$scope.closeThisDialog({username:$scope.fm.username,password:$scope.fm.password})},$scope.clear=function(){$scope.fm.username="",$scope.fm.password=""},$scope.$on("ngDialog.opened",function(){body.addClass(bodyClass)}),$scope.$on("ngDialog.closing",function(){body.removeClass(bodyClass),intervalID&&$interval.cancel(intervalID)})}
;"use strict";function MacFilterFormDialogCtrl($scope,funcs,translate,util){function activate(){$scope.dialog.config=util.getConfig(),$scope.dialog.attrs=util.getAttrs(),helper=util.makeHelper(),_.isUndefined(index)?($scope.dialog.action="add",$scope.dialog.header=translate("macflt_add_rule"),$scope.dialog.rule=helper.getDefaultRule($scope.dialog.config,$scope.dialog.attrs)):($scope.dialog.action="edit",$scope.dialog.header=translate("macflt_edit_rule"),$scope.dialog.rule=angular.copy(rule),__backupRule=angular.copy($scope.dialog.rule))}function save(){function checkChange(changedConfig){return helper.accessWillLost(changedConfig)?(alert(translate("macflt_warn_access")),Promise.reject()):Promise.resolve(changedConfig)}if($scope.form.$valid){var changedConfig=helper.changeConfig($scope.dialog.config,{editRules:{rule:$scope.dialog.rule,index:index}}),overlayId=overlay.start();$scope.dialog.disableButtons=!0,util.getClient().then(function(clientConfig){return clientConfig&&clientConfig.Client&&(changedConfig.Client=clientConfig.Client),Promise.resolve(changedConfig)}).then(checkChange).then(function(changedConfig){return $scope.closeThisDialog({changed:changedConfig,overlayId:overlayId})})["catch"](function(){$scope.dialog.disableButtons=!1,overlay.stop(overlayId)})}}function remove(){function checkChange(changedConfig){return helper.accessWillLost(changedConfig)&&!alert(translate("macflt_warn_access"))?Promise.reject():Promise.resolve(changedConfig)}var changedConfig=helper.changeConfig($scope.dialog.config,{removeIndexes:[index]}),overlayId=overlay.start();$scope.dialog.disableButtons=!0,util.getClient().then(function(clientConfig){return clientConfig&&clientConfig.Client&&(changedConfig.Client=clientConfig.Client),Promise.resolve(changedConfig)}).then(checkChange).then(function(changedConfig){return $scope.closeThisDialog({changed:changedConfig,overlayId:overlayId})})["catch"](function(){$scope.dialog.disableButtons=!1,overlay.stop(overlayId)})}function getUsedMacList(){return helper.getUsedMacList($scope.dialog.config,index)}function isNotUniqRule(){return helper.isNotUniqRule($scope.dialog.config,$scope.dialog.rule,index)}function wasModified(){return __backupRule&&!_.isEqual(__backupRule,$scope.dialog.rule)}var rule=$scope.ngDialogData.rule,index=$scope.ngDialogData.index,overlay=$scope.overlay.circular;$scope.dialog={header:"",action:null,rule:null,config:null,disableButtons:!1,save:save,remove:remove,close:function(){$scope.closeThisDialog(null)},getActionList:function(){return[{name:"act_allow",value:"ACCEPT"},{name:"act_deny",value:"DROP"}]},getUsedMacList:getUsedMacList,isSupported:function(param){return _.has($scope.dialog.rule,param)},isDisabledSave:function(){return $scope.dialog.disableButtons||"edit"==$scope.dialog.action&&!wasModified()||isNotUniqRule()},isDisabledRemove:function(){return $scope.dialog.disableButtons},isNotUniqRule:isNotUniqRule,wasModified:wasModified},rule&&($scope.useSchedule=rule.useSchedule?rule.useSchedule:!1);var helper,__backupRule=null;activate()}MacFilterFormDialogCtrl.$inject=["$scope","funcs","translate","macFilterUtil"];
;"use strict";function UrlFilterAddrFormDialogCtrl($scope,translate){function wasModified(){return __backupRule&&!_.isEqual(__backupRule,$scope.dialog.rule)}var rule=$scope.ngDialogData.rule,index=$scope.ngDialogData.inx,addrList=$scope.ngDialogData.list;$scope.dialog={header:"",action:null,rule:null,save:function(){if($scope.form.$valid){var changes={rule:$scope.dialog.rule,id:index,action:"save"};$scope.closeThisDialog(changes)}},remove:function(){var changes={rule:$scope.dialog.rule,id:index,action:"remove"};$scope.closeThisDialog(changes)},close:function(){$scope.closeThisDialog(null)},validationUrl:function(rule){var url=rule.url,tmpl=rule.match_mode;return url?function(url){return/^(ht|f)tp(s?)\:/.test(url)}(url)?"urlflt_error_rule_url_contains_protocol":function(url){return url.split("/").length>1}(url)?"urlflt_error_rule_url_contains_subadress":function(url,without){return _.every(addrList,function(elem,index){return without==index?!0:elem.url!=url||elem.match_mode!=tmpl})}(url,index)?null:"urlflt_error_rule_is_not_uniq":null},getTemplatesList:function(){return[{name:"urlflt_dns_tpl_full",value:"full"},{name:"urlflt_dns_tpl_begin",value:"begin"},{name:"urlflt_dns_tpl_end",value:"end"},{name:"urlflt_dns_tpl_middle",value:"middle"}]},wasModified:wasModified};var __backupRule=null;!function(){$scope.dialog.header=translate("urlflt_dns_filter"),_.isUndefined(index)?($scope.dialog.action="add",$scope.dialog.rule=$scope.dialog.rule={url:"",match_mode:"full"}):($scope.dialog.action="edit",$scope.dialog.rule=rule,__backupRule=angular.copy($scope.dialog.rule))}()}UrlFilterAddrFormDialogCtrl.$inject=["$scope","translate","device"];
;"use strict";function UrlFilterClientFormDialogCtrl($scope,translate){function isNotUniqRule(){var useRules=getUseRules();return _.some(useRules,function(rule){return rule.mac.toUpperCase()==$scope.dialog.rule.mac.toUpperCase()})}function getUseMac(withoutIndex){var result=_.map(clientsList,function(elem,index){return index!=withoutIndex?elem.mac:void 0});return _.compact(result)}function getUseRules(){var useMac=getUseMac(index);return _.map(useMac,function(elem){return{mac:elem}})}function wasModified(){return __backupRule&&!_.isEqual(__backupRule,$scope.dialog.rule)}var rule=$scope.ngDialogData.rule,index=$scope.ngDialogData.inx;$scope.ngDialogData.client;var clientsList=$scope.ngDialogData.clientsList;$scope.dialog={header:"",action:null,rule:null,save:function(){if($scope.form.$valid){var changes={rule:$scope.dialog.rule,id:index,action:"save"};$scope.closeThisDialog(changes)}},remove:function(){var changes={rule:$scope.dialog.rule,id:index,action:"remove"};$scope.closeThisDialog(changes)},close:function(){$scope.closeThisDialog(null)},getUseRules:getUseRules,isDisabledSave:function(){return"edit"==$scope.dialog.action&&!wasModified()||isNotUniqRule()},isNotUniqRule:isNotUniqRule,wasModified:wasModified};var __backupRule=null;!function(){$scope.dialog.header=translate("client"),_.isUndefined(index)?($scope.dialog.action="add",$scope.dialog.rule=$scope.dialog.rule={note:"",mac:""}):($scope.dialog.action="edit",$scope.dialog.rule=rule,__backupRule=angular.copy($scope.dialog.rule))}()}UrlFilterClientFormDialogCtrl.$inject=["$scope","translate","device"];
;"use strict";function WanSimpleChangeCtrl($scope){$scope.choise=function(value){$scope.closeThisDialog(value)}}
;"use strict";!function(){angular.module("app").controller("WifiChannelSelectCtrl",["$scope","wifiWorkloadService","translate",function($scope,wifiWorkloadService,translate){var band=$scope.ngDialogData.band;$scope.selectedChannel=!1,$scope.showSpeed="2.4GHz"==band?!1:!0,$scope.selectChannel=function(channel){-1!=_.indexOf($scope.wifiChannelList,parseInt(channel.channel))&&($scope.selectedChannel=channel.channel,channel.neigh_channel&&($scope.neigh=channel.neigh_channel.split(",")))},$scope.apply=function(){-1!=_.indexOf($scope.wifiChannelList,parseInt($scope.selectedChannel))&&$scope.closeThisDialog({selected:!0,channel:$scope.selectedChannel})},$scope.getChannelClass=function(channel){return channel.channel==$scope.selectedChannel?"selected-green":_.contains($scope.neigh,""+channel.channel)?"selected-grey":-1==_.indexOf($scope.wifiChannelList,parseInt(channel.channel))?"disabled-row":void 0},$scope.showInfo=function(channel){return $scope.selectedChannel==channel?!0:!1},$scope.sortChannelsBy=function(param,direction){function sortChannelsWidth(){var element,sorted=_.sortBy($scope.channelsWorkload,function(elem){return elem[param]});for(var i in sorted)for(var j in sorted)sorted[i].width==sorted[j].width&&sorted[i].weight<sorted[j].weight&&(element=sorted[i],sorted[i]=sorted[j],sorted[j]=element);return sorted}$scope.channelsWorkload="width"!=param?_.sortBy($scope.channelsWorkload,function(elem){return elem[param]}):sortChannelsWidth(),"asc"==direction&&$scope.channelsWorkload.reverse()},$scope.translate=function(speed){return"maximum"==speed?translate("wifi_max_speed"):"medium"==speed?translate("wifi_med_speed"):"minimum"==speed?translate("wifi_min_speed"):void 0};var channels=function(src,status){function workload(status){return translate(status)}var output=[];return _.each(_.without(src,"auto"),function(data){output.push({channel:data,workload:workload(status),width:workload(status)})}),output};$scope.loading=!0,function(){$scope.showWorkload=!1,wifiWorkloadService.getInfoChannels(band).then(function(response){$scope.wifiChannelList=response.channels,$scope.channelsWorkload=channels(response.channels,"summary_loading"),$scope.notAllChannels=response.info,$scope.recomend_chan=translate("summary_loading"),wifiWorkloadService.getInfoWorkload(band).then(function(response){response.workload?($scope.channelsWorkload=response.workload.radar_info,$scope.recomend_chan=response.workload.recomend_chan,$scope.showWorkload=!0):$scope.channelsWorkload=channels($scope.wifiChannelList,"wifi_cant_load")},function(){$scope.channelsWorkload=channels($scope.wifiChannelList,"wifi_cant_load")})},function(){$scope.channelsWorkload=[]})["finally"](function(){$scope.loading=!1})}()}])}();
;"use strict";!function(){var config={wifiWorkloadRpc:{"2.4GHz":"261","5GHz":"262"},wifiChannelsRpc:"37"};angular.module("app").factory("wifiWorkloadService",["$q","devinfo",function($q,devinfo){return{getInfoWorkload:function(band){var wifiWorkloadRpc=config.wifiWorkloadRpc[band];return devinfo.once(wifiWorkloadRpc,{timeout:2e4}).then(function(response){var output={};return response[wifiWorkloadRpc]&&(output.workload=response[wifiWorkloadRpc]),output})},getInfoChannels:function(band){var wifiChannelsRpc=config.wifiChannelsRpc;return devinfo.once(wifiChannelsRpc,{timeout:2e4}).then(function(response){var output={};return response[wifiChannelsRpc]&&(output.channels="5GHz"==band?response[wifiChannelsRpc]["5G_ChannelList"]:response[wifiChannelsRpc].ChannelList),output})}}}])}();
;"use strict";function WifiClientDialogCtrl($scope,$element,translate){function getDefaultKeysID(){return helper.getDefaultKeysID()}var device=$scope.device,helper=device.wifi.helper;$scope.client,$scope.dialog={info:angular.copy($scope.ngDialogData.pointData),data:function(point,client){var isCurrent=$scope.isCurrent=point.BSSID==client.BSSID&&point.Band==client.Band;return{SSID:point.SSID,BSSID:point.BSSID,Band:isCurrent?client.Band:point.Band,AdvancedChannel:point.AdvancedChannel,Security:{ModeEnabled:point.ModeEnabled,EncryptionType:point.EncryptionType,PreSharedKey:isCurrent?client.Security.PreSharedKey:"",WEPKey1:isCurrent?client.Security.WEPKey1:"",WEPKey2:isCurrent?client.Security.WEPKey2:"",WEPKey3:isCurrent?client.Security.WEPKey3:"",WEPKey4:isCurrent?client.Security.WEPKey4:"",OpenWEP:isCurrent?client.Security.OpenWEP:!1,DefaultKeyID:isCurrent?client.Security.DefaultKeyID:getDefaultKeysID()[0],WEPasHEX:isCurrent?client.Security.WEPasHEX:!1},MacAddressClone:client.MacAddressClone}}($scope.ngDialogData.pointData,$scope.ngDialogData.clientData),apply:function(){if(!$scope.form.$invalid){var data={ep:$scope.dialog.data,radio:{Band:$scope.dialog.info.Band,Channel:$scope.dialog.info.Channel}};data.ep.Action=$scope.isCurrent?"reconnect":"save",$scope.closeThisDialog(data)}},cancel:function(){$scope.closeThisDialog(null)},showAdvanced:!1,getSignalStrength:function(strength){return strength+"%"},showSecurity:function(type){return helper.checkSecurityType(type,$scope.dialog.data)},getDefaultKeysID:getDefaultKeysID,getIncorrectModeNotice:function(){var mode=$scope.dialog.data.Security.ModeEnabled;return translate(wifi_client_incorrect_network_notice1)+" "+mode+" "+translate(wifi_client_incorrect_network_notice2)},isOpen:function(){var mode=$scope.dialog.data.Security.ModeEnabled;return"None"==mode},isWPAEnterprice:function(){var mode=$scope.dialog.data.Security.ModeEnabled;return"WPA-Enterprise"==mode||"WPA2-Enterprise"==mode||"WPA-WPA2-Enterprise"==mode},validPSKKey:function(pskKey){return helper.validPSKKey(pskKey)},validWEPKey:function(wepKey){return $scope.dialog.data?helper.validWEPKey(wepKey,$scope.dialog.data):null},getWEPKeyLenMessage:function(){return $scope.dialog.data?helper.getWEPKeyLenMessage($scope.dialog.data):null}}}
;"use strict";!function(){angular.module("app").controller("wifiClientMgmDialogCtrl",function($scope,wifiClientMgmUtil){function getImgSignal(signal){var value=parseInt(signal/20);return value||(value="0"),5==value&&(value=4),value?"wifi_"+value+" ":""}$scope.client=$scope.ngDialogData.rule,$scope.imgSignal=$scope.ngDialogData.imgSignal;var id=$scope.ngDialogData.id;wifiClientMgmUtil.subsribeClientInfo(function(newInfo,id){$scope.client.RSSI=newInfo[id].RSSI,$scope.imgSignal=getImgSignal(newInfo[id].Signal),$scope.client.Online=newInfo[id].Online,$scope.client.RateDownLink=newInfo[id].RateDownLink,$scope.client.RxBytes=newInfo[id].RxBytes,$scope.client.TxBytes=newInfo[id].TxBytes,$scope.client.Sleep=newInfo[id].Sleep},$scope,id),$scope.ngDialogData.header=$scope.client.Hostname&&""!=$scope.client.Hostname?$scope.client.Hostname:$scope.client.MAC,$scope.isEmpty=function(value){return _.isEmpty(value)}})}();
;"use strict";function WiFiClientSeparatedWarnCtrl($scope){$scope.getWarning=function(){return"5GHz"==$scope.ngDialogData.band?"wifi_client_separated_warn24":"wifi_client_separated_warn5"},$scope.offClient=function(){$scope.closeThisDialog({action:"canсel"})},$scope.cancel=function(){$scope.closeThisDialog(null)}}
;"use strict";function WifiDeviceLossDialogCtrl($rootScope,$scope,$timeout,translate,devinfo){function startProgressBar(){$scope.pbDuration=2e4,$scope.pbPause=!1,$scope.pbHidden=!1}function stopProgressBar(){$scope.pbHidden=!0}function stateForMobileApp(){startProgressBar(),$scope.mobileapp=!0,$scope.waitForConnection=!0,$scope.updateCommentTitle()}function stateNotMobileApp(){stopProgressBar(),$scope.mobileapp=!1,$scope.updateCommentTitle()}var data=$scope.ngDialogData;$scope.updateCommentTitle=function(){var msg="";($scope.mobileapp&&$scope.waitForConnection||!$scope.mobileapp&&!$scope.deviceAvailable)&&(_.contains(data.reason,"ssid")&&(msg+=translate("wifi_device_loss_ssid")+". </br>"),_.contains(data.reason,"security_mode")&&(msg+=translate("wifi_device_loss_security_mode")+". </br>"),_.contains(data.reason,"security_encryption")&&(msg+=translate("wifi_device_loss_security_encryption")+". </br>")),msg+=$scope.mobileapp&&$scope.waitForConnection?translate("wifi_device_loss_reconnect_attempt"):$scope.deviceAvailable?translate("wifi_device_loss_reconnect_success"):$scope.mobileapp?translate("wifi_device_loss_reconnect_failed"):translate("wifi_device_loss_reconnect")+".\n",$scope.commentTitle=msg},$scope.getCommentParam=function(){return translate("wifi_device_loss_params")+":\n"},$scope.getParams=function(){function getKey(name){return/WEPKey*/.test(name)?"wifi"+name:{SSID:"wifi_ssid",ModeEnabled:"wifi_mode",PreSharedKey:"wifi_psk_key",RadiusSecret:"wifi_wpa_radius_secret"}[name]}function addRow(key,value){var title="<div class='dialog_row__title'>"+translate(key)+":</div>";return"<div class='dialog_row'>"+title+("<div class='dialog_row__info'>"+value+"</div>")+"</div>"}var msg="";return _.each(data.params,function(value,name){var key;value&&(key=getKey(name),key&&(msg+=addRow(key,value)))}),msg},$scope.skip=function(){$scope.closeThisDialog()},$scope.openWifiSettings=function(){$rootScope.dlinkMobileApp.openWifiSettings()},$timeout(function(){function setDeviceNotAvailable(){$scope.deviceAvailable=!1,$scope.waitForConnection||$scope.updateCommentTitle()}function setDeviceAvailableAgain(){devinfo.once("client").then(function(result){result.client.SSID==data.params.SSID&&($scope.deviceAvailable=!0,$scope.waitForConnection=!1,stopProgressBar(),$scope.updateCommentTitle())})}var eventDeviceNotAvailable=$rootScope.$on("device.state.not_available",setDeviceNotAvailable),eventDeviceAvailableAgain=$rootScope.$on("device.state.available_again",setDeviceAvailableAgain),eventDeviceAvailableAgain2=$rootScope.$on("device_available_again",setDeviceAvailableAgain),eventDeviceDefinitlyLost=$rootScope.$on("device_definitly_lost",setDeviceNotAvailable),eventDevicePossiblyLost=$rootScope.$on("device_possibly_lost",setDeviceNotAvailable);$scope.$on("$destroy",function(){eventDeviceNotAvailable(),eventDeviceAvailableAgain(),eventDeviceAvailableAgain2(),eventDeviceDefinitlyLost(),eventDevicePossiblyLost()})}),$rootScope.dlinkMobileApp?$rootScope.dlinkMobileApp.wifiConnectionChanged(data.params).then(function(){stateForMobileApp()})["catch"](function(){stateNotMobileApp()}):stateNotMobileApp(),$scope.wifiReconnectTimeout=function(status){"finished"==status&&(stopProgressBar(),$scope.waitForConnection=!1,$scope.updateCommentTitle())}}WifiDeviceLossDialogCtrl.$inject=["$rootScope","$scope","$timeout","translate","devinfo"];
;"use strict";function WifiMacEditDialogCtrl($scope,snackbars,translate){function isClientEdit(mac){return mac.toUpperCase()==client.mac.toUpperCase()}function isMacChanged(mac){return oldMac.toUpperCase()==client.mac.toUpperCase()&&mac.toUpperCase()!=oldMac.toUpperCase()}function saveChange(){var save=wifiMacFilter.set.bind(null,inx);wifiMacFilter.cut(inx),save(rule),$scope.update($scope.closeThisDialog.bind(null,"saved"))}function saveChangeConfirm(){var save;confirm(translate("wifi_mac_warning_access_loss"))&&(isNew?(save=wifiMacFilter.add,save(rule),$scope.update($scope.closeThisDialog.bind(null,"saved"))):saveChange())}var ngDialogData=angular.copy($scope.ngDialogData),inx=ngDialogData.inx,isNew=$scope.isNew=ngDialogData.isNew,rule=$scope.rule=ngDialogData.rule,rules=angular.copy($scope.rules),wifiMacFilter=$scope.device.wifiMacFilter,oldMac=rule.MAC,client=ngDialogData.client,backupRule=angular.copy(rule);$scope.rule.MAC=$scope.rule.MAC.toUpperCase(),$scope.header="wifi_mac_"+(isNew?"add":"edit"),rule&&($scope.useSchedule=rule.useSchedule?rule.useSchedule:!1),$scope.save=function(){var network,save=isNew?wifiMacFilter.add:wifiMacFilter.set.bind(null,inx);if($scope.wifi_mac_form.$valid)if(isNew)client&&!_.isUndefined(client.mac)?(network=angular.copy($scope.networks[rule.Band].List[rule.Network]),isClientEdit(rule.MAC)&&rule.Enable&&network&&network.Enable&&"deny"==network.AccessPolicy?saveChangeConfirm():(save(rule),$scope.update($scope.closeThisDialog.bind(null,"saved")))):(save(rule),$scope.update($scope.closeThisDialog.bind(null,"saved")));else if(client&&!_.isUndefined(client.mac)){var network=angular.copy($scope.networks[rule.Band].List[rule.Network]);isClientEdit(rule.MAC)&&rule.Enable&&network&&network.Enable&&"deny"==network.AccessPolicy?saveChangeConfirm():isClientEdit(rule.MAC)&&!rule.Enable&&network&&network.Enable&&"allow"==network.AccessPolicy?saveChangeConfirm():isMacChanged(rule.MAC)&&rule.Enable&&network&&network.Enable&&"allow"==network.AccessPolicy?saveChangeConfirm():saveChange()}else saveChange()},$scope.uniqueMacValidator=function(mac){var curNetworkRules=funo.filter(rules,function(checkingRule){return!0&&rule.Network===checkingRule.Network&&rule.Band===checkingRule.Band}),otherRules=funo.filter(curNetworkRules,function(_,checkingInx){return inx!==checkingInx}),usedMacs=_.map(otherRules,_.property("MAC"));_.each(usedMacs,function(elem,inx){usedMacs[inx]=elem.toUpperCase()});var isMacUsed=~usedMacs.indexOf(mac.toUpperCase());return isMacUsed?"wifi_mac_used":null},$scope.uniqueHostValidator=function(host){if(!host)return null;var curNetworkRules=_.filter(rules,function(checkingRule){return!0&&rule.Network===checkingRule.Network&&rule.Band===checkingRule.Band}),otherRules=_.filter(curNetworkRules,function(_){return _.Inx!=rule.Inx}),usedHosts=_.map(otherRules,_.property("Hostname"));_.each(usedHosts,function(elem,inx){usedHosts[inx]=elem.toUpperCase()});var isHostUsed=~usedHosts.indexOf(host.toUpperCase());return isHostUsed?"msg_error_value_is_not_uniq":null},$scope.changeBand=function(){$scope.networks[rule.Band].List[rule.Network]||(rule.Network=_.keys($scope.networks[rule.Band].List)[0]),rule.BandInx=$scope.networks[rule.Band].BandInx},$scope.wasModified=function(){return isNew?!1:(backupRule.MAC=backupRule.MAC.toUpperCase(),_.isEqual(backupRule,$scope.rule))}}
;"use strict";function WifiMacEditNetworkDialogCtrl($scope,snackbars,translate){function saveChange(){$scope.networks[band].List[inx]=network,$scope.update($scope.closeThisDialog.bind(null,"saved"))}function saveChangeconfirm(){confirm(translate("wifi_mac_warning_access_loss"))&&saveChange()}var macEnabled,inx=$scope.ngDialogData.inx,band=$scope.ngDialogData.band,network=$scope.network=angular.copy($scope.networks[band].List[inx]),client=($scope.device.wifiMacFilter,$scope.ngDialogData.client),rules=$scope.rules,hasMacInRuls=!1;$scope.header="wifi_mac_network_edit",$scope.save=function(){$scope.wifi_mac_network_form.$valid&&(network.Enable||(network.AccessPolicy="off"),client&&!_.isUndefined(client.mac)?(_.find(_.values(rules),function(key){key.MAC.toUpperCase()==client.mac.toUpperCase()&&(hasMacInRuls=!0,macEnabled=key.Enable)}),network.Enable&&"allow"==network.AccessPolicy&&!hasMacInRuls&&network.SSID==client.SSID?saveChangeconfirm():network.Enable&&"allow"==network.AccessPolicy&&hasMacInRuls&&!macEnabled&&network.SSID==client.SSID?saveChangeconfirm():network.Enable&&"deny"==network.AccessPolicy&&hasMacInRuls&&macEnabled&&network.SSID==client.SSID?saveChangeconfirm():saveChange()):saveChange())},$scope.$watch("network.Enable",function(enabled){enabled&&"off"===network.AccessPolicy&&(network.AccessPolicy="allow")})}
;"use strict";function WifiMacEditSimpleDialogCtrl($scope){var inx=$scope.ngDialogData.inx,isNew=$scope.isNew=$scope.ngDialogData.isNew,rule=($scope.ngDialogData.rule.deny,$scope.rule=$scope.ngDialogData.rule),rules=angular.copy($scope.rules),wifiMacFilter=$scope.device.wifiMacFilter;$scope.header="wifi_mac_"+(isNew?"add":"edit"),$scope.optionsNetwork=isNew?$scope.networks:$scope.networksFullList,$scope.save=function(){var save=isNew?wifiMacFilter.add:wifiMacFilter.cut;$scope.wifi_mac_form.$valid&&(save(isNew?rule:inx),$scope.update($scope.closeThisDialog.bind(null,"saved")))},$scope.uniqueMacValidator=function(mac){var curNetworkRules=funo.filter(rules,function(checkingRule){return!0&&rule.Network===checkingRule.Network&&rule.Band===checkingRule.Band}),otherRules=funo.filter(curNetworkRules,function(_,checkingInx){return inx!==checkingInx}),usedMacs=_.map(otherRules,_.property("MAC"));_.each(usedMacs,function(elem,inx){usedMacs[inx]=elem.toUpperCase()});var isMacUsed=~usedMacs.indexOf(mac.toUpperCase());return isMacUsed?"wifi_mac_used":null},$scope.changeBand=function(){$scope.networks[rule.Band].List[rule.Network]||(rule.Network=_.keys($scope.networks[rule.Band].List)[0])},$scope.getButtonText=function(){var isDeny="deny"==$scope.optionsNetwork[rule.Band].List[rule.Network].AccessPolicy;return isDeny&&isNew||!isDeny&&!isNew?"act_deny":"act_allow"}}
;"use strict";angular.module("app").controller("WifiShapingDialogCtrl",["$scope","$timeout","device",function($scope,$timeout,device){var util=device.wifiShaping;$scope.unescape=_.unescape,$scope.action=$scope.ngDialogData.action,$scope.rule=$scope.ngDialogData.rule,$scope.networks=util.getNetworks(),$scope.rule.UploadUnlim=0===$scope.rule.UploadRate,$scope.rule.DownloadUnlim=0===$scope.rule.DownloadRate,"edit"==$scope.action&&($scope.rule.UploadRate=$scope.rule.UploadRate?$scope.rule.UploadRate/$scope.constants.KbInMB:null,$scope.rule.DownloadRate=$scope.rule.DownloadRate?$scope.rule.DownloadRate/$scope.constants.KbInMB:null),$scope.uniqueMacValidator=function(mac){return"add"==$scope.action&&$scope.wifiShaping.data[mac]?"wifi_client_shaping_exist_mac":null},$scope.save=function(){$timeout(function(){$scope.$emit("goToErrorForm",!0),$scope.wifi_shaping_form.$valid&&($scope.hasNetworks()&&($scope.ngDialogData.rule.SSID=$scope.networks[$scope.ngDialogData.rule.Band].List[$scope.ngDialogData.rule.Network].SSID),$scope.closeThisDialog($scope.ngDialogData.rule))})},$scope.isMoreThanOneBand=function(){return _.size($scope.networks)>1},$scope.changeBand=function(){$scope.networks[$scope.rule.Band].List[$scope.rule.Network]||($scope.rule.Network=_.keys($scope.networks[$scope.rule.Band].List)[0])},$scope.hasNetworks=function(){return!_.isUndefined($scope.networks)},$scope.isNew=function(){return!_.has($scope.rule,"Inx")}}]);
;"use strict";function WifiWMMEditDialogCtrl($rootScope,$scope,$interpolate){var utilWMM=$scope.wmm.wmm;$scope.type=$scope.ngDialogData.type,$scope.key=$scope.ngDialogData.key;var point=$scope.point=utilWMM.get($scope.type,$scope.key);$scope.backupPoint=angular.copy(point),$scope.isAP="ap"===$scope.type,$scope.shortAC=point.AccessCategory,$scope.getHeader=function(){var header,type=$scope.isAP?"access_point":"station",accessCategory=$scope.transcripts[$scope.shortAC];return header='{{"wifi_wmm_edit_'+type+'" | translate}}: '+accessCategory,$interpolate(header)($scope)},$scope.getCWValues=function(max){var i,result=[];for(i=1;max>=i;i++)result.push({key:i,val:$scope.getCWValue(i)});return result},$scope.isSavingDisabled=function(){return $scope.wifi_wmm_edit_form.$invalid||!$scope.wasModified()},$scope.save=function(){$scope.closeThisDialog("save")},$scope.restrictions=utilWMM.getRestriction($scope.type,$scope.shortAC),$scope.wasModified=function(){return $scope.point&&!_.isEqual($scope.point,$scope.backupPoint)}}
;"use strict";function DynamicIpWarningCtrl($scope){function closeDialog(){$scope.closeThisDialog($scope.data)}$scope.data={},$scope.cancel=function(){$scope.data["continue"]=!1,closeDialog()},$scope["continue"]=function(){$scope.data["continue"]=!0,closeDialog()},$scope.goToDomainName=function(){$scope.data.goToDomainName=!0,closeDialog()}}
;"use strict";function WifiClientDeviceLossCtrl($scope,$element,translate){$scope.notAskAgain=!1,$scope.apModeData=angular.copy($scope.ngDialogData.apModeData),$scope.warnMsg=translate(function(apModeData){return apModeData.dynamicAddressingMode&&!apModeData.localDomainLoaded?"wifi_client_ip_address_warning":apModeData.dhcpEnabled?"wifi_client_static_ip_dhcp_on_warning":"wifi_client_static_ip_dhcp_off_warning"}($scope.apModeData)),$scope.noActionsRequiredMsg=translate("wifi_client_no_actions_required"),$scope.buttonMsg=function(apModeData){return apModeData.dynamicAddressingMode&&!apModeData.localDomainLoaded?"lan_use_domain_name":"lan_go_to_lan_settings"}($scope.apModeData),$scope.cancel=function(){$scope.closeThisDialog({notAskAgain:$scope.notAskAgain,"continue":!1})},$scope["continue"]=function(){$scope.closeThisDialog({notAskAgain:$scope.notAskAgain,"continue":!0})},$scope.goToDomainName=function(){$scope.closeThisDialog({goToDomainName:$scope.apModeData.dynamicAddressingMode,goToLanSettings:!$scope.apModeData.dynamicAddressingMode})}}
;"use strict";angular.module("app").controller("ErrorCtrl",["$scope","$stateParams","translate",function($scope,$stateParams){console.log("Error!"),$scope.$emit("pageload"),$scope.code=$stateParams.code,$scope.message=$stateParams.message}]);
;"use strict";!function(){angular.module("app").controller("lanCtrl",["$scope","$state","$q","lanHelper",function($scope,$state,$q,helper){function fetch(){var deferred=$q.defer();return pull().then(function(){deferred.resolve()},function(){$state.go("error",{code:"msg_pull_error",message:"msg_error_desc"}),deferred.reject()}),deferred.promise}function pull(){var deferred=$q.defer();return lan.pull(function(error){return error?void deferred.reject("pull"):void deferred.resolve()},supported),deferred.promise}$scope.device;var lan=$scope.device.lan,supported=helper.supported.lan();$scope.lan={data:null,interfaceCount:0},$scope.lan.isPageLoad=!1,$scope.$on("$destroy",function(){lan["interface"].clean()}),function(){fetch().then(function(){lan["interface"].init(),$scope.lan.data=lan.data(),$scope.lan.interfaceCount=_.size($scope.lan.data),$scope.lan.isPageLoad=!0,$scope.$emit("pageload",{title:"LAN"})})}()}])}();
;"use strict";angular.module("app").controller("NoticeCtrl",["$rootScope","$scope","$state","$timeout","$window","translate","noticeUtil","device","funcs",function($rootScope,$scope,$state,$timeout,$window,translate,notice){$scope.notifications=[],notice.subscribe(function(){function isNew(name){return _.every($scope.notifications,function(elem){return elem.name!=name})}function addToList(name,view,index){var item={name:name,view:view};return _.isUndefined(index)?void $scope.notifications.push(item):void $scope.notifications.splice(index,0,item)}var list=notice.getList(),names=_.pluck(list,"name");!function(names){var index,name;for(index=$scope.notifications.length-1;index>=0;index--)name=$scope.notifications[index].name,_.contains(names,name)||$scope.notifications.splice(index,1)}(names),_.each(list,function(elem,index){var name=elem.name;elem.params;var content=elem.view;elem.view&&isNew(name)&&addToList(name,content,index)})}),$scope.$emit("pageload")}]);
;"use strict";!function(){angular.module("app").constant("summaryConstants",{GPON_STATUS_RPC:227,DSL_RPC:24,CPU_AND_RAM:233,DONGLE_RPC:134,STORAGE_RPC:82,PRINTSERVER_RPC:101,PORTS_RPC:175,DEVICE_MODE_RPC:autoconf.BR2_PACKAGE_ANWEB_DSYSINIT?"Device.DeviceInfo.":112,CONFIG_ID_WIFI:35})}();
;"use strict";!function(){angular.module("app").constant("summaryLinks",{firmware:"system.firmware",lan4:"network.lan",lan6:'network.lan({ipversion:"IPv6"})',ap24:'wifi.ap.edit({freq: "2.4GHz", inx: 1})',ap5:'wifi.ap.edit({freq: "5GHz", inx: 1})'})}();
;"use strict";!function(){angular.module("app").constant("wanConstants",{INTERFACE_GROUPING:autoconf.BR2_PACKAGE_ANWEB_INTERFACE_GROUPING})}();
;"use strict";function WanAdditionalConnectionPPPoEDialogCtrl($scope){var data=$scope.ngDialogData;$scope.newConnection=!1,$scope.select={type:{value:null,list:[]},connection:{value:null,list:[]},isShowConnection:function(){return"internet"==select.type.value&&select.connection.list.length>0}};var select=$scope.select;!function(){!function(){var list=select.type.list;list.push({label:"wan_additional_select_type_internet",value:"internet"})}(),function(){var list=select.connection.list;data.notCreate||list.push({label:"wan_additional_select_connection_new",value:{type:"new"}}),data.notConnection||_.each(data.connections,function(elem){list.push({label:elem.data.Name,value:elem})})}()}(),function(){!function(){var list=select.type.list;select.type.value=list.length?list[0].value:null}(),function(){var list=select.connection.list;select.connection.value=list.length?list[0].value:null}()}(),$scope.cancel=function(){$scope.closeThisDialog(null)},$scope.create=function(){var mode=function(){return"internet"==select.type.value?"new"==select.connection.value.type?"new":"select":void 0}(),connection="select"==mode?select.connection.value:null;$scope.closeThisDialog({mode:mode,connection:connection})},$scope.skip=function(){$scope.closeThisDialog({mode:"none"})}}
;"use strict";function WanAdditionalConnectionPPTPDialogCtrl($scope){var data=$scope.ngDialogData;$scope.select={type:{value:null,list:[]},connection:{value:null,list:[]},isShowConnection:function(){return"internet"==select.type.value&&select.connection.list.length>1}};var select=$scope.select;!function(){!function(){var list=select.type.list;list.push({label:"wan_additional_select_type_internet",value:"internet"}),data.useAuto&&list.push({label:"wan_additional_select_type_vpn",value:"vpn"})}(),function(){var list=select.connection.list;data.notCreate||list.push({label:"wan_additional_select_connection_new",value:{type:"new"}}),_.each(data.connections,function(elem){list.push({label:elem.data.Name,value:elem})})}()}(),function(){!function(){var list=select.type.list;select.type.value=list.length?list[0].value:null}(),function(){var list=select.connection.list;select.connection.value=list.length?list[0].value:null}()}(),$scope.cancel=function(){$scope.closeThisDialog(null)},$scope.apply=function(){var mode=function(){return"vpn"==select.type.value?"auto":"internet"==select.type.value?"new"==select.connection.value.type?"new":"select":void 0}(),connection="select"==mode?select.connection.value:null;$scope.closeThisDialog({mode:mode,connection:connection})}}
;"use strict";!function(){angular.module("app").service("bandwidthControlUtil",["somovd","funcs","device",function(somovd,funcs,device){function apply(port){var data=converter.nativeToSomovd(port);return somovd.write(rpc,data,function(response){return funcs.is.allRPCSuccess(response)?Promise.resolve():Promise.reject()})}function getData(){return data&&data.ports?data.ports:[]}var rpc=230,data=null,converter=device.bandwidth.converter;return{pull:function(){function success(response){return data=converter.somovdToNative(response.data),data.ports=funcs.sortPortsSomovd(data.ports),Promise.resolve()}return somovd.read(rpc).then(success)},apply:apply,getData:getData}}])}();
;"use strict";!function(){angular.module("app").service("ddnsUtil",["funcs","device","somovd","navigationFilter",function(funcs,device,somovd,navigationFilter){function makeHelper(){return new device.ddns.Helper(config)}function wasActivate(){return activate}var config={},activate=!1,converter=device.ddns.converter,constants=function(){var customRules=navigationFilter.rules()||{},constants={ddns:6,ifaces:120,services:[]},services=constants.services;return services.push({Name:"DynDNS.com",Service:"dyndns.com",System:"dyndns@dyndns.org"}),services.push({Name:"NoIP",Service:"no-ip.com",System:"default@no-ip.com"}),_.has(customRules,"DDNSAdditionalServices")&&(constants.services=_.union(services,customRules.DDNSAdditionalServices)),constants}();return{pull:function(){return somovd.read([constants.ddns,constants.ifaces],function(response){if(!funcs.is.allRPCSuccess(response))return Promise.reject();var input={ddns:response.rq[0].data.ddns,ifaces:response.rq[1].data.iface_names,services:constants.services,needChooseIface:autoconf.BR2_PACKAGE_ANWEB_INADYN_1_99_13&&autoconf.BR2_PACKAGE_ANWEB_BCM_MODEM};return config=converter.somovdToNative(input),activate=!0,Promise.resolve()})},apply:function(settings,index){var data=converter.nativeToSomovd(settings);return somovd.write(constants.ddns,data,index).then(function(response){return funcs.is.RPCSuccess(response)?Promise.resolve():Promise.reject()})},makeHelper:makeHelper,remove:function(items,keys){function keysMapper(key){return{id:constants.ddns,pos:key,data:{}}}return somovd.remove(function(){return keys.sort().reverse().map(keysMapper)}()).then(function(response){return funcs.is.allRPCSuccess(response)?Promise.resolve():Promise.reject()})},wasActivate:wasActivate}}])}();
;"use strict";!function(){angular.module("app").service("dmzUtil",["somovd","device","funcs",function(somovd,device,funcs){function getConfig(){return config?config:{}}var config=null,CONFIG_ID_DMZ=23;return{pull:function(){return somovd.read(CONFIG_ID_DMZ,function(response){return funcs.is.RPCSuccess(response)?(config={dmz:response.data.dmz?response.data.dmz:response.data},Promise.resolve()):Promise.reject()})},apply:function(settings){return somovd.write(CONFIG_ID_DMZ,settings.dmz,-1,function(response){return funcs.is.RPCSuccess(response)?Promise.resolve():Promise.reject()})},getConfig:getConfig,useEnableSNAT:function(){return autoconf.BR2_PACKAGE_ANWEB_NAT_LOOPBACK},disableUseLanIp:function(){return autoconf.BR2_PACKAGE_ANWEB_CUSTOM_PARTNER_23078}}}])}();
;"use strict";!function(){angular.module("app").service("igmpUtil",["somovd","funcs",function(somovd,funcs){var config={},rpcs=[];return rpcs.push({key:"igmp",num:{CONFIG_ID_IGMP:68,CONFIG_ID_MLD:257}.CONFIG_ID_IGMP}),{pull:function(){return somovd.read(rpcs.map(function(rpc){return rpc.num}),function(response){rpcs.forEach(function(rpc,inx){config[rpc.key]=response.rq[inx].data})})},apply:function(settings){return somovd.write(rpcs.map(function(rpc){return{id:rpc.num,data:settings[rpc.key],pos:-1}}),function(response){return funcs.is.allRPCSuccess(response)?Promise.resolve():Promise.reject()})},getConfig:function(){return config}}}])}();
;"use strict";!function(){angular.module("app").service("ipfilterUtil",["somovd","device","funcs",function(somovd,device,funcs){function wasActivate(){return activate}function makeHelper(){return new device.ipfilter.Helper(ipfilter,lan,attributes)}var ipfilter=null,lan=null,attributes=null,activate=!1,converterLan=device.ipfilter.lanConverter,converterAttrs=device.ipfilter.attrsConverter,CONFIG_ID_IPFILTER=88;return{pull:function(){return somovd.read([CONFIG_ID_IPFILTER,autoconf.CONFIG_ID_WAN_TEMP],function(response){if(!funcs.is.allRPCSuccess(response))return Promise.reject();ipfilter=response.rq[0].data.ipfilter,lan=converterLan.somovdToNative(response.rq[1].data.iface_names).LAN;var input={BRCM:!autoconf.BR2_PACKAGE_ANWEB_BCM_MODEM,BRIPV6:autoconf.BR2_PACKAGE_ANWEB_IPV6};return attributes=converterAttrs(input),activate=!0,Promise.resolve()})},wasActivate:wasActivate,removeRules:function(removeList){return _.map(removeList,function(elem){return elem.id=CONFIG_ID_IPFILTER,elem}),somovd.remove(removeList,function(response){return funcs.is.allRPCSuccess(response)?Promise.resolve():Promise.reject()})},applyRule:function(rule,index){return index=_.isUndefined(index)?-1:index,somovd.write(CONFIG_ID_IPFILTER,rule,index).then(function(response){return funcs.is.allRPCSuccess(response)?Promise.resolve():Promise.reject()})},makeHelper:makeHelper}}])}();
;"use strict";!function(){angular.module("app").controller("lanFormCtrl",["$rootScope","$scope","$state","$q","$timeout","ngDialog","translate","history","lanHelper","unsavedWarningSharedService","devinfo","$location","funcs",function($rootScope,$scope,$state,$q,$timeout,ngDialog,translate,history,helper,unsavedWarningSharedService,devinfo,$location,funcs){function activate(force,overlayId){function __activate(){return $scope.lanForm.inx=$state.params.inx?$state.params.inx:getInterfaceIndex(),$scope.lanForm.inx&&lan["interface"].has($scope.lanForm.inx)?(lan["interface"].init(),lan["interface"].change($scope.lanForm.inx),$scope.lan.data=lan.data(),$timeout(function(){$scope.$broadcast("lan.update",$scope.lanForm.inx),$scope.$broadcast("lan.ipversion",$scope.lanForm.ipVersion)},0),$scope.lanForm.isPageLoad=!0,$scope.$emit("pageload",{title:"LAN"}),void(overlayId&&overlay.stop(overlayId))):void goToStart()}force||_.isEmpty(lan.data())?fetch().then(__activate):__activate(),$rootScope.dlinkMobileApp.isUserInMobileApp()&&($rootScope.dlinkMobileApp.hasAdvancedIpAddressChanged?$rootScope.dlinkMobileApp.customLocalDomainCheck&&$rootScope.dlinkMobileApp.isDomainNameUsing().then(function(isDomainName){$scope.noWarnAboutDynamic=isDomainName}):$scope.noWarnAboutDynamic=!0)}function fetch(){var deferred=$q.defer();return pull().then(function(){deferred.resolve()},function(){$state.go("error",{code:"msg_pull_error",message:"msg_error_desc"}),deferred.reject()}),deferred.promise}function pull(){var deferred=$q.defer();return lan.pull(function(error){return error?void deferred.reject("pull"):void deferred.resolve()},supported),deferred.promise}function __showDeviceLossMsg(deviceLoss){var properties=function(options){return ngDialog.open({templateUrl:"dialogs/lan_ip_change/dialog.tpl.html",controller:"LanIpChangeDialogCtrl",className:"wifi_device_loss_dialog",data:options})}(deviceLoss);return properties.closePromise.then(function(){return Promise.resolve("change_ip")}),properties.id}function openDialog(){var ip=lan.data()[1].IPv4.StaticIP[1].Address;return $rootScope.dlinkMobileApp&&$rootScope.dlinkMobileApp.ipAddressChanged(ip),__showDeviceLossMsg({newIp:ip,goToNewIp:$rootScope.goToNewIP})}function openDynamicIpWarnDialog(){var properties=function(){return ngDialog.open({templateUrl:"dialogs/dynamic_ip_warning/dialog.tpl.html",controller:"DynamicIpWarningCtrl"})}({});return properties.closePromise.then(function(data){var host,values=data?data.value:void 0;return values&&(values.goToDomainName?(host=lanDataBeforeChange.IPv4.StaticIP[1].AddnHostname,$rootScope.dlinkMobileApp.isUserInMobileApp()&&$rootScope.dlinkMobileApp.ipAddressChangedAdvanced({disconnect:!1,save:!0,address:host}),save(),$rootScope.goToNewIP(host)):values["continue"]&&($scope.noWarnAboutDynamic=!0,apply())),Promise.resolve("dynamic_ip")}),properties.id}function apply(){$scope.form.submitted=!0,$timeout(__apply)}function __apply(){function applyHandler(deviceLoss){return new Promise(function(resolve,reject){save().then(function(flags){function checkRootScopeOverlay(){var ip,newUrl;helper.constraints.constants.DSYSINIT&&"undefined"!=typeof $rootScope.overlay.progress.start(helper.constraints.constants.REBOOT_TIME)&&(ip=lan.data()[1].IPv4.StaticIP[1].Address,newUrl=$location.protocol()+"://"+ip+":"+$location.port(),$rootScope.overlay.progress.start(helper.constraints.constants.REBOOT_TIME).then(function(){window.location.href=newUrl}),devinfo.__setting.url=newUrl+"/devinfo",$rootScope.waitForReboot().then(function(){$rootScope.overlay.progress.stop(),window.location.href=newUrl}))}return flags=flags||{},$scope.form.submitted=!1,flags.saveAndReboot&&confirm(translate("msg_warn_save_and_reboot"))?(checkRootScopeOverlay(),overlay.stop(overlayId),$rootScope.$emit("unsavedStop",!0),device.system.reboot(!0),resolve("change_ip")):resolve()},function(){deviceLoss.loss&&resolve("change_ip"),reject("errors")}),deviceLoss.loss&&$rootScope.dlinkMobileApp&&$timeout(function(){resolve("change_ip")},2500)})}if(isValid()||unsavedWarningSharedService.setBackup(!1),isValid()&&isChange()){if(!$scope.noWarnAboutDynamic&&isDynamicAddress()&&!isLocalDomainUsedForLoad())return void openDynamicIpWarnDialog();var overlayId=overlay.start(),deviceLoss=lan.checkDeviceLoss($location.host()),applyFunc=function(){applyHandler(deviceLoss).then(function(res){res&&"change_ip"==res||($scope.lanForm.isMultiInterfaces?(overlay.stop(overlayId),goToStart()):activate(!0,overlayId))},function(){deviceLoss.loss||(overlay.stop(overlayId),$state.go("error",{code:"msg_push_error",message:"msg_error_desc"}))})};return deviceLoss.loss&&helper.constraints.constants.DSYSINIT?($scope.lan_ip_dialog_cb=applyFunc,void($scope.lan_ip_dialog_id=openDialog())):applyFunc()}}function checkDhcpServer(){var currentLan=lan.data()[1];currentLan.IPv4&&(funcs.is.ipv4(currentLan.IPv4.DHCP.Server.MinAddress)||(currentLan.IPv4.DHCP.Server.MinAddress=lanDataBeforeChange.IPv4.DHCP.Server.MinAddress),funcs.is.ipv4(currentLan.IPv4.DHCP.Server.MaxAddress)||(currentLan.IPv4.DHCP.Server.MaxAddress=lanDataBeforeChange.IPv4.DHCP.Server.MaxAddress)),currentLan.IPv6&&(funcs.is.ipv6(currentLan.IPv6.DHCP.Server.MinAddress)||currentLan.IPv6.DHCP.Server.DHCPAddressShort||(currentLan.IPv6.DHCP.Server.MinAddress=lanDataBeforeChange.IPv6.DHCP.Server.MinAddress),funcs.is.ipv6(currentLan.IPv6.DHCP.Server.MaxAddress)||currentLan.IPv6.DHCP.Server.DHCPAddressShort||(currentLan.IPv6.DHCP.Server.MaxAddress=lanDataBeforeChange.IPv6.DHCP.Server.MaxAddress))}function save(){function success(flags){deferred.resolve(flags)}function error(){deferred.reject()}$scope.lanForm.dhcpPorts&&$scope.lanForm.dhcpPorts.apply();var deferred=$q.defer();return lan.push(function(err,flags){return err?void error():void success(flags)},supported),deferred.promise}function remove(inx){function success(flags){deferred.resolve(flags)}function error(){deferred.reject()}var deferred=$q.defer();return lan.remove(inx,function(err,flags){return err?void error():void success(flags)}),deferred.promise}function isValid(){return $scope.form.$valid}function isChange(){return lan.isChange()?!0:$scope.lanForm.dhcpPorts&&$scope.lanForm.dhcpPorts.isChange()?!0:!1}function isDynamicAddress(){return"Dynamic"===$scope.lan.data[1].IPv4.AddressingMode}function isLocalDomainUsedForLoad(){return $location.$$host===$scope.lan.data[1].IPv4.StaticIP[1].AddnHostname}function isNotification(){var notices=lan["interface"].getNotices();return notices.length}function callNotification(){function callNotice(notices,inx){function end(inx){notices.length==inx+1?success():callNotice(notices,inx+1).then(success,error)}function success(){deferred.resolve()}function error(msg){deffered.reject(msg)}var params,deferred=$q.defer(),elem=notices[inx];switch(elem.name){case"dhcp_is_incorrect_pool":params=elem.notice.params(),params.ranges.length?ngDialog.open({template:"dialogs/dhcp_server_address_pool/dialog.tpl.html",className:"IPv6"==$scope.lanForm.ipVersion?"dhcp_pool_v6":"",controller:"DHCPServerAddressPoolDialogCtrl",scope:$scope,data:params}).closePromise.then(function(data){data.value&&elem.notice.correct(data.value),end(inx)}):end(inx)}return deferred.promise}var notices=lan["interface"].getNotices();return callNotice(notices,0).then(function(){var deferred=$q.defer();return $timeout(function(){deferred.resolve()},0),deferred.promise})}function getInterfaceIndex(){return"add"==$scope.lanForm.action?_.keys(lan["interface"].listNew())[0]:"1"}function goToStart(){$state.go("network.lan")}var device=$scope.device,lan=$scope.device.lan,supported=helper.supported.lan(),overlay=$rootScope.overlay.circular,lanDataBeforeChange=funcs.deepClone(lan.data()[1]);$scope.lanForm={supported:helper.supported.lan(),has:function(version){return $scope.lanForm.supported[version]},isShow:function(version){return $scope.lanForm.ipVersion==version},isChange:isChange,isValid:isValid,isNotification:isNotification,isNeedRemove:function(){if(!supported.SUPPORT_MULTI_LAN)return!1;if("edit"!=$scope.lanForm.action)return!1;var allListLen=_.size(lan["interface"].list()),newListLen=_.size(lan["interface"].listNew());return allListLen-newListLen>1},callNotification:callNotification,prepareApply:function(){return checkDhcpServer(),isNotification()?void callNotification().then(apply):void apply()},removeInterface:function(){var inx=$scope.lanForm.inx,overlayId=overlay.start();remove(inx).then(function(flags){return flags=flags||{},$rootScope.$emit("unsavedStop",!0),history.setCleanLastHistory(!0),flags.saveAndReboot&&confirm(translate("msg_warn_save_and_reboot"))?(overlay.stop(overlayId),void device.system.reboot(!0)):void($scope.lanForm.isMultiInterfaces?(overlay.stop(overlayId),goToStart()):activate(!0,overlayId))})}},$scope.lanForm.isMultiInterfaces=/network.lanInterface/.test($state.current.name),$scope.lanForm.action="network.lanInterface.add"==$state.current.name?"add":"edit",$scope.lanForm.ipVersion=$state.params.ipversion?$state.params.ipversion:"IPv4",$scope.lanForm.isPageLoad=!1,$scope.$on("$destroy",function(){lan.clean(),lan["interface"].clean()}),$scope.$on("lan.interface.change",function($event,value){$scope.lanForm.inx=value,lan["interface"].change(value,!0),$scope.$broadcast("lan.interface.update",value)}),$scope.$on("lan.interface.ip.change",function($event,value){$scope.lanForm.ipVersion=value,$scope.$broadcast("lan.ipversion",value)}),activate(),$rootScope.$on("ngDialog.opened",function(e,$dialog){$scope.lan_ip_dialog_id===$dialog.attr("id")&&($rootScope.deviceMonitorConfig.definitelyLostThreshold=-1,$scope.lan_ip_dialog_cb())})}])}();
;"use strict";!function(){angular.module("app").controller("lanHeaderCtrl",["$scope","$state","$q","$timeout","translate","lanHelper",function($scope,$state,$q,$timeout,translate,helper){function activate(){var iface=$scope.device.lan["interface"],current=iface.getCurrent();_.isNull(current)||$scope.lanForm.view.ip.init(current.data)}var supported=helper.supported.lan();$scope.lanForm.view={},$scope.lanForm.view.ip={list:[],state:null,init:function(iface){function addState(vers){this.list.push({value:vers,description:vers})}function hasState(iface,vers){return iface[vers]&&!_.isEmpty(iface[vers])&&supported[vers]}this.list.length=0,hasState(iface,"IPv4")&&addState.call(this,"IPv4"),hasState(iface,"IPv6")&&addState.call(this,"IPv6"),this.list.length&&_.isNull(this.state)&&(this.state=$state.params.ipversion?$state.params.ipversion:this.list[0].value)},changePrepare:function(){function check(){var deferred=$q.defer();return $scope.lanForm.isValid()?deferred.resolve(!0):($timeout(function(){alert(translate("msg_invalid_form")),$scope.$emit("goToErrorForm",!0)},0),deferred.resolve(null)),deferred.promise}return $scope.lanForm.isNotification()?$scope.lanForm.callNotification().then(check):check()},changeSuccess:function(toView){this.state=toView,$scope.$emit("lan.interface.ip.change",toView),$state.go(".",{ipversion:toView},{notify:!1})},isShow:function(){return this.list.length>1}},activate(),$scope.$on("lan.update",activate)}])}();
;"use strict";!function(){angular.module("app").controller("lanInterfaceCtrl",["$scope",function($scope){$scope.lan={data:null,interfaceCount:0}}])}();
;"use strict";!function(){angular.module("app").controller("lanInterfaceListCtrl",["$scope","$state","$q","$timeout","translate","lanHelper",function($scope,$state,$q,$timeout,translate,helper){function activate(){var iface=$scope.device.lan["interface"],current=iface.getCurrent();if(!_.isNull(current)){var newInterfaces=iface.listNew(),allInterfaces=iface.list(),current=iface.getCurrent();$scope.lanForm["interface"].init(current,newInterfaces,allInterfaces)}}var supported=helper.supported.lan();$scope.lanForm["interface"]={listLen:0,listNew:[],state:null,data:null,init:function(current,newInterfaces,allInterfaces){this.listLen=_.size(allInterfaces),this.listNew.length=0,_.each(newInterfaces,function(iface,instance){this.listNew.push({value:instance,description:iface.__vlanName})},this),this.state=$scope.lanForm.inx,this.data=current.data},change:function(){$scope.$emit("lan.interface.change",this.state)},isShowCard:function(){return this.listLen>1},isShowList:function(){return this.listNew.length>1},isShowInput:function(){return 1==this.listNew.length},isShowVlan:function(){return supported.SUPPORT_MULTI_LAN}},activate(),$scope.$on("lan.update",activate)}])}();
;"use strict";!function(){angular.module("app").controller("lanIPv4Ctrl",["$scope","$state","ngDialog","lanHelper","devinfo","cookie","funcs",function($scope,$state,ngDialog,helper,devinfo,cookie){function update(){iface=lan["interface"].getCurrent(),iface&&$scope.ipv4.update(iface.ipv4)}var iface,lan=$scope.device.lan,supported=helper.supported.ipv4(),constraints=helper.constraints.ipv4(),isAPMode="ap"===cookie.get("device_mode");$scope.ipv4={isActive:!1,supported:supported,constraints:constraints,util:null,data:null,addressingModes:function(){return _.filter(constraints.addressingModes,function(obj){return _.contains(supported.AddressingModeAvailable,obj.value)})}(),update:function(util){this.util=util,this.data=this.util.data(),this.staticIP.update(util.staticIP),this.dhcp.update(util.dhcp)},getMinHosts:function(){return"Disable"==$scope.ipv4.dhcp.data.Mode?constraints.MinHostsDhcpOff:constraints.MinHosts}},$scope.ipv4.staticIP={util:null,list:[],basic:{instance:null,data:null},alias:{instance:null,data:null},hasAlias:function(){return _.size(this.list)>1},update:function(util){this.util=util,this.util.setOptions({MinHosts:constraints.MinHosts,MinHostsDhcpOff:constraints.MinHostsDhcpOff,MaxHosts:constraints.MaxHosts}),this.list=this.util.list(),this.basic.instance="1",this.basic.data=this.util.get("1"),this.hasAlias()&&(this.alias.instance="2",this.alias.data=this.util.get("2"))},validation:function(value,param,obj){var conflicts,data=obj.data,instance=obj.instance;if(!data)return null;var dhcpOffFlag="Disable"==$scope.ipv4.dhcp.data.Mode?!0:!1,errors=this.util.validation(data,dhcpOffFlag,constraints.MinHosts,isAPMode);return errors[param].length?errors[param][0]:"Address"==param&&(conflicts=this.util.conflicts(instance),conflicts.length)?"lan_error_subnet_conflicts":null},isDisabled:function(){return $scope.ipv4.data&&$scope.ipv4.data.AddressingMode?"Static"!=$scope.ipv4.data.AddressingMode:!1}},$scope.ipv4.dhcp={util:null,data:null,modes:function(){return $scope.ipv4.supported.AddressingMode?_.without(constraints.dhcp.modes,_.findWhere(constraints.dhcp.modes,{value:"Relay"})):constraints.dhcp.modes}(),update:function(util){this.util=util,this.data=this.util.data()},validation:function(value,param){if(!this.data)return null;var errors=this.util.validation(this.data,constraints.MinHosts,isAPMode);return errors[param].length?errors[param][0]:null},validationOnSubmit:function(value,param){return $scope.form.submitted?this.validation(value,param):!1},disabled:function(addrMode){return addrMode?"Dynamic"==addrMode&&autoconf.BR2_PACKAGE_ANWEB_DSYSINIT:!1},isMultiRelay:function(){return!autoconf.BR2_PACKAGE_ANWEB_DSYSINIT}},update(),function(){$scope.hostNameExample=isAPMode?"dlinkap.local./":"dlinkrouter.local./"}(),$scope.$on("lan.update",update),$scope.$on("lan.interface.update",update),$scope.$on("lan.ipversion",function($event,version){$scope.ipv4.isActive="IPv4"==version})}])}();
;"use strict";!function(){angular.module("app").controller("lanIPv6Ctrl",["$scope","$state","ngDialog","translate","lanHelper","funcs",function($scope,$state,ngDialog,translate,helper){function update(){iface=lan["interface"].getCurrent(),iface&&$scope.ipv6.update(iface.ipv6)}var iface,lan=$scope.device.lan,devMode=lan.deviceMode(),supported=helper.supported.ipv6(),constraints=helper.constraints.ipv6();$scope.ipv6={isActive:!1,supported:supported,addressingModes:function(){return _.filter(constraints.addressingModes,function(obj){return _.contains(supported.AddressingModeAvailable,obj.value)})}(),util:null,data:null,update:function(util){_.isEmpty(util)||(this.util=util,this.data=this.util.data(),this.staticIP.update(util.staticIP),this.dhcp.update(util.dhcp))},getDNSRelay:function(){var iface=lan["interface"].getCurrent();return iface.data.IPv4.DHCP.Server.DNSRelay||!1}},$scope.ipv6.staticIP={list:[],util:null,basic:{instance:null,data:null},update:function(util,instance){this.util=util,this.util.setOptions({minPrefix:constraints.MinPrefix,maxPrefix:constraints.MaxPrefix}),this.list=this.util.list(),this.basic.instance=instance||"1",this.basic.data=this.util.get(this.basic.instance)},isDisabled:function(){return $scope.ipv6.data&&_.has($scope.ipv6.data,"AddressingMode")?"Static"!=$scope.ipv6.data.AddressingMode:!1},getFullIP:function(ip,prefix){return ip+"/"+prefix},addInstance:function(){this.editInstance({},null,"add")},editInstance:function(item,instance,action){if("DHCP"==item.AddressingType)return void alert(translate("lan_ipv6_dyn_cant_edit"));var self=this,util=this.util,options={util:util,instance:instance,action:action?action:"edit",devMode:devMode};(function(options){return ngDialog.open({template:"dialogs/lan_ipv6_address/dialog.tpl.html",controller:"DeviceLanIPv6AddressDialogCtrl",data:options})})(options).closePromise.then(function(output){var obj;output&&output.value&&(_.has(output.value,"write")?(obj=output.value.write,util.set(obj,instance)):_.has(output.value,"remove")&&util.remove([output.value.remove]),self.list=util.list())})},removeInstance:function(items,instances){var self=this,util=this.util,hasDynamic=_.some(items,function(item){return"DHCP"==item.AddressingType});return hasDynamic?void alert(translate("lan_ipv6_dyn_cant_edit")):(util.remove(instances),void(self.list=util.list()))},showAddressingMode:function(){var errors=this.util.validation(this.basic.data);return errors.Address.length||errors.GatewayAddress.length||errors.Prefix.length?!1:"Static"!=$scope.ipv6.data.AddressingMode||$scope.ipv6.data.StaticIP[1].Address&&$scope.ipv6.data.StaticIP[1].Prefix?!0:!1},validation:function(value,param){var data=this.basic.data;if(!data)return null;var errors=this.util.validation(data);return errors[param].length?errors[param][0]:null},isEmpty:function(){return!this.list||!_.size(this.list)}},$scope.ipv6.dhcp={util:null,data:null,modes:constraints.dhcp.modes,autoconfigurationModes:constraints.dhcp.autoconfigurationModes,update:function(util){this.util=util,this.data=this.util.data()},validation:function(value,param){if(!this.data)return null;var errors=this.util.validation(this.data);return errors[param].length?errors[param][0]:null},validationOnSubmit:function(value,param){return $scope.form.submitted?this.validation(value,param):!1}},$scope.ipv6.dhcp.server={supported:supported.DHCP.Server,isShow:function(param){var data=$scope.ipv6.dhcp.data.Server;if(1!=this.supported[param])return!1;switch(param){case"MinAddress":case"MaxAddress":if("Stateless"==data.AutoconfigurationMode)return!1}return!0},isDisabled:function(param){if(!$scope.ipv6.data)return!1;switch(param){case"LeaseTime":if("PD"==$scope.ipv6.data.AddressingMode)return!0}return!1}},update(),$scope.$on("lan.update",update),$scope.$on("lan.interface.update",update),$scope.$on("lan.ipversion",function($event,version){$scope.ipv6.isActive="IPv6"==version})}])}();
;"use strict";!function(){angular.module("app").controller("lanListCtrl",["$scope","$state","$q","translate","device","lanHelper",function($scope,$state,$q,translate,device,helper){$scope.lan.ifacesInfo={supported:helper.supported.lan(),list:null,add:function(){$state.go("network.lanInterface.add")},edit:function(elem){$state.go("network.lanInterface.edit",{inx:elem.__id})},getShort:function(elem){var result=[];return elem.ipv4&&result.push("IPv4: "+elem.ipv4),elem.ipv6&&result.push("IPv6: "+elem.ipv6),result.join("<br>")},disableCreateNewInterface:function(){var list=device.lan["interface"].list();return _.every(list,function(elem){return!elem.__isNewInterface})},hideCreateNewInterface:function(){return!info.supported.SUPPORT_MULTI_LAN}};var info=$scope.lan.ifacesInfo;info.list=function(){function makeIPList(elem,version){var ip=elem[version];return ip&&ip.StaticIP&&_.size(ip.StaticIP)?_.map(ip.StaticIP,function(obj){var result=obj.Address?obj.Address:"-";return result+="/",result+=obj.SubnetMask||obj.Prefix?obj.SubnetMask||obj.Prefix:"-"}):"-"}var list=device.lan["interface"].list();return _.chain(list).map(function(elem,id){var result={};return result.__id=id,result.__isNewInterface=elem.__isNewInterface,result.name=elem.Name,info.supported.IPv4&&(result.ipv4=makeIPList(elem,"IPv4")),info.supported.IPv6&&(result.ipv6=makeIPList(elem,"IPv6")),result}).filter(function(elem){return!elem.__isNewInterface}).value()}()}])}();
;"use strict";!function(){angular.module("app").factory("lanHelper",["lanSupported","lanConstraints",function(supported,constraints){return{supported:supported,constraints:constraints}}])}();
;"use strict";!function(){angular.module("app").constant("lanConstants",{REBOOT_TIME:autoconf.BR2_PACKAGE_ANWEB_DEVICE_REBOOT_TIME?parseInt(autoconf.BR2_PACKAGE_ANWEB_DEVICE_REBOOT_TIME):void 0,DSYSINIT:autoconf.BR2_PACKAGE_ANWEB_DSYSINIT})}();
;"use strict";!function(){angular.module("app").controller("lanStaticAddressesCtrl",["$scope","$state","ngDialog","lanHelper",function($scope,$state,ngDialog,helper){function update(){var iface=lan["interface"].getCurrent();iface&&("ipv4"==ipVersion&&$scope.staticAddresses.update(iface.ipv4.dhcp.staticAddress),"ipv6"==ipVersion&&$scope.staticAddresses.update(iface.ipv6.dhcp.staticAddress))}var lan=$scope.device.lan,ipVersion=$scope.ipv4&&$scope.ipv4.isActive?"ipv4":"ipv6",supported=$scope.ipv4&&$scope.ipv4.isActive?helper.supported.ipv4():helper.supported.ipv6();$scope.staticAddresses={supported:supported.DHCP.Server.StaticAddress,list:{},isEmpty:function(){return this.list&&0==_.size(this.list)},reset:function(){this.list={};var rules=this.util.list();_.each(rules,function(rule,instance){"cut"!=this.util.getInstanceState(instance)&&(this.list[instance]=rule)},this)},update:function(util){this.util=util,this.mode=util.mode(),this.reset()},onAdd:function(){this.dialog({action:"add",version:ipVersion})},onEdit:function(item,instance){this.dialog({action:"edit",data:item,version:ipVersion,instance:instance})},onDelete:function(items,instances){_.each(instances,function(instance){"add"==this.util.getInstanceState(instance)?this.util.remove(instance):this.util.cut(instance)},this),this.reset()},onSelectClients:function(){this.dialogSelectClients({ipversion:ipVersion,comment:"lan_dhcp_stat_addr_select_clients_comment"})},getMiniInfo:function(item){var info="";return item.MACAddress&&(info+=item.MACAddress),item.MACAddress&&item.Hostname&&(info+="/"),item.Hostname&&(info+=item.Hostname),info},dialog:function(options){var self=this;(function(options){return ngDialog.open({template:"dialogs/dhcp_static_address/dialog.tpl.html",controller:"DHCPStaticAddressDialogCtrl",scope:$scope,data:options})})(options).closePromise.then(function(dialogData){var util=self.util,result=dialogData.value;if(!_.isNull(result)){switch(result.action){case"add":util.add(result.data);break;case"edit":util.cut(result.instance),util.set(result.data,result.instance);break;case"remove":"add"==util.getInstanceState(result.instance)?util.remove(result.instance):util.cut(result.instance)}self.reset()}})},dialogSelectClients:function(options){function normalization(item){var result={},host=item.host?item.host:item.hostname?item.hostname:"";return result.IPAddress=item.ip?item.ip:"",result.MACAddress=item.mac?item.mac.toUpperCase():"",result.Hostname=host,result.Mode=item.mode?item.mode:"",result}function filterUniq(arr){var result=[];return _.each(arr,function(elem){var checkUniq=0;_.each(result,function(item){(elem.IPAddress==item.IPAddress||elem.Hostname==item.Hostname||elem.MACAddress==item.MACAddress)&&checkUniq++}),0==checkUniq&&result.push(elem)}),result}var self=this;(function(options){return ngDialog.open({template:"dialogs/device_clients_list/dialog.tpl.html",controller:"DeviceClientsListDialogCtrl",data:options})})(options).closePromise.then(function(dialogData){var util=self.util,list=dialogData.value;!_.isNull(list)&&_.isArray(list)&&(list=_.map(list,normalization),list=filterUniq(list),list=_.filter(list,function(item){return!util.isUseRule(item)}),list.length&&(_.each(list,function(item){util.add(item)}),self.reset()))})}},update(),$scope.$on("lan.update",update),$scope.$on("lan.interface.update",update)}])}();
;"use strict";!function(){angular.module("app").controller("lanHostsCtrl",["$scope","$state","ngDialog","lanHelper","funcs",function($scope,$state,ngDialog,helper,funcs){function update(){var iface=lan["interface"].getCurrent();iface&&($scope.ipv4&&$scope.ipv4.isActive&&$scope.hosts.update(iface.ipv4.dns),$scope.ipv6&&$scope.ipv6.isActive&&$scope.hosts.update(iface.ipv6.dns))}var lan=$scope.device.lan,supported=$scope.ipv4&&$scope.ipv4.isActive?helper.supported.ipv4():helper.supported.ipv6();$scope.hosts={supported:supported&&supported.DNS,list:{},isEmpty:function(){return this.list&&0==_.size(this.list)},reset:function(){this.list={};var rules=this.util.list();_.each(rules,function(rule,instance){"cut"!=this.util.getInstanceState(instance)&&(this.list[instance]=rule)},this)},update:function(util){this.util=util,this.reset()},onAdd:function(){this.dialog()},onEdit:function(item,instance){var host={ip:item.IPAddress,hostname:item.Hostname,inst:item.__Inst};this.dialog(host,instance)},onDelete:function(items,instances){_.each(instances,function(inst){"add"==this.util.getInstanceState(inst)?this.util.remove(inst):this.util.cut(inst)},this),this.reset()},dialog:function(host,inx){function getIPs(host){var useIps=_.pluck($scope.hosts.list,"IPAddress");return useIps=host?_.without(useIps,host.ip)||[]:useIps,_.map(useIps,function(ip){return $scope.ipv4&&$scope.ipv4.isActive?{IPv4Address:ip}:{IPv6Address:ip}})}var self=this;(function(host){return ngDialog.open({template:"dialogs/dns_hosts/dialog.tpl.html",controller:"DnsHostsDialogCtrl",resolve:funcs.getLazyResolve("dialogs/dns_hosts/ctrl.lazy.js","DnsHostsDialogCtrl"),data:{host:host,version:$scope.ipv4&&$scope.ipv4.isActive?"ipv4":"ipv6",allHostnames:_.pluck($scope.hosts.list,"Hostname"),allIps:getIPs(host),checkStaticAddr:!0},scope:$scope})})(host,inx).closePromise.then(function(dialogData){var hostElem,util=self.util,result=dialogData.value;result&&"save"==result.status&&result.host&&(hostElem={IPAddress:result.host.ip,Hostname:result.host.hostname,__Inst:result.host.inst},host&&$scope.hosts.list[inx]?(util.cut(inx),util.set(hostElem,inx)):util.add(hostElem)),self.reset()})}},update(),$scope.$on("lan.update",update),$scope.$on("lan.interface.update",update)}])}();
;"use strict";!function(){angular.module("app").controller("lanDhcpOptionsCtrl",["$scope","$state","ngDialog","lanHelper","dhcpCustomOpts",function($scope,$state,ngDialog,helper,dhcpCustomOpts){function update(){var iface=lan["interface"].getCurrent();iface&&$scope.DHCPOption.update(iface.ipv4.dhcp.DHCPOption)}var lan=$scope.device.lan,supported=$scope.ipv4&&$scope.ipv4.isActive&&"Server"==$scope.ipv4.data.DHCP.Mode;$scope.DHCPOption={supported:supported,list:[],isEmpty:function(){return this.list&&0==this.list.length},reset:function(){this.list=this.util.list()},update:function(util){this.util=util,this.mode=util.mode(),this.reset()},addRule:function(){this.dialog({action:"add"})},editRule:function(item,instance){this.dialog({action:"edit",data:item,instance:instance})},deleteRule:function(items,instances){this.util.remove(instances),this.list=this.util.list()},getOptionName:function(tag){var elem=_.find(dhcpCustomOpts,function(item){return item.tag==tag});return elem?elem.option:""},dialog:function(options){var self=this;(function(options){return ngDialog.open({template:"dialogs/dhcp_options/dialog.tpl.html",controller:"DHCPOptionsDialogCtrl",scope:$scope,data:options})})(options).closePromise.then(function(dialogData){var util=self.util,result=dialogData.value;if(util.list(),!_.isNull(result)){switch(result.action){case"add":util.add(result.data);break;case"edit":util.set(result.data,result.instance);break;case"remove":util.remove(result.instance)}self.reset()}})}},update(),$scope.$on("lan.update",update),$scope.$on("lan.interface.update",update)}])}();
;"use strict";!function(){angular.module("app").service("dhcpCustomOpts",function(){return[{option:"dhcp_options_select"},{tag:"1",option:"Subnet Mask",description:"dhcp_options_desc_mask",param:"mask",type:"ipv4"},{tag:"3",option:"Router",description:"dhcp_options_desc_more_ip",param:"moreIP",type:"ipv4"},{tag:"6",option:"Domain Server",description:"dhcp_options_desc_more_ip",param:"moreIP",type:"ipv4"},{tag:"7",option:"Log Server",description:"dhcp_options_desc_more_ip",param:"moreIP",type:"ipv4"},{tag:"12",option:"Hostname",description:"dhcp_options_desc_hostname",param:"hostname",type:"text"},{tag:"15",option:"Domain Name",description:"dhcp_options_desc_domain",param:"domain",type:"domain"},{tag:"23",option:"Default IP TTL",description:{lang:"dhcp_options_desc_range",begin:"0",end:"255"},param:"8unsig",type:"dec"},{tag:"26",option:"MTU Interface",description:{lang:"dhcp_options_desc_range",begin:"68",end:"65535"},param:"16unsigMin68",type:"dec"},{tag:"33",option:"Static Route",description:"dhcp_options_desc_ip_ip",param:"ipIp",type:"ipv4"},{tag:"35",option:"ARP Timeout",description:{lang:"dhcp_options_desc_range",begin:"0",end:"2147483647"},param:"32sigMin0",type:"dec"},{tag:"37",option:"Default TCP TTL",description:{lang:"dhcp_options_desc_range",begin:"0",end:"255"},param:"8unsig",type:"dec"},{tag:"38",option:"Keepalive Time",description:{lang:"dhcp_options_desc_range",begin:"0",end:"2147483647"},param:"32sigMin0",type:"dec"},{tag:"40",option:"NIS Domain",description:"dhcp_options_desc_string",param:"string",type:"domain"},{tag:"41",option:"NIS Servers",description:"dhcp_options_desc_more_ip",param:"moreIP",type:"ipv4"},{tag:"42",option:"NTP Servers",description:"dhcp_options_desc_more_ip",param:"moreIP",type:"ipv4"},{tag:"43",option:"Vendor Specific",description:"dhcp_options_desc_vendor",param:"vendor",type:"text"},{tag:"58",option:"Renewal Time",description:{lang:"dhcp_options_desc_range_renewal",begin:"0",end:"4294967295"},param:"32unsig",type:"dec"},{tag:"59",option:"Rebinding Time",description:{lang:"dhcp_options_desc_range_rebinding",begin:"0",end:"4294967295"},param:"32unsig",type:"dec"},{tag:"60",option:"Class Id",description:"dhcp_options_desc_string",param:"string",type:"text"},{tag:"64",option:"NIS-Domain-Name",description:"dhcp_options_desc_string",param:"string",type:"text"},{tag:"65",option:"NIS-Server-Addr",description:"dhcp_options_desc_more_ip",param:"moreIP",type:"ipv4"},{tag:"66",option:"Server-Name",description:"dhcp_options_desc_string",param:"string",type:"text"},{tag:"68",option:"Home-Agent-Addrs",description:"dhcp_options_desc_more_ip",param:"moreIP",type:"ipv4"},{tag:"69",option:"SMTP-Server",description:"dhcp_options_desc_more_ip",param:"moreIP",type:"ipv4"},{tag:"70",option:"POP3-Server",description:"dhcp_options_desc_more_ip",param:"moreIP",type:"ipv4"},{tag:"71",option:"NNTP-Server",description:"dhcp_options_desc_more_ip",param:"moreIP",type:"ipv4"},{tag:"74",option:"IRC-Server",description:"dhcp_options_desc_more_ip",param:"moreIP",type:"ipv4"},{tag:"119",option:"Domain Search",description:"dhcp_options_desc_more_domain",param:"moreDomain",type:"domain"},{tag:"120",option:"SIP Servers DHCP Option",description:"dhcp_options_desc_more_host",param:"moreHost",type:"domain"},{tag:"121",option:"Classless Static Route Option",description:"dhcp_options_desc_ip_mask_ip",param:"ipMaskIp",type:"ipv4"},{tag:"125",option:"V-I Vendor-Specific Information",description:"dhcp_options_desc_hex",param:"hex",type:"hex"}]})}();
;"use strict";!function(){angular.module("app").controller("lanDHCPPortsCtrl",["$scope","lanPortsDHCP","funcs",function($scope,util,funcs){function init(){util.pull().then(function(){dhcpPorts.ports=util.getData(),dhcpPorts.dhcp.length=0,_.each(dhcpPorts.ports,function(port,inx){return port.EnableDHCP?void dhcpPorts.dhcp.push({key:inx,item:port}):!1}),initData=funcs.deepClone(dhcpPorts.dhcp)})}function isChange(){function getKeys(list){return _.chain(list).map(function(item){return item.item.__key}).sortBy().value()}return initData&&!_.isEqual(getKeys(initData),getKeys(dhcpPorts.dhcp))}function updateEnableDHCP(){_.each(dhcpPorts.ports,function(port){port.EnableDHCP=_.some(dhcpPorts.dhcp,function(item){return item.item.__key==port.__key})})}$scope.lanForm.dhcpPorts={ports:null,dhcp:[],apply:function(){updateEnableDHCP(),util.apply(dhcpPorts.ports).then(function(){init()})},isChange:isChange};var dhcpPorts=$scope.lanForm.dhcpPorts,initData=null;init()}])}();
;"use strict";!function(){angular.module("app").service("macFilterUtil",["somovd","devinfo","device","funcs",function(somovd,devinfo,device,funcs){function getConfig(){return config}function applyConfig(changed){var helper=makeHelper(),macfilter=converter.nativeToSomovd(changed),somovdRequests=helper.makeSomovdRequests(macfilter,__initMacfilter);return somovd.multi(somovdRequests)}function makeHelper(){return new Helper}var config=null,__initMacfilter=null,Helper=device.macfilter.Helper,converter=device.macfilter.converter;return{getConfig:getConfig,getAttrs:function(){return null},pull:function(){return Promise.all([somovd.read([74]),devinfo.once("client")]).then(function(response){if(!funcs.is.allRPCSuccess(response[0]))return Promise.reject();var macfilter=response[0].rq[0]?response[0].rq[0].data.macfilter:null,ifaces=response[0].rq[1]?response[0].rq[1].data.iface_names:null,client=response[1]?response[1].client:null;return config=converter.somovdToNative({macfilter:macfilter,ifaces:ifaces,client:client}),__initMacfilter=funcs.deepClone(macfilter),Promise.resolve()})},getClient:function(){return devinfo.once("client").then(function(response){return response&&response.client?converter.somovdToNative({client:response.client}):Promise.resolve()})},applyConfig:applyConfig,makeHelper:makeHelper}}])}();
;"use strict";!function(){angular.module("app").service("miscUtil",["somovd","device","funcs",function(somovd,device,funcs){var config={},rpcs=[],constants={CONFIG_ID_NETFILTER:183,CONFIG_ID_PPPOE_PASS_THROUGH:188,CONFIG_ID_RLX_IPTV_QOS:240};return rpcs.push({key:"netfilter",num:constants.CONFIG_ID_NETFILTER}),rpcs.push({key:"passThrough",num:constants.CONFIG_ID_PPPOE_PASS_THROUGH}),rpcs.push({key:"rlxIptvQos",num:constants.CONFIG_ID_RLX_IPTV_QOS}),{pull:function(){return somovd.read(rpcs.map(function(rpc){return rpc.num}),function(response){rpcs.forEach(function(rpc,inx){config[rpc.key]=response.rq[inx].data})})},apply:function(settings){return somovd.write(rpcs.map(function(rpc){return{id:rpc.num,data:settings[rpc.key],pos:-1}}),function(response){return funcs.is.allRPCSuccess(response)?Promise.resolve():Promise.reject()})},getConfig:function(){return config}}}])}();
;"use strict";!function(){angular.module("app").service("noticeUtil",["notice",function(notice){return{subscribe:notice.subscribe,getList:notice.getList}}])}();
;"use strict";!function(){angular.module("app").service("PortSettingsUtil",["somovd","device","devinfo","funcs",function(somovd,device,devinfo,funcs){function makeHelper(){return new device.portSettings.Helper(config)}var config=null,converter=device.portSettings.converter,constants={portSettingsRPC:175,FIBER_WAN:autoconf.BR2_PACKAGE_ANWEB_FIBER};return{pull:function(){function readCb(response){return funcs.is.allRPCSuccess(response)?(config=response.rq[0].data,config=converter.somovdToNative(config,constants),config.ports=funcs.sortPortsSomovd(config.ports),Promise.resolve()):Promise.reject()}return somovd.read([constants.portSettingsRPC],readCb)},apply:function(input){var data=converter.nativeToSomovd(input);return somovd.write(constants.portSettingsRPC,data,-1,function(response){return funcs.is.allRPCSuccess(response)?Promise.resolve():Promise.reject(response.error)})},subscribe:function(cb,$scope){devinfo.subscribe(constants.portSettingsRPC.toString(),function(response){if(response&&response[constants.portSettingsRPC.toString()]){var ports=converter.somovdToNative(response[constants.portSettingsRPC.toString()],constants),helper=device.portSettings.Helper(ports);ports=funcs.sortPortsSomovd(helper.getData()),cb&&cb(ports)}},$scope)},makeHelper:makeHelper,getSpeedList:function(port){var result=[];return result.push("auto"),port.advertisement&&(result=result.concat(port.speedList)),result}}}])}();
;"use strict";!function(){angular.module("app").service("raccessUtil",["somovd","device","funcs","navigationFilter",function(somovd,device,funcs,navigationFilter){function getConfig(){return config?config:{}}function getAttrs(){return attrs?attrs:{}}var config=null,attrs=null,__initSomovdConfig=null,raccessConstants={SUPPORT_ERTELECOM:autoconf.BR2_PACKAGE_ANWEB_CUSTOM_ERTELECOM_23157,SUPPORT_TELNET:autoconf.BR2_PACKAGE_ANWEB_TELNET,SUPPORT_SSH:autoconf.BR2_PACKAGE_ANWEB_SSH,SUPPORT_HTTP:!autoconf.BR2_PACKAGE_ANWEB_HTTPS_ONLY,SUPPORT_HTTPS:autoconf.BR2_PACKAGE_ANWEB_HTTPS,SUPPORT_FTP:autoconf.BR2_PACKAGE_ANWEB_FTP,SUPPORT_SAMBA:autoconf.BR2_PACKAGE_ANWEB_SAMBA,SUPPORT_BCM:autoconf.BR2_PACKAGE_ANWEB_BCM_MODEM,SUPPORT_RLX:autoconf.BR2_PACKAGE_ANWEB_REALTEK,SUPPORT_MODEMS:autoconf.BR2_PACKAGE_ANWEB_REALTEK_MODEM,SUPPORT_CUSTOM_GOODLINE:autoconf.BR2_PACKAGE_ANWEB_CUSTOM_GOODLINE_21218,CUSTOM_PARTNER_23078:autoconf.BR2_PACKAGE_ANWEB_CUSTOM_PARTNER_23078,SUPPORT_REMOTE_ACCESS_WAN_IFACES:autoconf.BR2_PACKAGE_ANWEB_REMOTE_ACCESS_WAN,CUSTOM_ISRAEL_35327:autoconf.BR2_PACKAGE_ANWEB_CUSTOM_ISRAEL_35327},converter=device.raccess.converter,constants=_.extend({CONFIG_ID_DSL_VSERVERS:10,CONFIG_ID_HTTPACCESS:16,CONFIG_ID_WAN_TEMP:1,CONFIG_ID_TR69:70,CONFIG_ID_SSHD:218},raccessConstants),customRules=navigationFilter.rules(),rpcs=[{Key:"rules",Id:constants.CONFIG_ID_HTTPACCESS,Path:"httpaccess"},{Key:"ifaces",Id:constants.CONFIG_ID_WAN_TEMP},{Key:"vservers",Id:constants.CONFIG_ID_DSL_VSERVERS,Path:"vserver"}];return rpcs.push({Key:"tr69",Id:constants.CONFIG_ID_TR69}),{pull:function(){function success(response){var input={};_.each(rpcs,function(rpc,inx){var rq=response.rq[inx]&&response.rq[inx].data;input[rpc.Key]=rq&&rpc.Path&&rq[rpc.Path]||rq}),input.ipv6Avail=autoconf.BR2_PACKAGE_ANWEB_IPV6;var inputAttrs=angular.copy(constants);return input.ssh&&(inputAttrs.SSH_PORT=input.ssh.port.toString()),input.tr69&&(inputAttrs.TR_PORT=input.tr69.ConnReqPort.toString()),customRules.RAccessTrPort&&(inputAttrs.TR_PORT=customRules.RAccessTrPort),console.log("input",input),config=converter.somovdToNative(input),attrs=converter.attrsToNative(inputAttrs),__initSomovdConfig=funcs.deepClone(input.rules),funcs.deepClone(config),Promise.resolve()}return somovd.read(_.pluck(rpcs,"Id")).then(success)},getConfig:getConfig,getAttrs:getAttrs,removeRules:function(items){var indexes=_.pluck(items,"__id"),removeList=function(indexes){return indexes=indexes.sort().reverse(),_.map(indexes,function(index){return{id:constants.CONFIG_ID_HTTPACCESS,data:__initSomovdConfig[index],pos:index}})}(indexes);return somovd.remove(removeList,function(response){return funcs.is.allRPCSuccess(response)?Promise.resolve():Promise.reject()})},applyRule:function(rule){var data=converter.nativeToSomovd(rule),index=_.isUndefined(rule.__id)?-1:rule.__id;return somovd.write(constants.CONFIG_ID_HTTPACCESS,data,index,function(response){return funcs.is.allRPCSuccess(response)?Promise.resolve():Promise.reject()})}}}])}();
;"use strict";!function(){angular.module("app").service("redirectUtil",["funcs","device","somovd",function(funcs,device,somovd){var RPC=162,converter=device.redirect.converter;return{pull:function(){return somovd.read(RPC).then(function(response){if(!funcs.is.RPCSuccess(response))return Promise.reject();var redirect=converter.somovdToNative(response.data);return Promise.resolve(redirect)})},apply:function(redirect){var config=converter.nativeToSomovd(redirect);return somovd.write(RPC,config,-1,function(response){return funcs.is.RPCSuccess(response)?Promise.resolve():Promise.reject()})},getModulesList:function(){return["Cable","Factory","Connections","Configuring"]}}}])}();
;"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};!function(){angular.module("app").service("routingUtil",["somovd","device","funcs","translate",function(somovd,device,funcs){function getConfig(){return config}var config=null,consts={CONFIG_ID_ROUTING:17,CONFIG_ID_DOS_FILTER:251},converter=device.routing.converter;return{getConfig:getConfig,getAttrs:function(){return null},pull:function(){var rpcs=[consts.CONFIG_ID_ROUTING,autoconf.CONFIG_ID_WAN_IFACES_LIST];return somovd.read(rpcs).then(function(response){return funcs.is.RPCSuccess(response.rq[0])&&funcs.is.RPCSuccess(response.rq[1])?(config=converter.somovdToNative({routes:response.rq[0].data.route,ifaces:response.rq[1].data,hwIPv6Route:response.rq[2]&&response.rq[2].data?response.rq[2].data:void 0,isSupportIPv6:autoconf.BR2_PACKAGE_ANWEB_IPV6}),Promise.resolve()):Promise.reject()})},removeRules:function(items){var indexes=_.pluck(items,"__id"),removeList=function(indexes){return indexes=indexes.sort().reverse(),_.map(indexes,function(index){return{id:consts.CONFIG_ID_ROUTING,data:{},pos:index}})}(indexes);return somovd.remove(removeList,function(response){return funcs.is.allRPCSuccess(response)?Promise.resolve():Promise.reject()}),Promise.resolve()},applyRule:function(rule,id){var convertRules=converter.nativeToSomovd({Routes:[rule]});return convertRules&&0!=convertRules.length?somovd.write(consts.CONFIG_ID_ROUTING,convertRules[0],_.isUndefined(id)||_.isNull(id)?-1:id).then(function(response){return funcs.is.allRPCSuccess(response)?Promise.resolve():Promise.reject()}):Promise.reject()},applyHwRoute:function(route){return somovd.write(consts.CONFIG_ID_DOS_FILTER,route,-1).then(function(response){return funcs.is.RPCSuccess(response)?Promise.resolve():Promise.reject()})}}}])}();
;"use strict";!function(){angular.module("app").constant("SysNtpConstants",{zones:[{offset:"-12:00",name:"ntp_gmt_m1200"},{offset:"-11:00",name:"ntp_gmt_m1100"},{offset:"-10:00",name:"ntp_gmt_m1000"},{offset:"-09:00",name:"ntp_gmt_m0900"},{offset:"-08:00",name:"ntp_gmt_m0800"},{offset:"-07:00",name:"ntp_gmt_m0700_1"},{offset:"-07:00",name:"ntp_gmt_m0700_2"},{offset:"-06:00",name:"ntp_gmt_m0600_1"},{offset:"-06:00",name:"ntp_gmt_m0600_2"},{offset:"-06:00",name:"ntp_gmt_m0600_3"},{offset:"-06:00",name:"ntp_gmt_m0600_4"},{offset:"-05:00",name:"ntp_gmt_m0500_1"},{offset:"-05:00",name:"ntp_gmt_m0500_2"},{offset:"-05:00",name:"ntp_gmt_m0500_3"},{offset:"-04:00",name:"ntp_gmt_m0400_1"},{offset:"-04:00",name:"ntp_gmt_m0400_2"},{offset:"-04:00",name:"ntp_gmt_m0400_3"},{offset:"-03:00",name:"ntp_gmt_m0300_1"},{offset:"-03:00",name:"ntp_gmt_m0300_2"},{offset:"-03:00",name:"ntp_gmt_m0300_3"},{offset:"-03:00",name:"ntp_gmt_m0300_4"},{offset:"-02:00",name:"ntp_gmt_m0200"},{offset:"-01:00",name:"ntp_gmt_m0100_1"},{offset:"-01:00",name:"ntp_gmt_m0100_2"},{offset:"00:00",name:"ntp_gmt_0000_1"},{offset:"00:00",name:"ntp_gmt_0000_2"},{offset:"+01:00",name:"ntp_gmt_p0100_1"},{offset:"+01:00",name:"ntp_gmt_p0100_2"},{offset:"+01:00",name:"ntp_gmt_p0100_3"},{offset:"+01:00",name:"ntp_gmt_p0100_4"},{offset:"+01:00",name:"ntp_gmt_p0100_5"},{offset:"+01:00",name:"ntp_gmt_p0100_6"},{offset:"+02:00",name:"ntp_gmt_p0200_1"},{offset:"+02:00",name:"ntp_gmt_p0200_2"},{offset:"+02:00",name:"ntp_gmt_p0200_3"},{offset:"+02:00",name:"ntp_gmt_p0200_4"},{offset:"+02:00",name:"ntp_gmt_p0200_5"},{offset:"+02:00",name:"ntp_gmt_p0200_6"},{offset:"+02:00",name:"ntp_gmt_p0200_7"},{offset:"+03:00",name:"ntp_gmt_p0300_1"},{offset:"+03:00",name:"ntp_gmt_p0300_2"},{offset:"+03:00",name:"ntp_gmt_p0300_3"},{offset:"+03:00",name:"ntp_gmt_p0300_4"},{offset:"+03:00",name:"ntp_gmt_p0300_5"},{offset:"+03:00",name:"ntp_gmt_p0300_6"},{offset:"+03:30",name:"ntp_gmt_p0330_1"},{offset:"+04:00",name:"ntp_gmt_p0400_1"},{offset:"+04:00",name:"ntp_gmt_p0400_2"},{offset:"+04:00",name:"ntp_gmt_p0400_3"},{offset:"+04:30",name:"ntp_gmt_p0430"},{offset:"+05:00",name:"ntp_gmt_p0500_1"},{offset:"+05:00",name:"ntp_gmt_p0500_2"},{offset:"+05:30",name:"ntp_gmt_p0530"},{offset:"+05:45",name:"ntp_gmt_p0545"},{offset:"+06:00",name:"ntp_gmt_p0600_1"},{offset:"+06:00",name:"ntp_gmt_p0600_2"},{offset:"+06:00",name:"ntp_gmt_p0600_3"},{offset:"+06:30",name:"ntp_gmt_p0630"},{offset:"+07:00",name:"ntp_gmt_p0700_1"},{offset:"+07:00",name:"ntp_gmt_p0700_2"},{offset:"+08:00",name:"ntp_gmt_p0800_1"},{offset:"+08:00",name:"ntp_gmt_p0800_2"},{offset:"+08:00",name:"ntp_gmt_p0800_3"},{offset:"+08:00",name:"ntp_gmt_p0800_4"},{offset:"+08:00",name:"ntp_gmt_p0800_5"},{offset:"+09:00",name:"ntp_gmt_p0900_1"},{offset:"+09:00",name:"ntp_gmt_p0900_2"},{offset:"+09:00",name:"ntp_gmt_p0900_3"},{offset:"+09:30",name:"ntp_gmt_p0930_1"},{offset:"+09:30",name:"ntp_gmt_p0930_2"},{offset:"+10:00",name:"ntp_gmt_p1000_1"},{offset:"+10:00",name:"ntp_gmt_p1000_2"},{offset:"+10:00",name:"ntp_gmt_p1000_3"},{offset:"+10:00",name:"ntp_gmt_p1000_4"},{offset:"+10:00",name:"ntp_gmt_p1000_5"},{offset:"+11:00",name:"ntp_gmt_p1100"},{offset:"+12:00",name:"ntp_gmt_p1200_1"},{offset:"+12:00",name:"ntp_gmt_p1200_2"},{offset:"+13:00",name:"ntp_gmt_p1300"}],weekDays:[{label:"ntp_short_mon",value:"1"},{label:"ntp_short_tue",value:"2"},{label:"ntp_short_wed",value:"3"},{label:"ntp_short_thu",value:"4"},{label:"ntp_short_fri",value:"5"},{label:"ntp_short_sat",value:"6"},{label:"ntp_short_sun",value:"0"}]})}();
;"use strict";!function(){angular.module("app").service("tr069Util",["funcs","device","somovd",function(funcs,device,somovd){function getConfig(){return config?(_.each(config.ifaces,function(iface,key){("ipv6"==iface.type||"pppv6"==iface.type)&&(config.ifacesList=_.without(config.ifacesList,key))}),config):{}}var config,converter=device.tr69.converter,rpcs={ifaces:1,tr:70};return{pull:function(){return somovd.read([rpcs.ifaces,rpcs.tr]).then(function(response){var data;return funcs.is.allRPCSuccess(response)?(data={ifaces:response.rq[0].data.iface_names,tr69:response.rq[1].data},config=converter.somovdToNative(data),Promise.resolve()):Promise.reject()})},apply:function(settings){var data=converter.nativeToSomovd(settings);return somovd.write(rpcs.tr,data,-1,function(response){return funcs.is.RPCSuccess(response)?Promise.resolve():Promise.reject()})},getConfig:getConfig}}])}();
;"use strict";!function(){angular.module("app").service("urlfilterUtil",["somovd","device","funcs",function(somovd,device,funcs){function makeHelper(){return new device.urlfilter.Helper(config,list)}var config=null,list=null,constants={CONFIG_ID_GET_URLF_CONFIG:71,CONFIG_ID_GET_URL_LIST:72};return{pull:function(){return somovd.read([constants.CONFIG_ID_GET_URLF_CONFIG,constants.CONFIG_ID_GET_URL_LIST],function(response){if(!funcs.is.allRPCSuccess(response))return Promise.reject();var rq=response.rq;return config=rq[0].data.urlsettings?rq[0].data.urlsettings:rq[0].data,list=funcs.deepClone(rq[1].data),Promise.resolve()})},push:function(settings){function getConfigRequest(config){return{id:constants.CONFIG_ID_GET_URLF_CONFIG,data:config,pos:-1}}function getListRequest(settings){var listsRequest=settings;return _.map(listsRequest,function(list){return list.id=constants.CONFIG_ID_GET_URL_LIST,list}),listsRequest}var requests=function(settings){var write=[],remove=[];settings.write&&_.each(settings.write,function(elem){elem.config&&write.push(getConfigRequest(elem.config)),elem.list&&(write=write.concat(getListRequest(elem.list)))}),settings.remove&&(remove=remove.concat(getListRequest(settings.remove)));var result={};return write.length&&(result.write=write),remove.length&&(result.remove=remove),result}(settings);return somovd.multi(requests,!1,function(response){return funcs.is.allRPCSuccess(response)?Promise.resolve():Promise.reject()})},makeHelper:makeHelper,needPrepareSettings:function(){return!0},applyDisabling:function(){return!1}}}])}();
;"use strict";!function(){angular.module("app").service("vserversTemplate",[function(){return[{Name:"Custom",Type:"custom",ProtocolList:["TCP","UDP","TCP/UDP"],Source:{Ports:{1:{Start:"",End:""}}},Dest:{Ports:{1:{Start:"",End:""}}}},{Name:"HTTP",Type:"http",ProtocolList:["TCP"],Source:{Ports:{1:{Start:"80",End:""}}},Dest:{Ports:{1:{Start:"80",End:""}}}},{Name:"HTTPS",Type:"https",ProtocolList:["TCP"],Source:{Ports:{1:{Start:"443",End:""}}},Dest:{Ports:{1:{Start:"443",End:""}}}},{Name:"DNS",Type:"dns",ProtocolList:["UDP"],Source:{Ports:{1:{Start:"53",End:""}}},Dest:{Ports:{1:{Start:"53",End:""}}}},{Name:"SMTP",Type:"smtp",ProtocolList:["TCP"],Source:{Ports:{1:{Start:"25",End:""}}},Dest:{Ports:{1:{Start:"25",End:""}}}},{Name:"POP3",Type:"pop3",ProtocolList:["TCP"],Source:{Ports:{1:{Start:"110",End:""}}},Dest:{Ports:{1:{Start:"110",End:""}}}},{Name:"SSH",Type:"ssh",ProtocolList:["TCP"],Source:{Ports:{1:{Start:"22",End:""}}},Dest:{Ports:{1:{Start:"22",End:""}}}},{Name:"FTP",Type:"ftp",ProtocolList:["TCP"],Source:{Ports:{1:{Start:"20",End:"21"}}},Dest:{Ports:{1:{Start:"20",End:"21"}}}},{Name:"SFTP",Type:"sftp",ProtocolList:["TCP"],Source:{Ports:{1:{Start:"22,115",End:""}}},Dest:{Ports:{1:{Start:"22,115",End:""}}}},{Name:"Telnet",Type:"telnet",ProtocolList:["TCP","UDP","TCP/UDP"],Source:{Ports:{1:{Start:"23",End:""}}},Dest:{Ports:{1:{Start:"23",End:""}}}},{Name:"PPTP",Type:"pptp",ProtocolList:["TCP","UDP","TCP/UDP"],Source:{Ports:{1:{Start:"1723",End:""}}},Dest:{Ports:{1:{Start:"1723",End:""}}}},{Name:"PCAnyWhere",Type:"pcanywhere",ProtocolList:["TCP/UDP"],Source:{Ports:{1:{Start:"5631,5632",End:""}}},Dest:{Ports:{1:{Start:"5631,5632",End:""}}}},{Name:"VNC",Type:"vnc",ProtocolList:["TCP","UDP","TCP/UDP"],Source:{Ports:{1:{Start:"5900",End:""}}},Dest:{Ports:{1:{Start:"5900",End:""}}}},{Name:"TFTP",Type:"tftp",ProtocolList:["UDP"],Source:{Ports:{1:{Start:"69",End:""}}},Dest:{Ports:{1:{Start:"69",End:""}}}},{Name:"RDP",Type:"rdp",ProtocolList:["TCP","UDP","TCP/UDP"],Source:{Ports:{1:{Start:"3389",End:""}}},Dest:{Ports:{1:{Start:"3389",End:""}}}}]}])}();
;"use strict";angular.module("app").controller("WanInfoCtrl",["$scope","$state","$q","$timeout","devinfo","translate","pageList","wanHelper",function($scope,$state,$q,$timeout,devinfo,translate,pageList,wanHelper){$script(pageList.wanInfo.lazyDeps,function(){$scope.__args={$state:$state,$q:$q,$timeout:$timeout,devinfo:devinfo,translate:translate,wanHelper:wanHelper},window.WanInfoCtrl?$scope.$apply(WanInfoCtrl):$state.go("error",{code:"msg_lazy_load_error",message:"msg_lazy_load_error_desc"})})}]);
;"use strict";!function(){angular.module("app").factory("wanHelper",["wanHelperMedia","wanHelperConnection","wanHelperFlags",function(media,connection,flags){return{media:media,connection:connection,flags:flags}}]),angular.module("app").factory("wanHelperMedia",["device","navigationFilter",function(device,navigationFilter){function getAllTypes(){return wan.media.getTypes()}function hasType(type){var types=getAllTypes();return _.contains(types,type)}function getInfoIface(type){switch(type){case"DSL.ATM":return"ATM ";default:return""}}function getInfoKey(param){return"WiFiClient"==param?"wan_wifi_client":"Internet"==param?"internet":param}function getATMLinkType(contype){return"pppoa"==contype?"PPPoA":"ipv4oa"==contype?"IPoA":"EoA"}function getDongleType(contype){return"lte"==contype?"LTE":"3g"==contype?"3G":"USB"}function getTemplate(type){return funcs.deepClone(template.media[type]())}var wan=device.wan,template=device.wan.template(),supported=device.wan.supported(),funcs=device.funcs;navigationFilter.rules()||{};var infoKeyMap={Ethernet:"Name",WiFi:"Name","DSL.ATM":"DestinationAddress","DSL.PTM":"Name",Dongle:"Type"},descriptionMap={Ethernet:"wan_iface_group_eth",WiFi:"wan_iface_group_wifi","DSL.ATM":"wan_iface_group_atm","DSL.PTM":"wan_iface_group_ptm",Dongle:"wan_iface_group_dongle"};return{getAllTypes:getAllTypes,getATMLinkType:getATMLinkType,hasType:hasType,getMediaTypesByContype:function(contype){if(function(contype){return _.contains(["pptp","l2tp","l2tpoveripsec","l2tpv3"],contype)}(contype))return[];if(function(contype){return _.contains(["3g","lte","usb"],contype)}(contype))return["Dongle"];if(function(contype){return"pppoa"==contype||"ipv4oa"==contype}(contype))return["DSL.ATM"];var mediaTypes=getAllTypes();return mediaTypes=_.difference(mediaTypes,["Dongle"])},identifyUseTypes:function(){var allTypes=getAllTypes();return _.filter(allTypes,function(type){return"DSL.ATM"==type&&supported.media.atm()?!0:wan.media.hasInterfaces(type)})},getInterface:function(type,instance,contype){if(!instance){var iface=getTemplate(type);return"DSL.ATM"!=type||iface.LinkType||(iface.LinkType=getATMLinkType(contype)),"DSL.ATM"==type&&(iface.DestinationAddress=wan.media.atm.getUniqDestinationAddress(iface.LinkType,iface.DestinationAddress)),"Dongle"!=type||iface.Type||(iface.Type=getDongleType(contype)),iface}var iface=wan.media.getInterface(type,instance);return"DSL.ATM"==type&&(iface.LinkType=getATMLinkType(contype)),iface},buildInterface:function(conn){function getAutoInterface(){var output={type:"auto",info:"wan_auto_selected",description:supported.dsysinit?"wan_auto_tunnel":"-"};return output}function getTunnelInterface(conn){var parentConn=function(iface){var conns=device.wan.flattenConnections(["ipv4oe"]),result=_.find(conns,function(elem){return elem.data.__Key==iface});return result?result.data:null}(conn.__LowerLayer);return{type:"tunnel",info:parentConn?getInfoKey(parentConn.Name):"-",description:"-"}}var data=conn.Media,type=conn.MediaType;return supported.dsysinit&&conn.AutomaticalConnection?getAutoInterface():conn.__LowerConnection?function(conn){var lowerConn=function(link){var conns=device.wan.flattenConnections(),subConns=device.wan.getSubConnections();subConns=_.map(subConns,function(conn){return{data:conn}}),conns=conns.concat(subConns);var result=_.find(conns,function(elem){return elem.data.__Link==link});return result?result.data:null}(conn.__LowerConnection);return{type:"tunnel",info:lowerConn?getInfoKey(lowerConn.Name):"-",description:"-"}}(conn):"4"==conn.__Layer?conn.AutomaticalConnection?getAutoInterface():getTunnelInterface(conn):hasType(type)?{type:type,info:getInfoKey(getInfoIface(type)+funcs.fetchBranch(data,type+"."+infoKeyMap[type])),description:descriptionMap[type]}:function(){return{type:"unknown",info:"-",description:"-"}}()},buildInterfaces:function(type,contype){function checkParams(obj,params){return _.every(params,function(value,name){return obj[name]==value})}var result=[],ifaces=wan.media.getInterfacesFlatten(type),condition=function(mediatype,contype){var condition={};return"Dongle"==mediatype?condition.Type=getDongleType(contype):"DSL.ATM"==mediatype&&(condition.LinkType=getATMLinkType(contype)),condition}(type,contype);return _.each(ifaces,function(iface){checkParams(iface.data,condition)&&result.push({type:type,instance:iface.instance,info:getInfoKey(getInfoIface(type)+iface.data[infoKeyMap[type]]),description:descriptionMap[type]})}),"DSL.ATM"==type&&result.push(function(){return{info:"wan_add_new_pvc",description:descriptionMap["DSL.ATM"],type:"DSL.ATM",isNew:!0}}()),result}}}]),angular.module("app").factory("wanHelperConnection",["device",function(device){function getSubTypes(type){return subtypesMap[type]?subtypesMap[type]:[]}function identifyType(actualType){var type=function(actualType){return _.findKey(subtypesMap,function(types){return _.contains(types,actualType)})}(actualType);return type?type:actualType}var template=device.wan.template(),supported=device.wan.supported(),types=["ipv4oe","ipv6oe","ipv4oa","pppoe","pppoa","pptp","pppoev6","pppoeDual","lte","3g","bridge","usb","l2tpv3"],subtypesMap={ipv4oe:["dynip","statip"],ipv6oe:["dynipv6","statipv6"],pptp:["pptp","l2tp","l2tpoveripsec"],mobileinet:["mobileinet","mobileinetv6"]},versionMap={v4:["ipv4oe","ipv4oa","pppoe","pppoa","pptp","pppoeDual","lte","3g","bridge","mobileinet","l2tpv3"],v6:["ipv6oe","pppoev6","pppoeDual","mobileinetv6"]},nameMap={dynip:"Dynamic IPv4",statip:"Static IPv4",ipoeDual:"IPoE Dual Stack",dynipv6:"Dynamic IPv6",statipv6:"Static IPv6",pppoe:"PPPoE",pppoev6:"PPPoE IPv6",pppoeDual:"PPPoE Dual Stack",pppoa:"PPPoA",pptp:"PPTP",l2tp:"L2TP",l2tpoveripsec:"L2TP Over IPsec",lte:"LTE","3g":"3G",bridge:"Bridge",mobileinet:"Mobile",l2tpv3:"L2TPv3"},additionalMap={pptp:["ipv4oe"],pppoe:["ipv4oe"]};return{getAllTypes:function(){return _.chain(types).map(function(type){return subtypesMap[type]?subtypesMap[type]:type}).flatten().value()},getSubTypes:getSubTypes,isAdditionalType:function(actualType,ifacetype){if(ifacetype&&_.contains(["DSL.ATM","DSL.PTM"],ifacetype))return!1;if(supported.needAdditionalConnection&&!supported.needAdditionalConnection(actualType))return!1;var type=identifyType(actualType);return _.has(additionalMap,type)},getAdditionalTypes:function(actualType){var type=identifyType(actualType);return additionalMap[type]||[]},getAdditionalSubTypes:function(actualType){var addConns=[],supportedCons=supported.connections(),type=identifyType(actualType);return _.each(additionalMap[type],function(elem){var subTypes=getSubTypes(elem);subTypes.length?addConns=addConns.concat(subTypes):addConns.push(elem)}),_.intersection(addConns,supportedCons)},identifyType:identifyType,identifyActualType:function(connection,type){function identifyXXTPType(connection){return"PPTP"===connection.ActualType?"pptp":"L2TP"===connection.ActualType?_.has(connection,"IPsec")?"l2tpoveripsec":"l2tp":""}return subtypesMap[type]?function(connection,type){return"ipv4oe"==type?"Static"==connection.AddressingType?"statip":"dynip":"ipv6oe"==type?"Static"==connection.Origin?"statipv6":"dynipv6":"pptp"==type?identifyXXTPType(connection):"mobileinet"==type?connection.IPv6?"mobileinetv6":"mobileinet":"-"}(connection,type):type},identifyVersions:function(elem){var type=autoconf.BR2_PACKAGE_ANWEB_DSYSINIT&&"mobileinet"==elem.type&&elem.data.IPv6?"mobileinetv6":elem.type,versions=[];return _.each(versionMap,function(types,version){_.contains(types,type)&&versions.push(version)}),versions},getDataModelName:function(type){return device.wan.getDataModelName(type)},getTemplate:function(actualType){return angular.copy(template.connection[actualType]())},getStateInfo:function(actualType){return{path:function(type){switch(type){case"pppoe":case"pppoa":case"pptp":case"l2tp":case"l2tpoveripsec":case"pppoev6":case"pppoeDual":return".ppp";default:return"."+type}}(actualType),type:identifyType(actualType),actualType:actualType}},getConnection:function(type,inx){if(_.isUndefined(device.wan[type])||!device.wan[type].list)return null;var list=device.wan[type].list();if(!list)return null;var conn=list[inx];return conn},getStatus:function(connection){return connection.Enable?connection.Status?connection.Status:"Unconfigured":"Disabled"},getStatusDetail:function(connection){if(_.has(connection,"StatusExt"))return connection.StatusExt;if(_.has(connection,"PPPState"))switch(connection.PPPState){case-1:case 0:return"Unknown";case 1:return"PPPServerNotAvailable";case 2:return"PPPPeerNegotiationFailed";case 3:return"PPPPeerNotResponding";case 4:return"PPPAuthFailed";case 6:return"PPPNotResponse";default:return""}return""},generateConnectionName:function(contype,mediatype,info){if(contype.indexOf("lte")>-1)return"Mobile WAN";var name=nameMap[contype]||contype;return"bridge"===contype?"Ethernet"===mediatype&&info?name+"_"+info:name.split(" ").join("_")+"_"+mediatype.split(".").slice(-1)[0]+"_"+Math.round(100*Math.random()):name.split(" ").join("_")+"_"+Math.round(100*Math.random())},getAllSupportedGeneralTypes:function(){var allTypes=supported.connections();return _.chain(allTypes).map(function(type){return identifyType(type)}).uniq().value()}}}]),angular.module("app").factory("wanHelperFlags",["device",function(device){function getAllInfo(){return typesInfo}device.wan.supported();var typesInfo=[{name:"NAT",description:"NAT"},{name:"Firewall",description:"wan_firewall"}];return typesInfo=typesInfo.concat([{name:"RIP",description:"RIP"},{name:"RIPng",description:"RIPng"},{name:"Ping",description:"Ping"},{name:"RTSP",description:"RTSP"},{name:"AltRoutingTable",description:"wan_altrt"}]),{getAllInfo:getAllInfo,unavailableFlag:function(flag,connection,type){if("IGMP"!=flag)return!1;if(!connection.Media)return!1;var list=device.wan[type].list();return _.some(list,function(conn){return conn.Flags?device.wan.media.isUniqMedia(connection,conn)&&conn.Flags[flag]:!0})}}}]),angular.module("app").service("wanHelperSimple",["device","wanHelper","translate","navigationFilter",function(device,helper,translate,navFilter){function makeRows(type,instance,iface){var data=helper.connection.getConnection(type,instance);if(!data)return[];var rows=[{name:"iface",value:translate(iface.info)},{name:"username",value:data.Username,hide:!data.Username},{name:"wan_ipv6_origin_method",value:function(value){return translate({AutoConfigured:"wan_ipv6_auto_configured",AutoConfiguredByDHCPv6:"wan_ipv6_auto_configured_by_dhcp_v6",AutoConfiguredBySlaac:"wan_ipv6_auto_configured_by_slaac",Auto:"wan_ipv6_auto_configured"}[value])}(data.Origin),hide:"Static"==data.Origin||!data.Origin}];return data.StaticIPAddress0?rows.push({name:"ip_address",value:data.StaticIPAddress0}):data.StaticIPv6Address0?rows.push({name:"ip_address",value:data.StaticIPv6Address0}):"pppoeDual"==type?(data.IPAddress&&rows.push({name:"ip_address",value:data.IPAddress}),data.IPv6Address&&rows.push({name:"ipv6_address",value:data.IPv6Address})):data.IPAddress?rows.push({name:"ip_address",value:data.IPAddress}):data.IPv6Address&&rows.push({name:"ip_address",value:data.IPv6Address}),rows=rows.concat([{name:"prefix",value:data.StaticIPPrefix0,hide:!data.StaticIPPrefix0},{name:"subnet_mask",value:data.StaticIPSubnetMask0,hide:!data.StaticIPSubnetMask0},{name:"subnet_mask",value:data.SubnetMask,hide:!data.SubnetMask||data.StaticIPSubnetMask0},{name:function(type){return"pptp"==type}(type)?"wan_vpn_service_name":"wan_service_name",value:data.ServiceName,hide:!data.ServiceName},{name:"wan_gateway_ip",value:data.GatewayIPAddress,hide:!data.GatewayIPAddress||"ipv6oe"==type},{name:"wan_authentication_protocol",value:data.AuthenticationProtocol,hide:!data.AuthenticationProtocol}])}function getStatusInfo(type,inx,gwStatus,wifiClientInfo){var conn=helper.connection.getConnection(type,inx);if(!conn)return"";var actualStatus,status=helper.connection.getStatus(conn),statusDetail=helper.connection.getStatusDetail(conn);actualStatus="WiFi"===conn.MediaType?getActualStatus(conn,status,wifiClientInfo):(conn.DefaultGateway||conn.DefaultGatewayv6)&&"Disabled"!=actualStatus?gwStatus:statusDetail&&!_.contains(["Connected","Disabled","CableDisconnected","USBDisconnected","WiFiDisconnect","WiFiDisconnected","DHCPIPNotReceived","SIMDisconnected","USBNotActive"],actualStatus)?statusDetail:status;var status,statusText=translate(function(str){var key=null;if(!str||_.isEmpty(str))return"wan_status_connecting";switch(str){case"Disabled":key="st_disabled";break;case"DslDown":key="off";break;case"Connected":case"ok":key="connected";break;case"kabinet_not_started":case"Disconnected":key="disconnected";break;case"ppperror":key="wan_status_dual_stack_ppp_error";break;case"nona":key="wan_status_no_address";break;case"nopd":key="wan_status_no_delegated_prefix";break;case"dhcperror":key="wan_status_dhcp_ip_not_received";break;case"ServerNotAvailable":case"AuthFailed":case"WiFiClientCouldNotConnect":case"NoNANoPD":case"NoNA":case"NoPD":str="PPP"+str;default:str=str.replace(/PPP|WiFi|USB|DHCP|IP|SIM/g,function(i){return i[0]+i.slice(1).toLowerCase()}),key="wan_status_"+str.replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase()}return key}(actualStatus));switch(actualStatus){case"Connected":case"KabinetFull":case"KabinetNetworksOnly":case"ok":status="on";break;case"Connecting":status="pending";break;case"Disabled":case"Disconnected":case"Unknown":case"PPPServerNotAvailable":case"PPPPeerNegotiationFailed":case"PPPPeerNotResponding":case"PPPAuthFailed":case"PPPNotResponse":case"PPPNoNANoPD":case"PPPNoNA":case"PPPNoPD":case"PPPResolveFailed":case"kabinet_not_started":case"Unconfigured":case"DHCPIPNotReceived":case"AuthFailed":case"ServerNotAvailable":case"DslDown":case"WiFiClientCouldNotConnect":case"KabinetNotStarted":case"NoNANoPD":case"NoNA":case"NoPD":case"ppperror":case"nona":case"nopd":case"dhcperror":status="off";break;case"CableDisconnected":case"USBDisconnected":case"WiFiDisconnect":case"SIMDisconnected":case"WiFiDisconnected":case"USBNotActive":status="disconnected"}return{statusText:statusText,status:status}}function getActualStatus(conn,status,wifiClientInfo){var actualStatus,apCliConn=wifiClientInfo?wifiClientInfo.apCliConn:null,apCliConn5ghz=wifiClientInfo?wifiClientInfo.apCliConn5ghz:null;return wifiClientInfo?wifiClientInfo.wispConns:[],actualStatus="WiFiClient5ghz"!=conn.Media.WiFi.Name&&apCliConn||"WiFiClient5ghz"==conn.Media.WiFi.Name&&apCliConn5ghz?"Connected"==status?status:conn.Enable?"DHCPIPNotReceived":"Disabled":"WiFiDisconnected"}return{makeFields:function(conn,gwStatus,wifiClientInfo){var link,actualType=helper.connection.identifyActualType(conn.data,conn.type),statusInfo=_.partial(getStatusInfo,conn.type,conn.instance,gwStatus,wifiClientInfo),iface=helper.media.buildInterface(conn.data),idConf="";_.isUndefined(conn.data.__Link)||(link=conn.data.__Link.split("."),idConf=link[4]);var customRules=navFilter.rules();return"ipv4oe"==conn.type&&customRules.HideWanIPv4oE||_.some(customRules.HideWanConnectionsList,function(wc){return wc==conn.data.Name})||conn.data.VLAN&&_.some(customRules.BanWanVlansList,function(v){return Number(v)===conn.data.VLAN.ID})?void 0:{name:conn.data.Name,inx:conn.instance,__id:idConf,type:conn.type,iface:iface,actualType:actualType,status:statusInfo,rows:makeRows(conn.type,conn.instance,iface)}}}}])}();
;"use strict";!function(){angular.module("app").service("wanMode",["anwebStorage","device","$q","devinfo",function(anwebStorage,device,$q,devinfo){function setAdvanced(value){value||storage.set(warningKey,!1),storage.set(key,value),isAdvanced=value}function isAdvancedConfig(){var gateways=[device.wan.gwif.getValue("v4"),device.wan.gwif.getValue("v6")],conns=device.wan.flattenConnections(),types=_.map(conns,function(obj){var dataModel=device.wan.getDataModelName(obj.type);return _.contains(gateways,"Device.WAN."+dataModel+".Connection."+obj.instance+".")?obj.type+"@gw":obj.type});return conns.length&&!_.some([["ipv4oa@gw"],["ipv4oe@gw"],["ipv6oe@gw"],["pppoe@gw","ipv4oe"],["pptp@gw","ipv4oe"],["pptp"],["pppoe@gw"],["pppoa@gw"],["pppoev6@gw"],["pppoeDual@gw"],["3g@gw"],["lte@gw"],["bridge"]],function(obj){return _.isEqual(obj.sort(),types.sort())})}function isAdvancedMode(){return device.wan.isDefined("BR2_PACKAGE_ANWEB_WAN_SIMPLE_MODE")?device.wan.isDefined("BR2_PACKAGE_ANWEB_WAN_SIMPLE_MODE_ONLY")?!1:isAdvanced:!0}function isForcedChange(){return storage&&storage.get(warningKey)}var key="useAdvancedPage",warningKey="useAdvancedPageWarning",isAdvanced=!0,storage=null;return{init:function(){function onData(res){storage=anwebStorage.make("wanMode-"+res.modelId+"-"+res.buildDate);var storAdvanced=storage.get(key),isAdvancedConf=isAdvancedConfig();storAdvanced===!1&&isAdvancedConf?(storage.set(warningKey,!0),isAdvanced=!0):isAdvanced=_.isBoolean(storAdvanced)?storAdvanced:isAdvancedConf}return devinfo.once("version").then(onData)},setAdvanced:setAdvanced,isAdvancedConfig:isAdvancedConfig,isAdvancedMode:isAdvancedMode,isForcedChange:isForcedChange,isSupport:function(){return device.wan.isDefined("BR2_PACKAGE_ANWEB_WAN_SIMPLE_MODE")},isOnlySimple:function(){return device.wan.isDefined("BR2_PACKAGE_ANWEB_WAN_SIMPLE_MODE_ONLY")}}}])}();
;"use strict";!function(){angular.module("app").service("wanReservationUtil",["device","somovd","funcs",function(device,somovd,funcs){function apply(config){var input=converter.nativeToSomovd(config);return input.enable||(input=_.pick(input,"enable")),somovd.write(210,input,-1).then(function(response){return funcs.is.RPCSuccess(response)?Promise.resolve():Promise.reject()})}function getConfig(){return config}var config=null,converter=device.wanReservation.converter,Helper=device.wanReservation.constructor;return{pull:function(){return somovd.read([210,1],function(response){if(!funcs.is.allRPCSuccess(response))return Promise.reject();var input={210:response.rq[0].data,1:response.rq[1].data};return config=converter.somovdToNative(input),Promise.resolve()})},apply:apply,getConfig:getConfig,makeHelper:function(){return new Helper},needCheckGw:!0}}])}();
;"use strict";!function(){angular.module("app").service("wifiAdvancedConstants",["navigationFilter",function(navigationFilter){function makeBGProtectionList(){return[{name:"Auto",value:"Auto"},{name:"Always On",value:"Always On"},{name:"Always Off",value:"Always Off"}]}function makeTxPreambleList(){return[{name:"wifi_advanced_transmit_preamble_long",value:"long"},{name:"wifi_advanced_transmit_preamble_short",value:"short"}]}function makeHTGIList(){return[{name:"act_enable",value:"Enable"},{name:"act_disable",value:"Disable"}]}var customRules=navigationFilter.rules();return function(){return{BGProtection:{list:makeBGProtectionList()},TxPreamble:{supported:!!customRules.ShowFakeWIFITxPreamble,list:makeTxPreambleList()},HTGI:{list:makeHTGIList()},BeaconPeriod:{min:20,max:1024},RTSThreshold:{min:0,max:2347},FragmentationThreshold:{min:0,max:2346},DTIMPeriod:{min:1,max:255},StationKeepAlive:{min:0,max:65535}}}}])}();
;"use strict";!function(){angular.module("app").service("wifiCommonShared",["$rootScope","$q","$state","$timeout","translate","ngDialog","devinfo","device",function($rootScope,$q,$state,$timeout,translate,ngDialog,devinfo,device){function getDialogOpenListener(dialogId,dialogOpenedCb){return $rootScope.$on("ngDialog.opened",function(e,$dialog){dialogId===$dialog.attr("id")&&dialogOpenedCb()})}function __pullWifi(){var deferred=$q.defer();return device.wifi.pullCommon(function(){deferred.resolve()}),deferred.promise}function __pullClient(){return devinfo.once("client").then(function(result){return device.wifi.setClientInfo(result.client),result})}function __showDeviceLossMsg(deviceLoss){return function(options){return ngDialog.open({template:"dialogs/wifi_device_loss/dialog.tpl.html",controller:"WifiDeviceLossDialogCtrl",className:"wifi_device_loss_dialog",data:options})}(deviceLoss)}return{activate:function(){return __pullWifi().then(__pullClient)},apply:function(options){function __successCb(){var pageWifiCommonPath=_.initial($state.current.name.split("."),2).join(".")+".common";action&&"ap"==action?$state.go(pageWifiCommonPath,{freq:freq}):$state.go($state.current,{},{reload:!0})}function __errorCb(){$state.go("error",{code:"msg_push_error",message:"msg_error_desc"})}function applyHandler(){function pushCb(error){overlay.stop(overlayId),overlayId=null,deviceLoss.loss||(device.wifi.isWirelessClient()?__successCb():error?__errorCb():__successCb())}function stopOverlay(){overlayId&&overlay.stop(overlayId)}var overlay=$rootScope.overlay.circular,overlayId=overlay.start();onlyRegulatoryDomain?device.wifi.push(pushCb,!1,!0)["finally"](stopOverlay):device.wifi.push(pushCb)["finally"](stopOverlay)}var action,freq,onlyRegulatoryDomain,properties,eventOpen;options&&(action=options.action,freq=options.freq,onlyRegulatoryDomain=options.onlyRegulatoryDomain);var deviceLoss=device.wifi.checkDeviceLoss();deviceLoss.loss?(properties=__showDeviceLossMsg(deviceLoss),eventOpen=getDialogOpenListener(properties.id,applyHandler),properties.closePromise.then(__successCb)["finally"](function(){eventOpen()})):applyHandler()}}}])}();
;"use strict";!function(){angular.module("app").service("wifiWpsShared",["$rootScope","$q","$state","$timeout","device",function($rootScope,$q,$state,$timeout,device){return{activate:function(){var deferred=$q.defer();return device.wifi.pullAdv(function(){deferred.resolve()}),deferred.promise},apply:function(action,freq){function successCb(){var pageWifiWpsPath=_.initial($state.current.name.split("."),2).join(".")+".wps";action&&"wps"==action?$state.go(pageWifiWpsPath,{freq:freq}):$state.go($state.current,{},{reload:!0})}function errorCb(){$state.go("error",{code:"msg_push_error",message:"msg_error_desc"})}var overlay=$rootScope.overlay.circular,overlayId=overlay.start();device.wifi.push(function(error){error?errorCb():successCb()})["finally"](overlay.stop.bind(overlay,overlayId))}}}])}();
;"use strict";!function(){angular.module("app").factory("lanConstraints",["lanConstants",function(lanConstants){function isDefined(param){return define[param]}var define={RLX:autoconf.BR2_PACKAGE_ANWEB_REALTEK,RLX_MODEM:autoconf.BR2_PACKAGE_ANWEB_REALTEK_MODEM,CUSTOM_PARTNER:autoconf.BR2_PACKAGE_ANWEB_CUSTOM_PARTNER_23078};return{constants:lanConstants,ipv4:function(){return{MinHosts:isDefined("CUSTOM_PARTNER")?2:4,MinHostsDhcpOff:2,MaxHosts:isDefined("RLX")||isDefined("RLX_MODEM")?254:16777214,addressingModes:[{name:"lan_addressing_mode_static",value:"Static"},{name:"lan_addressing_mode_dynamic",value:"Dynamic"}],dhcp:{modes:[{name:"lan_dhcp_mode_disable",value:"Disable"},{name:"lan_dhcp_dhcp_server",value:"Server"},{name:"lan_dhcp_relay",value:"Relay"}]}}},ipv6:function(){return{MinPrefix:64,MaxPrefix:128,addressingModes:[{name:"lan_addressing_mode_static",value:"Static"},{name:"lan_addressing_mode_dynamic",value:"Dynamic"},{name:"lan_ipv6_addressing_mode_pd",value:"PD"}],dhcp:{modes:[{name:"lan_dhcp_mode_disable",value:"Disable"},{name:"lan_dhcp_mode_server",value:"Server"}],autoconfigurationModes:[{name:"lan_dhcp_mode_disable",value:"Disable"},{name:"lan_ipv6_dhcp_auto_mode_statefull",value:"Statefull"},{name:"lan_ipv6_dhcp_auto_mode_stateless",value:"Stateless"}]}}}}}])}();
;"use strict";!function(){angular.module("app").factory("lanSupported",["cookie","navigationFilter",function(cookie,navigationFilter){function isDefined(param){return define[param]}var isAPMode="ap"===cookie.get("device_mode"),customRules=navigationFilter.rules(),define={BR2_PACKAGE_ANWEB_LAN_IPV6:autoconf.BR2_PACKAGE_ANWEB_LAN_IPV6&&!customRules.HideLanIPv6,BCM_MODEM:autoconf.BR2_PACKAGE_ANWEB_BCM_MODEM,isModem:autoconf.BR2_PACKAGE_ANWEB_REALTEK_MODEM,SUPPORT_MULTI_LAN:autoconf.BR2_PACKAGE_ANWEB_MULTI_LAN,LAN_DHCP_PORT_SETTING:autoconf.BR2_PACKAGE_ANWEB_LAN_DHCP_PORT_SETTING};return{lan:function(){return{isModem:isDefined("isModem"),SUPPORT_MULTI_LAN:isDefined("SUPPORT_MULTI_LAN"),IPv4:!0,IPv6:isDefined("BR2_PACKAGE_ANWEB_LAN_IPV6"),isAPMode:isAPMode}},ipv4:function(){return{AddressingMode:isAPMode,AddressingModeAvailable:isAPMode?["Static","Dynamic"]:["Static"],StaticIP:{Address:!0,SubnetMask:!0,GatewayAddress:isAPMode,AddnHostname:!0},DHCP:{Mode:!0,Server:{MinAddress:!0,MaxAddress:!0,LeaseTime:!0,DNSRelay:!0,StaticAddress:{IPAddress:!0,MACAddress:!0,Hostname:!0}},Relay:{DHCPServerIPAddress:!0,RemoteID:!0},Ports:isDefined("LAN_DHCP_PORT_SETTING")}}},ipv6:function(){return{AddressingMode:!0,AddressingModeAvailable:isAPMode?["Static","Dynamic"]:["Static","PD"],StaticIP:{Address:!0,Prefix:!0,GatewayAddress:isAPMode},DHCP:{__base:!isAPMode,Mode:!0,Server:{AutoconfigurationMode:!0,MinAddress:!0,MaxAddress:!0,LeaseTime:!0,DNSRelay:!1,RADVD:isDefined("BCM_MODEM"),StaticAddress:{IPAddress:!0,MACAddress:!0,Hostname:!0}}}}}}}])}();
;"use strict";!function(){angular.module("app").constant("statsClientsConstants",{rpcNeighbour:187,rpcStation:64})}();
;"use strict";!function(){angular.module("app").service("statsClientsUtil",["funcs","device","somovd","devinfo","statsClientsConstants",function(funcs,device,somovd,devinfo,constants){function transformStation(clients){return _.map(clients,function(client){return{name:"WLAN",hostname:client.hostname,mac:client.mac.toLowerCase()}})}return{subscribeInfo:function(cb,$scope){devinfo.onceAndSubscribe([constants.rpcNeighbour,constants.rpcStation].join("|"),function(response){var clients=[];response&&(response[constants.rpcNeighbour]&&(clients=clients.concat(response[constants.rpcNeighbour])),response[constants.rpcStation]&&_.each(transformStation(response[constants.rpcStation]),function(client){_.find(clients,function(o){return o.mac==client.mac})||clients.push(client)}),cb&&cb(clients))},$scope)}}}])}();
;"use strict";!function(){angular.module("app").service("statsSessionsUtil",["devinfo","device",function(devinfo,device){var rpc="180",converter=device.statsSessions.converter;return{subscribeInfo:function(cb,$scope){devinfo.onceAndSubscribe(rpc,function(response){var data=[];response&&response[rpc]&&(data=converter.somovdToNative(response[rpc])),cb&&cb(data)},$scope)}}}])}();
;"use strict";!function(){angular.module("app").constant("statsDHCPConstants",{rpc:34})}();
;"use strict";!function(){angular.module("app").service("StatsDHCPUtil",["somovd","device","devinfo","funcs","statsDHCPConstants",function(somovd,device,devinfo,funcs,constants){function makeHelper(){return new device.statsDHCP.Helper(config)}var config=null;return{pull:function(){return somovd.read([constants.rpc],function(response){return funcs.is.allRPCSuccess(response)?void 0:Promise.reject()})},subscribeInfo:function(cb,$scope){devinfo.onceAndSubscribe(constants.rpc.toString(),function(response){response&&response[constants.rpc.toString()]&&cb&&cb(response[constants.rpc.toString()])},$scope)},makeHelper:makeHelper}}])}();
;"use strict";!function(){angular.module("app").service("statsMulticastUtil",["devinfo",function(devinfo){var rpc="206";return{subscribeInfo:function(cb,$scope){devinfo.onceAndSubscribe(rpc,function(response){var data=[];response&&response[rpc]&&(data.ipv4=response[rpc].igmp,data.ipv6=response[rpc].igmp6),cb&&cb(data)},$scope)}}}])}();
;"use strict";!function(){angular.module("app").constant("statsNetworkConstants",{networkRPC:"104",portsRPC:"129"})}();
;"use strict";!function(){angular.module("app").service("statsNetworkUtil",["statsNetworkConstants","funcs","device","devinfo","translate",function(constants,funcs,device,devinfo,translate){var converter=device.statsNetwork.converter;return{subscribeInfo:function(cb,$scope){devinfo.init({need_auth:!0}),devinfo.onceAndSubscribe(constants.networkRPC+"|"+constants.portsRPC,function(response){function getRxTxInfo(item){function sizeTranslater(value){return translate("units_"+value)}function getValue(value){return _.isFinite(value)&&value>0?funcs.lookSize(value).toString(sizeTranslater):"-"}return _.isEmpty(item.RX)&&_.isEmpty(item.TX)||"up"!=item.State?null:(parseInt(item.RX),parseInt(item.TX),getValue(item.RX)+" / "+getValue(item.TX))}var data;response&&(response[constants.networkRPC]||response[constants.portsRPC])&&(data=[],data.NetworkStats=response[constants.networkRPC]?_.values(_.omit(response[constants.networkRPC],"status")):[],data.PortStats=response[constants.portsRPC]?response[constants.portsRPC]:[],data=converter.somovdToNative(data),_.map(data,function(item){return item.RxTx=getRxTxInfo(item),item}),cb&&cb(data))},$scope)}}}])}();
;"use strict";!function(){angular.module("app").service("statsPortsUtil",["devinfo","funcs",function(devinfo,funcs){function convertData(data){var result=[];return _.each(data,function(port){result.push(port)}),result}var rpc="129";return{subscribeInfo:function(cb,$scope){devinfo.onceAndSubscribe(rpc,function(response){var data;response&&response[rpc]&&(data={},data.ports=convertData(response[rpc]),data.ports=funcs.sortPortsSomovd(data.ports),cb&&cb(data))},$scope)}}}])}();
;"use strict";!function(){angular.module("app").constant("statsRoutingConstants",{rpc:33})}();
;"use strict";!function(){angular.module("app").service("StatsRoutingUtil",["somovd","device","devinfo","funcs","statsRoutingConstants",function(somovd,device,devinfo,funcs,constants){function makeHelper(){return new device.statsRouting.Helper(config)}var config=null;return{pull:function(){return somovd.read([constants.rpc],function(response){return funcs.is.allRPCSuccess(response)?(config=response.rq[0].data,Promise.resolve()):Promise.reject()})},subscribeInfo:function(cb,$scope){devinfo.onceAndSubscribe(constants.rpc.toString(),function(response){response&&response[constants.rpc.toString()]&&cb&&cb(response[constants.rpc.toString()])},$scope)},needTable:function(){return!1},makeHelper:makeHelper}}])}();
;"use strict";angular.module("app").controller("routingStatsInfoCtrl",["$scope","$state","StatsRoutingUtil","devinfo","funcs","ngDialog",function($scope,$state,util,devinfo,funcs,ngDialog){function init(){helper=util.makeHelper(),onInfoLoaded(helper.getData()),util.subscribeInfo(onInfoLoaded,$scope)}function onInfoLoaded(data){$scope.routingStats=_.filter(data,function(e){return tableID?e.table==tableID:!0}),$scope.$emit("pageload")}var helper,tableID=$state.params.table?$state.params.table:void 0;init(),$scope.getDestString=function(item){return helper.getDestString(item)},$scope.showDetails=function(item){devinfo.suspend();var dlg=ngDialog.open({template:"dialogs/stats/route_stat_details/dialog.tpl.html",controller:"routeStatDetailsCtrl",resolve:funcs.getLazyResolve("dialogs/stats/route_stat_details/ctrl.lazy.js","routeStatDetailsCtrl"),data:{model:item}});dlg.closePromise.then(function(){devinfo.resume()})},$scope.needTable=function(){return util.needTable()}}]);
;"use strict";!function(){angular.module("app").controller("statsRoutingForm",["$scope","$state","StatsRoutingUtil",function($scope,$state,util){$scope.isActivate=!1,function(){util.pull().then(function(){$scope.isActivate=!0,$scope.$emit("pageload")})["catch"](function(){$state.go("error",{code:"msg_pull_error",message:"msg_error_desc"})})}()}])}();
;"use strict";!function(){angular.module("app").factory("summaryCpuRam",["utilSummaryCpuRam","$state","translate","funcs",function(util,$state,translate,funcs){function getLookSize(num){return funcs.lookSize(num).toString(function(value){return translate("units_"+value)})}function commonHandler(data){if(data){var input=util.convert(data,backupCpu);cpuRamInfo.info=handler.cpuram(input),backupCpu=angular.copy(input.backup),cpuRamInfo.isActivate=cpuRamInfo.info.cpu&&cpuRamInfo.info.ram}}function get(){return cpuRamInfo?cpuRamInfo:cpuRamInfo={area:util.getAreas(),devinfoHandler:commonHandler,info:{},isActivate:!1}}var cpuRamInfo=null,backupCpu=null,handler={cpuram:function(input){return input?(_.map(input.ram.string,function(elem,inx){input.ram.string[inx]=getLookSize(elem)}),{cpu:input.cpu,ram:input.ram}):null}};return{get:get}}])}();
;"use strict";!function(){angular.module("app").service("utilSummaryCpuRam",["device","summaryConstants",function(device,constants){return{getAreas:function(){return constants.CPU_AND_RAM?constants.CPU_AND_RAM.toString():""},convert:function(input,backup){if(!input)return null;var data={newData:input[constants.CPU_AND_RAM],oldData:backup?backup:input[constants.CPU_AND_RAM]},result=device.cpuram.somovdToNative(data);return result}}}])}();
;"use strict";!function(){angular.module("app").factory("summaryYandexDns",["utilSummaryYandexDns","devinfo",function(util){function get(){function saveYandexSettings(){return saveParams=!0,util.setSettings(yandexInfo.settings),util.pushSettings(yandexInfo.settings).then(function(){saveParams=!1})}function turnUnsafeToDefault(){if(yandexInfo.settings.enabled){saveParams=!0;var rules=util.getRules();_.each(rules,function(rule){"off"==rule.mode&&(rule.mode=this.settings["default"])},yandexInfo),util.setRules(rules),util.pushRules(rules).then(function(){updateModesInfo(),saveParams=!1})}}function yandexHandler(data){if(data&&!saveParams){var input=util.convert(data);updateModesInfo(),yandexInfo.settings=input.settings}}function updateModesInfo(){var settings=util.getSettings(),clients=util.getClients(),inModeDeviceCount=function(mode){var inMode=_.filter(clients,function(client){return!!client.rule&&client.rule.mode==mode||!client.rule&&settings["default"]==mode}),macArr=[];return _.each(inMode,function(elem){macArr.push(elem.mac.toUpperCase())}),_.uniq(macArr).length};modesInfo.safe.devicesCount=inModeDeviceCount("safe"),modesInfo.safe.devicesString=getDeviceCountString(modesInfo.safe.devicesCount),modesInfo.child.devicesCount=inModeDeviceCount("child"),modesInfo.child.devicesString=getDeviceCountString(modesInfo.child.devicesCount),modesInfo.off.devicesCount=inModeDeviceCount("off"),modesInfo.off.devicesString=getDeviceCountString(modesInfo.off.devicesCount)}function getDeviceCountString(count){var residual=count%10,label="";return(0==residual||residual>=5&&9>=residual)&&(label="yadns_from_five_to_nine_devices"),1==residual&&(label="yadns_one_device"),residual>=2&&4>=residual&&(label="yadns_from_two_to_four_devices"),label}if(yandexInfo)return yandexInfo;var availabelModes=[{value:"off",label:"yadns_protection_off_mode"},{value:"safe",label:"yadns_safe_mode"},{value:"child",label:"yadns_child_mode"}],modesInfo={safe:{label:_.findWhere(availabelModes,{value:"safe"}).label},child:{label:_.findWhere(availabelModes,{value:"child"}).label},off:{label:_.findWhere(availabelModes,{value:"off"}).label}};return yandexInfo={toggleYandexDns:function(){return saveYandexSettings()},updateSettings:function(){return saveYandexSettings().then(updateModesInfo)},saveYandexSettings:saveYandexSettings,turnUnsafeToDefault:turnUnsafeToDefault,getDeviceCountString:getDeviceCountString,area:util.getAreas(),devinfoHandler:yandexHandler,settings:util.getSettings(),modesInfo:modesInfo,modesList:_.keys(modesInfo)}}var yandexInfo=null,saveParams=!1;return{get:get}}])}();
;"use strict";!function(){angular.module("app").service("utilSummaryYandexDns",["device","funcs","somovd",function(device,funcs,somovd){function convert(input){if(!input)return null;var inputData={wan_model:input[rpcs.wanRpc],dhcp_model:input[rpcs.dhcpRpc],yandex_model:input[rpcs.yandexSettingsRpc]};return wanConfig=funcs.deepClone(input[rpcs.wanRpc]),config=converter.somovdToNative(inputData)}function getSettings(){return config?config.settings:{}}function getClients(){return config?config.clients:{}}function getRules(){return config?config.rules:{}}function pushRules(data){var input=converter.nativeToSomovd(data),writeModel={br0:funcs.deepClone(wanConfig.iface_names.br0)};return writeModel.br0.services.br0.dhcpd.reserved=input,somovd.write(rpcs.wanRpc,writeModel).then(function(response){return funcs.is.RPCSuccess(response)?Promise.resolve():Promise.reject()})}function setSettings(settings){config.settings=settings}function setRules(rules){config.rules=rules}var rpcs={wanRpc:1,dhcpRpc:187,yandexSettingsRpc:179},rpcList=[rpcs.wanRpc,rpcs.dhcpRpc,rpcs.yandexSettingsRpc],converter=device.yandexDns.converter,config=null,wanConfig=null;return{getAreas:function(){return rpcList.join("|")},convert:convert,getSettings:getSettings,getClients:getClients,getRules:getRules,pushSettings:function(data){return somovd.write(rpcs.yandexSettingsRpc,data,-1).then(function(response){return funcs.is.RPCSuccess(response)?Promise.resolve():Promise.reject()})},pushRules:pushRules,setSettings:setSettings,setRules:setRules}}])}();
;"use strict";!function(){angular.module("app").service("systemUtil",["$timeout","devinfo","device","funcs","somovd","translate","authDigest","authDigestCredentialsStorage","authDigestRealmStorage","authDigestHelper","cookie","navigationFilter","$rootScope",function($timeout,devinfo,device,funcs,somovd,translate,authDigest,authDigestCredentialsStorage,authDigestRealmStorage,authDigestHelper,cookie,navigationFilter,$rootScope){function setAuthCookie(url,method){var header=authDigestHelper.generateHeader({url:url,method:method});cookie.set("Authorization",header,3,"sec")}var customRules=navigationFilter.rules()||{},constants={CONFIG_ID_RTKTEH:269,CONFIG_ID_VELCOM:268};return customRules.SystemConfigMultiUsers&&(constants.USER_LIST=_.isArray(customRules.SystemConfigMultiUsers)&&_.size(customRules.SystemConfigMultiUsers)?customRules.SystemConfigMultiUsers:["admin"]),{factoryNeedReboot:!1,useFormData:!1,getInitParams:function(){return somovd.read([112,260,67,constants.CONFIG_ID_RTKTEH,constants.CONFIG_ID_VELCOM]).then(function(response){var autoReboot,data,output={lang:{},mode:{},user:{},webInterface:{}},modeInfo=response.rq[0].data;if(output.mode.name=modeInfo?modeInfo.device_mode:"",output.mode.hasHwModeSwitch=modeInfo&&modeInfo.devmode_hw_switch_support,output.lang.value=translate.getLang(),output.lang.list=autoconf.__lang_arr||["eng","rus"],output.user.name=cookie.get("user_login")||"admin",output.user.list=constants.USER_LIST,funcs.is.RPCSuccess(response.rq[1])&&(autoReboot=response.rq[1].data||{},output.autoreboot={enable:autoReboot.autoreboot>0,period:autoReboot.autoreboot>0?autoReboot.autoreboot:86400}),funcs.is.RPCSuccess(response.rq[2])){var data=response.rq[2].data;data&&data.logout_time&&(output.webInterface.logoutTime=parseInt(data.logout_time/6e4))}return funcs.is.RPCSuccess(response.rq[3])&&(data=response.rq[3].data,data&&!_.isUndefined(data.rtkteh_block)&&(output.webInterface.rtktehBlock=data.rtkteh_block)),funcs.is.RPCSuccess(response.rq[4])&&(output.autoPingReboot=_.defaults(response.rq[4].data||{},{host:"localhost",interval:60})),Promise.resolve(output)})},save:function(){return device.system.save()},reset:function(){return device.system.reset()},rebootBefore:null,reboot:function(){return device.system.reboot()},backup:function(){device.system.backup(function(){var url="/config_load";setAuthCookie(url,"GET"),document.location.href=url})},restorePrepare:function(url){setAuthCookie(url,"POST")},changeLang:function(lang){return somovd.write(67,{lang:lang}).then(function(response){return funcs.is.RPCSuccess(response)?Promise.resolve():void Promise.reject()})},changePassword:function(user,password){return somovd.write(69,{login:user,pass:password}).then(function(response){var authHeader,current=cookie.get("user_login");return funcs.is.allRPCSuccess(response)?(current&&user!=current||(authHeader=authDigestCredentialsStorage.get(authDigestRealmStorage.getCurrent()),authDigest.setCredentials({username:user,password:password},authHeader)),Promise.resolve()):Promise.reject(52==response.status?"password_invalid_value":"password_not_changed")})},changeAutoReboot:function(autoReboot){var data={autoreboot:0};return autoReboot&&autoReboot.enable&&(data.autoreboot=autoReboot.period),somovd.write(260,data).then(function(response){return funcs.is.RPCSuccess(response)?Promise.resolve():Promise.reject()})},changeWebInterface:function(params){var list=[];_.isUndefined(params.logoutTime)||list.push({rpc:67,data:{logout_time:6e4*params.logoutTime}}),_.isUndefined(params.rtktehBlock)||list.push({rpc:constants.CONFIG_ID_RTKTEH,data:{rtkteh_block:params.rtktehBlock}});var promiseList=[];return _.each(list,function(item){promiseList.push(somovd.write(item.rpc,item.data))}),Promise.all(promiseList).then(function(response){return funcs.is.allRPCSuccess({rq:response})?($rootScope.$emit("slacker.reload"),Promise.resolve()):Promise.reject()})},changeAutoPingReboot:function(data){return somovd.write(constants.CONFIG_ID_VELCOM,data).then(function(response){return funcs.is.RPCSuccess(response)?Promise.resolve():Promise.reject()})}}}])}();
;"use strict";!function(){angular.module("app").service("sysFirmwareUpdateService",["$rootScope","$http","$timeout","$q","device","authDigest","authDigestHelper","cookie",function($rootScope,$http,$timeout,$q,device,authDigest,authDigestHelper,cookie){function fwupdateEndPoint(action){var url="/fwupdate?action="+action+"&_="+_.random(1e4,99999);return $http.get(url)}return{uploadBegin:function(){var header=authDigestHelper.generateHeader({url:"/fwupload",method:"POST"});cookie.set("Authorization",header,3,"sec"),$rootScope.$emit("device.action.started",{action:"fwupdate.local"})},uploadEnd:function(res){var deferred=$q.defer();return res&&res.data&&!res.data.status?($rootScope.$emit("device.action.failed",{action:"fwupdate.local"}),deferred.reject()):deferred.resolve(),deferred.promise},getStatus:function(){return fwupdateEndPoint("status")},getInfo:function(){return fwupdateEndPoint("getinfo")},upgrade:function(){return fwupdateEndPoint("upgrade")},backup:function(){var deferred=$q.defer();return $rootScope.$emit("device.action.suspend",{action:"fwupdate.local"}),device.system.backup(function(){var url="/config_load",header=authDigestHelper.generateHeader({url:url,method:"GET"});cookie.set("Authorization",header,3,"sec"),document.location.href=url,$timeout(function(){$rootScope.$emit("device.action.resume",{action:"fwupdate.local"}),deferred.resolve()},7e3)},function(){deferred.reject()}),deferred.promise},cancel:function(){return fwupdateEndPoint("cancel").then(function(){$rootScope.$emit("device.action.succeed",{action:"fwupdate.local"})})},checkVersion:function(input){return device.system.checkVersion(input.data.current_version,input.data.new_version)}}}])}();
;"use strict";!function(){angular.module("app").service("sysFirmwareUtil",["$rootScope","$timeout","sysFirmwareUpdateService","device","funcs","somovd","translate",function($rootScope,$timeout,fwUpdateService,device,funcs,somovd,translate){function remoteUpdate(){function startUpdate(){return new Promise(function(resolve,reject){resolve(),device.system.remoteUpdate(function(){$rootScope.$emit("device.action.started",{action:"fwupdate.remote"}),resolve()},function(){reject()})})}function cancelUpdate(){return new Promise(function(resolve){resolve()})}var input;return config&&config.Version?(input={data:{new_version:config.Version,current_version:version}},checkNeedSaveBackup(input,startUpdate,cancelUpdate)):void 0}function getConfig(){return config}function getStatus(){if(config){var messages={update_available:{text:translate("firmware_new_version")+" ("+config.Version+")",color:"green"},device_is_not_supported:{text:translate("firmware_remote_file_absent"),color:"red"},latest_fw_version:{text:translate("firmware_new_version_unavailable"),color:"gray"},update_not_checked:{text:"",color:""},other:{text:translate("firmware_unknown_error"),color:"red"}};return status in messages||(status="other"),messages[status]}}function checkNeedSaveBackup(__input,funcUpgrade,funcCancel){var checkVersion=fwUpdateService.checkVersion(__input);switch(checkVersion){case"need_backup":return alert(translate("firmware_force_reset")),fwUpdateService.backup().then(function(){return confirm(translate("firmware_continue_update"))?funcUpgrade():funcCancel()});case"maybe_backup":return confirm(translate("firmware_maybe_reset"))?fwUpdateService.backup().then(function(){return confirm(translate("firmware_continue_update"))?funcUpgrade():funcCancel()}):confirm(translate("firmware_continue_update"))?funcUpgrade():funcCancel();default:return funcUpgrade()}}function getVersion(){return version}function isNeedUpdate(){return needUpdate}function __prepareConfig(config){var input=converter.nativeToSomovd(config);return _.pick(input,"enable","server","period")}function __errorMsg(){alert(translate("firmware_file_invalid"))}var config=null,status=null,version=null,needUpdate=!1,constants={AUTOUPDATE_RPC:178,DEVICE_INFO_RPC:67,DEVICE_LOCAL_FIRMWARE_UPLOAD_TIME:parseInt(autoconf.BR2_PACKAGE_ANWEB_DEVICE_LOCAL_FIRMWARE_UPLOAD_TIME)},converter=device.firmware.converter;return{init:function(){var rpcList=[];return rpcList.push(constants.DEVICE_INFO_RPC),rpcList.push(constants.AUTOUPDATE_RPC),somovd.read(rpcList,function(response){if(!funcs.is.allRPCSuccess(response))return Promise.reject();var rq=response.rq;return version=rq[0].data.fw_version,rq[1]&&(config=converter.somovdToNative(rq[1].data),needUpdate=rq[1].data.need_update,status=rq[1].data.status),Promise.resolve()})},apply:function(input,check){var input=__prepareConfig(input);return check&&(input.check_updates=!0),somovd.write(constants.AUTOUPDATE_RPC,input,function(response){return funcs.is.RPCSuccess(response)?(config=converter.somovdToNative(response.data),status=response.data.status,needUpdate=response.data.need_update,Promise.resolve()):Promise.reject()})},remoteUpdate:remoteUpdate,getConfig:getConfig,getStatus:getStatus,getVersion:getVersion,useFormData:!1,localFwUploadBefore:null,localFwUploadBegin:function(){function fwUpgradeCheckStatus(res){var input=res&&res.data?res.data:{};return input.error?(__errorMsg(),fwUpdateService.cancel()):void 0}fwUpdateService.uploadBegin(),$timeout(function(){fwUpdateService.getStatus().then(fwUpgradeCheckStatus)},constants.DEVICE_LOCAL_FIRMWARE_UPLOAD_TIME)},localfwUploadEnd:function(res){!function(res){return res&&res.data&&!res.data.status?(__errorMsg(),fwUpdateService.cancel()):void 0}(res)},isNeedUpdate:isNeedUpdate}}])}();
;"use strict";!function(){angular.module("app").service("sysLogUtil",["funcs","device","devinfo","somovd",function(funcs,device,devinfo,somovd){function apply(config){var writeData=converterSyslog.nativeToSomovd(config);return somovd.write(constants.SYSLOG_CONF_RPC,writeData,-1).then(function(response){return response.status==constants.INVALID_USB_PATH?Promise.reject({name:"invalid_usb_path",msg:"syslog_invalid_usb_path_win"}):funcs.is.RPCSuccess(response)?Promise.resolve():Promise.reject()})}function getLevels(){return attrs.Levels}function getDestinationList(){return attrs.Destination}function getSettings(){return config?config:{}}var config={},attrs=null,constants={SYSLOG_CONF_RPC:63,SYSLOG_READ_RPC:130,INVALID_USB_PATH:79,USB_VOLUME_RPC:82,USB_UMOUNT_RPC:154},converterSyslog=device.systemLog.converterSyslog,converterUsb=device.systemLog.converterUsbInfo;return{pullSettings:function(){return somovd.read(constants.SYSLOG_CONF_RPC).then(function(response){var data;return response.status==constants.INVALID_USB_PATH||funcs.is.RPCSuccess(response)?(data=response.data,data.isInvalidPath=response.status==constants.INVALID_USB_PATH?!0:!1,config=converterSyslog.somovdToNative(data),attrs=converterSyslog.attrsToNative(),Promise.resolve()):Promise.reject()})},apply:apply,updateUsbStorage:function(subscribeFunc,$scope){function prepareData(res){var data;res&&res[constants.USB_VOLUME_RPC]&&(data=converterUsb.somovdToNative(res[constants.USB_VOLUME_RPC]),subscribeFunc(data))}devinfo.once(""+constants.USB_VOLUME_RPC).then(function(res){prepareData(res),devinfo.subscribe(""+constants.USB_VOLUME_RPC,prepareData,$scope),$scope.$emit("pageload")})},unmountUsb:function(device){return somovd.write(constants.USB_UMOUNT_RPC,{name:device.Mountpoint},-1).then(function(response){return funcs.is.RPCSuccess(response)?Promise.resolve():void Promise.reject()})},updateLog:function(){return somovd.read(constants.SYSLOG_READ_RPC).then(function(response){return funcs.is.RPCSuccess(response)&&response.data&&response.data.list?Promise.resolve(response.data.list):Promise.reject()})},needExt:function(){return!1},getLevels:getLevels,getDestinationList:getDestinationList,getSettings:getSettings}}])}();
;"use strict";!function(){angular.module("app").service("systemNtpUtil",["somovd","devinfo","device","funcs",function(somovd,devinfo,device,funcs){function apply(input){var config=converter.dsysinitToSomovd(input);return somovd.write(RPC,config).then(function(response){return funcs.is.allRPCSuccess(response)?Promise.resolve():Promise.reject()})}function makeHelper(){return new device.systemTime.Helper(config)}var config=null,converter=device.systemTime.converter,RPC=device.systemTime.constants.rpc,paths=device.systemTime.constants.paths;return{pull:function(){return somovd.read(RPC).then(function(response){var input=response.data.ntpclient;return config=converter.somovdToDsysinit(input),Promise.resolve()})},apply:apply,subscribeTime:function(cb,$scope){devinfo.subscribe(RPC.toString(),function(response){if(response&&response[RPC.toString()]){var input=converter.somovdToDsysinit(response[RPC.toString()].ntpclient),time=funcs.fetchBranch(input,paths.time);cb&&cb(time)}},$scope)},makeHelper:makeHelper}}])}();
;"use strict";!function(){angular.module("app").service("pingUtil",["somovd","funcs",function(somovd){return{init:function(){return Promise.resolve()},getPing:function(params){return somovd.write(18,params)}}}])}();
;"use strict";!function(){angular.module("app").service("tracerouteUtil",["somovd","eventHandler","funcs",function(somovd,eventHandler){return{init:function(){return Promise.resolve({eventHandler:eventHandler})},getTraceroute:function(params){var somovdObj=somovd.getInstance({timeout:6e5});return somovdObj.write(166,params)}}}])}();
;"use strict";!function(){angular.module("app").service("vserversUtil",["somovd","devinfo","device","funcs",function(somovd,devinfo,device,funcs){function getConfig(){return angular.copy(config)}var config=null,__initVservers=null,Helper=device.vservers.Helper,converter=device.vservers.converter,consts={CONFIG_ID_WAN_TEMP:1,CONFIG_ID_DSL_VSERVERS:10,CONFIG_ID_HTTPACCESS:16,CONFIG_ID_VOIP:76,CONFIG_ID_TR69:70,RPC_NEED_REBOOT:12,RPC_NEED_SAVE:13,RPC_OK:20};return{getConfig:getConfig,getLanIP:function(){return angular.copy(null)},pull:function(){var rpcs=[consts.CONFIG_ID_DSL_VSERVERS,consts.CONFIG_ID_HTTPACCESS,consts.CONFIG_ID_WAN_TEMP];return rpcs.push(consts.CONFIG_ID_TR69),somovd.read(rpcs).then(function(response){if(!funcs.is.allRPCSuccess(response))return Promise.reject();var input={vserver:response.rq[0].data.vserver,httpaccess:_.has(response.rq[1].data,"httpaccess")?response.rq[1].data.httpaccess:response.rq[1].data,ifaces:response.rq[2].data},numRPC=3;return input.tr69=response.rq[numRPC].data,numRPC++,config=converter.somovdToNative(input),__initVservers=funcs.deepClone(input.vserver),Promise.resolve()})},getDefaultRule:function(){var defRule={Enable:!0,Proto:"TCP",Type:"custom",Name:"",Source:{Iface:"all",IP:[""],Ports:{1:{Start:"",End:"",PortType:"list"}}},Dest:{IP:[""],Ports:{1:{Start:"",End:"",PortType:"list"}}}};return defRule.SNAT=!1,defRule},removeRules:function(items){var indexes=_.pluck(items,"__id"),removeList=function(indexes){return indexes=indexes.sort().reverse(),_.map(indexes,function(index){return{id:consts.CONFIG_ID_DSL_VSERVERS,data:__initVservers[index],pos:index}})}(indexes);return somovd.remove(removeList,function(response){return funcs.is.allRPCSuccess(response)?Promise.resolve():Promise.reject()}),Promise.resolve()},applyRule:function(rule,index){var convertRules=converter.nativeToSomovd({Rules:[rule]});return convertRules&&0!=convertRules.length?somovd.write(consts.CONFIG_ID_DSL_VSERVERS,convertRules[0],_.isUndefined(index)?-1:index,function(response){return funcs.is.RPCSuccess(response)||Promise.reject(),Promise.resolve()}):Promise.reject()},makeHelper:function(){return new Helper}}}])}();
;"use strict";angular.module("app").controller("WanAddCtrl",["$scope","$state","$stateParams","$timeout","$q","ngDialog","translate","pageList","wanHelper","history","navigationFilter",function($scope,$state,$stateParams,$timeout,$q,ngDialog,translate,pageList,wanHelper,history,navFilter){$script(pageList.wanAdd.lazyDeps,function(){$scope.__args={$state:$state,$stateParams:$stateParams,$q:$q,$timeout:$timeout,ngDialog:ngDialog,translate:translate,wanHelper:wanHelper,history:history,navFilter:navFilter};try{$scope.$apply(WanAddCtrl)}catch(e){$state.go("error",{code:"msg_lazy_load_error",message:"msg_lazy_load_error_desc"})}})}]);
;"use strict";angular.module("app").controller("wanEditCtrl",["$scope","$rootScope","$state","$stateParams","$q","$timeout","translate","pageList","history","wanHelper","navigationFilter",function($scope,$rootScope,$state,$stateParams,$q,$timeout,translate,pageList,history,wanHelper,navigationFilter){$script(pageList.wanEdit.lazyDeps,function(){$scope.__args={$rootScope:$rootScope,$state:$state,$stateParams:$stateParams,$q:$q,$timeout:$timeout,translate:translate,history:history,wanHelper:wanHelper,customRules:navigationFilter.rules()||{}},window.wanEditCtrl?$scope.$apply(wanEditCtrl):$state.go("error",{code:"msg_lazy_load_error",message:"msg_lazy_load_error_desc"})})}]);
;"use strict";!function(){angular.module("app").controller("WanInfoConnectionsCtrl",["$scope","$state","translate","wanHelper","wanHelperSimple","$timeout","navigationFilter","devinfo",function($scope,$state,translate,helper,helperSimple,$timeout,navFilter){function clean(){connections.list.length=0}function make(raws){clean(),connections.list.length=0;var prepared=_.map(raws,function(conn){var data=helper.connection.getConnection(conn.type,conn.instance),info=helperSimple.makeFields(conn,core.getgwStatus(data),core.getWifiClientData());return info});_.each(_.compact(prepared),function(item){return connections.list.push(item)}),connections.isMakeList=!0}function add(actualType){$state.go(currentState+".connection.add",{})}function edit(item){item.notEdit||$state.go(currentState+".connection.edit",{type:item.type,inx:item.inx})}var device=$scope.device,core=$scope.wanCore;device.wan.supported(),$scope.customRules=navFilter.rules()||{},$scope.wan.info.connections={list:[],clean:clean,make:make,isEmpty:function(){return 0==this.list.length},isSingle:function(){return 1==this.list.length},getMiniTableStatusInfo:function(item){var statusInfo=item.status();return'<status-info\n                        status="'+statusInfo.status+'"\n						on="'+statusInfo.statusText+'"\n                        off="'+statusInfo.statusText+'"\n                        pending="'+statusInfo.statusText+'"\n                        disconnected="'+statusInfo.statusText+'"\n                        >\n                    </status-info>'},getMiniInfo:function(item){var result="";return result+=translate(item.actualType),"Unknown"!=item.iface.type&&(result+="/"+translate(item.iface.type)),result},add:add,edit:$scope.customRules.NotEditWanConnection?null:edit,remove:function(items){_.isArray(items)||(items=[items]);var items=_.filter(items,function(item){return!item.notEdit});core.cut(items).then(function(){info.update()})},reconnectItem:function(item){item._reconnecting=!0,device.wan.reconnect([item],function(){$timeout(function(){item._reconnecting=!1},2e3)})},reconnectItems:function(items){$scope.reconnecting=!0,device.wan.reconnect(items,function(){$scope.reconnecting=!1})},reconfigure:function(){device.wan.setAutomaticalPPTP(!1),add()},isReconnecting:function(){return $scope.reconnecting?!0:!1}},$scope.wan.info.connections.isMakeList=!1;var info=$scope.wan.info,connections=$scope.wan.info.connections;info.isActivate&&make(info.raws),$scope.$on("wan.info.activate",function($event,raws){make(raws)}),$scope.$on("wan.info.update",function($event,raws){make(raws)}),$scope.$on("wan.info.update_raws",function($event,raws){make(raws)});var currentState=$state.current.name.split(".");currentState.pop(),currentState=currentState.join(".")}])}();
;"use strict";!function(){angular.module("app").controller("WanInfoGwifCtrl",["$scope","translate","wanHelper","devinfo","navigationFilter",function($scope,translate,helper,devinfo,navFilter){function updateGwif(data){wan.setData(data),make(info.raws)}function make(raws){function filterRaws(raws){return _.filter(raws,function(raw){return raw.data&&1!=raw.data.AutomaticalConnection&&"bridge"!=raw.type})}clean();var raws=filterRaws(raws);!function(raws){_.each(gwif.versions,function(version){var gateway=getGwif(raws,version);gwif.list.push(gateway)})}(raws)}function clean(){gwif.list.length=0}function getUseVersion(){return _.chain(gwif.list).filter(function(elem){return elem.has()}).map(function(elem){return elem.version}).value()}function getGwif(conns,version){var list=function(conns,version){return _.chain(conns).filter(function(elem){if("ipv4oe"==elem.type&&$scope.customRules.HideWanIPv4oE)return!1;if(!(_.some($scope.customRules.HideWanConnectionsList,function(wc){return wc==elem.data.Name})||elem.data.VLAN&&_.some($scope.customRules.BanWanVlansList,function(v){return Number(v)===elem.data.VLAN.ID}))){var versions=helper.connection.identifyVersions(elem);return _.contains(versions,version)}}).map(function(elem){var conn=elem.data,type=elem.type,inx=elem.instance;return{label:conn.Name,value:"Device.WAN."+helper.connection.getDataModelName(type)+".Connection."+inx+".",disabled:conn.DisabledGateway||$scope.customRules.DisableWANGateway,isFailover:conn.IsFailover,isLoadBalancing:conn.IsLoadBalancing}}).value()}(conns,version),value=function(list,version){var path=wan.gwif.getValue(version);if(!path)return"";var obj=_.find(list,function(elem){return elem.value==path});return obj?obj.value:""}(list,version),reserveEnable=_.some(list,function(elem){return elem.isFailover}),loadBalancingEnable=_.some(list,function(elem){return elem.isLoadBalancing});return{version:version,title:"IP"+version,list:list,value:value,update:function(){wan.gwif.setValue(this.version,this.value);var overlay=$scope.overlay.circular,overlayId=overlay.start();core.updateGwif()["finally"](overlay.stop.bind(overlay,overlayId))},has:function(){return this.list.length>0},isSelect:function(){return this.value?!0:!1},error:function(){return this.isSelect()?null:"wan_gwif_not_set"},reserveEnable:reserveEnable,loadBalancingEnable:loadBalancingEnable}}var device=$scope.device,wan=device.wan;$scope.customRules=navFilter.rules()||{},$scope.wan.info.gwif={list:[],versions:["v4","v6"],clean:clean,make:make,has:function(){return _.some(gwif.list,function(elem){return elem.has()})},getLabel:function(){var versions=getUseVersion(),hq=$scope.wanCore.constants.HQ_APP;return versions.length>1||hq?translate("default_gateway"):"v4"==versions[0]?translate("wan_gwifv4_label"):"v6"==versions[0]?translate("wan_gwifv6_label"):""},checkStyle:function(name){var versions=getUseVersion(),curStyle=versions.length>1?"table":"single";return name==curStyle}};var info=$scope.wan.info,gwif=$scope.wan.info.gwif,core=$scope.wanCore;info.isActivate&&make(info.raws),$scope.$on("wan.info.activate",function($event,raws){make(raws)}),$scope.$on("wan.info.update",function($event,raws){make(raws)}),function(){if(_.some(gwif.list,function(elem){return elem.reserveEnable})){var area=wan.getWanUpdateArea();devinfo.subscribe(area,updateGwif,$scope)}}()}])}();
;"use strict";!function(){angular.module("app").service("wanDefineConstants",["device","navigationFilter",function(device,navigationFilter){var customRules=navigationFilter.rules()||{},constants={BR2_PACKAGE_ANWEB_SUPPORT_RIP:autoconf.BR2_PACKAGE_ANWEB_SUPPORT_RIP,BCM_MODEM:autoconf.BR2_PACKAGE_ANWEB_BCM_MODEM,REALTEK_MODEM:autoconf.BR2_PACKAGE_ANWEB_REALTEK_MODEM,BR2_PACKAGE_ANWEB_SUPPORT_ADSL:autoconf.BR2_PACKAGE_ANWEB_SUPPORT_ADSL,DVG_N5402SP1S:"DVG-N5402SP"==autoconf.BR2_PACKAGE_ANWEB_DEVICEID,DVG_N5402SP2S1U:"DVG-N5402SP"==autoconf.BR2_PACKAGE_ANWEB_DEVICEID,BR2_PACKAGE_ANWEB_WAN_IPOE_DYNAMIC:autoconf.BR2_PACKAGE_ANWEB_WAN_IPOE_DYNAMIC,BR2_PACKAGE_ANWEB_WAN_IPOE_STATIC:autoconf.BR2_PACKAGE_ANWEB_WAN_IPOE_STATIC,BR2_PACKAGE_ANWEB_WAN_IPOEV6_DYNAMIC:autoconf.BR2_PACKAGE_ANWEB_WAN_IPOEV6_DYNAMIC,BR2_PACKAGE_ANWEB_WAN_IPOEV6_STATIC:autoconf.BR2_PACKAGE_ANWEB_WAN_IPOEV6_STATIC,BR2_PACKAGE_ANWEB_WAN_IPOA:autoconf.BR2_PACKAGE_ANWEB_WAN_IPOA,BR2_PACKAGE_ANWEB_IPV6:autoconf.BR2_PACKAGE_ANWEB_IPV6,BR2_PACKAGE_ANWEB_WAN_PPPOE:autoconf.BR2_PACKAGE_ANWEB_WAN_PPPOE,BR2_PACKAGE_ANWEB_PPPOE_IGMP_TRUE:autoconf.BR2_PACKAGE_ANWEB_PPPOE_IGMP_TRUE,BR2_PACKAGE_ANWEB_WAN_PPPOA:autoconf.BR2_PACKAGE_ANWEB_WAN_PPPOA,BR2_PACKAGE_ANWEB_WAN_PPTP:autoconf.BR2_PACKAGE_ANWEB_WAN_PPTP,BR2_PACKAGE_ANWEB_WAN_L2TP:autoconf.BR2_PACKAGE_ANWEB_WAN_L2TP,BR2_PACKAGE_ANWEB_WAN_3G:autoconf.BR2_PACKAGE_ANWEB_WAN_3G,BR2_PACKAGE_ANWEB_WAN_LTE:autoconf.BR2_PACKAGE_ANWEB_WAN_LTE,BR2_PACKAGE_ANWEB_WAN_PPPOE_IPV6:autoconf.BR2_PACKAGE_ANWEB_WAN_PPPOE_DUAL,BR2_PACKAGE_ANWEB_WAN_PPPOE_DUAL:autoconf.BR2_PACKAGE_ANWEB_WAN_PPPOE_DUAL,BR2_PACKAGE_ANWEB_WAN_BRIDGE:autoconf.BR2_PACKAGE_ANWEB_WAN_BRIDGE,BR2_PACKAGE_ANWEB_WAN_BRIDGE_WITH_IPOE:autoconf.BR2_PACKAGE_ANWEB_WAN_BRIDGE_WITH_IPOE,BR2_PACKAGE_ANWEB_WAN_IPOEDUAL:autoconf.BR2_PACKAGE_ANWEB_WAN_IPOEDUAL,BR2_PACKAGE_ANWEB_WAN_VLAN_SECTION:autoconf.BR2_PACKAGE_ANWEB_WAN_VLAN_SECTION,BR2_PACKAGE_ANWEB_WAN_SIMPLE_MODE:autoconf.BR2_PACKAGE_ANWEB_WAN_SIMPLE_MODE,BR2_PACKAGE_ANWEB_WAN_SIMPLE_MODE_ONLY:autoconf.BR2_PACKAGE_ANWEB_WAN_SIMPLE_MODE_ONLY||customRules.WanSimpleModeOnly,BR2_PACKAGE_ANWEB_WAN_AUTH_802_1X:autoconf.BR2_PACKAGE_ANWEB_WAN_AUTH_802_1X,BR2_PACKAGE_ANWEB_MLD:autoconf.BR2_PACKAGE_ANWEB_MLD,HEALTH_CHECK_LTE:autoconf.BR2_PACKAGE_ANWEB_HEALTH_CHECK_LTE,BR2_PACKAGE_ANWEB_WAN_PING_FOR_ALL:autoconf.BR2_PACKAGE_ANWEB_WAN_PING_FOR_ALL,SUPPORT_DYNIP_DEFAULT_VENDER_ID:autoconf.BR2_PACKAGE_ANWEB_WAN_DYNIP_DEFAULT_VENDER_ID,SUPPORT_L2TP_EXTRA_OPTIONS:autoconf.BR2_PACKAGE_ANWEB_WAN_L2TP_EXTRA_OPTIONS,RENAME_USB_TO_LTE:autoconf.BR2_PACKAGE_ANWEB_RENAME_USB_TO_LTE,CUSTOM_2KOM_21535:autoconf.BR2_PACKAGE_ANWEB_CUSTOM_2KOM_21535,CUSTOM_DRS_24254:autoconf.BR2_PACKAGE_ANWEB_CUSTOM_DRS_24254,CUSTOM_HQ_DME_22231:autoconf.BR2_PACKAGE_ANWEB_CUSTOM_HQ_DME_22231,BR2_PACKAGE_ANWEB_WAN_AUTH_KABINET:autoconf.BR2_PACKAGE_ANWEB_WAN_AUTH_KABINET,HQ_APP:autoconf.BR2_PACKAGE_ANWEB_HQ_ADMIN_APP,PPPOE_WITHOUT_AUTH:customRules.PPPoEWithoutAuthorization,CUSTOM_SPECTRANET_25889:autoconf.BR2_PACKAGE_ANWEB_CUSTOM_SPECTRANET_25889,CUSTOM_OTS_26172:autoconf.BR2_PACKAGE_ANWEB_CUSTOM_ORGTECHSERVICE_26172,DYNIP_DEFAULT_VENDER_ID:autoconf.BR2_PACKAGE_ANWEB_WAN_DYNIP_DEFAULT_VENDER_ID,CUSTOM_PARTNER_23078:autoconf.BR2_PACKAGE_ANWEB_CUSTOM_PARTNER_23078,CUSTOM_PODRYAD_27207:autoconf.BR2_PACKAGE_ANWEB_CUSTOM_PODRYAD_27207,CUSTOM_MALAYSIA_33335:autoconf.BR2_PACKAGE_ANWEB_CUSTOM_MALAYSIA_33335};return device.wan.defineConstants(constants),constants}])}();
;"use strict";!function(){angular.module("app").service("wifiClientUtil",["devinfo",function(devinfo){var constants={CONFIG_ID_WIFI_SCAN:133,CONFIG_ID_WIFI_SCAN_5G:185,CONFIG_ID_WIFI_INFO:35};return{pullScan:function(){var rpcList=[];return rpcList.push(constants.CONFIG_ID_WIFI_SCAN),rpcList.push(constants.CONFIG_ID_WIFI_SCAN_5G),devinfo.once(rpcList.join("|"),{timeout:6e4}).then(function(data){var data=_.pick(data,_.values(rpcList));return data})},startUpdateClientStatus:function(cb,$scope){devinfo.subscribe(constants.CONFIG_ID_WIFI_INFO.toString(),function(data){var result;data[constants.CONFIG_ID_WIFI_INFO.toString()]&&(data[constants.CONFIG_ID_WIFI_INFO.toString()].apcli||data[constants.CONFIG_ID_WIFI_INFO.toString()]["5G_apcli"])&&(result="5GHz"==$scope.band.state?data[constants.CONFIG_ID_WIFI_INFO.toString()]["5G_apcli"].ApCliConnect:data[constants.CONFIG_ID_WIFI_INFO.toString()].apcli.ApCliConnect,cb&&cb(result))},$scope)},checkEncryptionType:function(){return!0}}}])}();
;"use strict";!function(){angular.module("app").service("wifiClientMgmUtil",["funcs","device","devinfo","somovd","translate",function(funcs,device,devinfo,somovd,translate){function formClients(clients){function formSize(value){return value?funcs.lookSize(value).toString(sizeTranslater):"-"}function formSpeed(value){return value?funcs.lookSize(1024*value*1024/8,"bit").toString(sizeTranslater)+"/"+translate("units_dt_S"):"-"}function sizeTranslater(value){return translate("units_"+value)}return _.map(clients,function(client){return _.has(client,"TxBytes")&&(client.TxBytes=formSize(client.TxBytes)),_.has(client,"RxBytes")&&(client.RxBytes=formSize(client.RxBytes)),_.has(client,"Rate")&&(client.Rate=formSpeed(client.Rate)),client})}var config={},constants={wifiInfo:35,wifiClientsMgm:64,ipv4:34,ipv6:193},converter=device.wifiClientMgm.converter;return{pull:function(){return somovd.read([constants.wifiInfo,constants.wifiClientsMgm,constants.ipv4,constants.ipv6]).then(function(response){var rq,input;return funcs.is.RPCSuccess(response.rq[1])?(rq=response.rq,config.supported=rq[0].data,input={clients:rq[1].data,ip:_.union(rq[2].data?rq[2].data:[],rq[3].data?rq[3].data:[])},config.clients=converter.somovdToNative(input),Promise.resolve()):Promise.reject()})},subsribeClientInfo:function(cb,$scope,id){devinfo.subscribe(constants.wifiClientsMgm.toString()+"|"+constants.ipv4.toString()+"|"+constants.ipv6.toString(),function(response){var ipv4,ipv6,input,data;response&&response[constants.wifiClientsMgm.toString()]&&(ipv4=response[constants.ipv4.toString()],ipv6=response[constants.ipv6.toString()],input={clients:response[constants.wifiClientsMgm.toString()],ip:_.union(ipv4?ipv4:[],ipv6?ipv6:[])},data=converter.somovdToNative(input),cb&&cb(formClients(data),id))},$scope)},updateClients:function(){return somovd.read([constants.wifiClientsMgm,constants.ipv4,constants.ipv6]).then(function(response){var rq,input;return funcs.is.RPCSuccess(response.rq[0])?(rq=response.rq,input={clients:rq[0].data,ip:_.union(rq[1].data?rq[1].data:[],rq[2].data?rq[2].data:[])},config.clients=converter.somovdToNative(input),void 0):Promise.reject()})},disconnect:function(items){function getMac(client){return{mac:client.MAC,band:client.Band}}var macs=function(){return items.map(getMac)}();return somovd.write(108,macs,-1).then(function(response){return funcs.is.RPCSuccess(response)?Promise.resolve():Promise.reject()})},getClients:function(){return config&&config.clients?formClients(config.clients):{}},isSupported5G:function(){return config&&config.supported?config.supported["5G_Radio"]:!1}}}])}();
;"use strict";!function(){angular.module("app").controller("WifiAPSettings",["$scope","$state","device","cookie","history","translate",function($scope,$state,device,cookie,history,translate){function supportedModes(){if(!$scope.wifi.ap.data)return[];var operatingStands=$scope.wifi.general&&$scope.wifi.general.data&&$scope.wifi.general.data.OperatingStandards?$scope.wifi.general.data.OperatingStandards:standards,modeAvailable=$scope.wifi.general&&$scope.wifi.general.data&&$scope.wifi.general.data.ModeAvailable?$scope.wifi.general.data.ModeAvailable:availableModes,modesTemplate=helper.getTempModes(modeAvailable,operatingStands),modesSupported=$scope.wifi.ap.data.Security.ModesSupported.split(","),modes=_.filter(modesTemplate,function(obj){return~_.indexOf(modesSupported,obj.value)});return $scope.customRules.ExcludeWifiSecurityMode&&(modes=_.filter(modes,function(item){return!_.some($scope.customRules.ExcludeWifiSecurityMode,function(exclude){return exclude==item.value})})),_.findWhere(modes,{value:$scope.wifi.ap.data.Security.ModeEnabled})||($scope.wifi.ap.data.Security.ModeEnabled=modes[0].value),_.each(modes,function(item,index){/mixed/.test(item.name)&&(modes[index].name=item.name.replace("mixed",translate("wifi_mixed")))}),modes}function showSecurity(type){var operatingStands=$scope.wifi.general&&$scope.wifi.general.data&&$scope.wifi.general.data.OperatingStandards?$scope.wifi.general.data.OperatingStandards:standards,modeAvailable=$scope.wifi.general&&$scope.wifi.general.data&&$scope.wifi.general.data.ModeAvailable?$scope.wifi.general.data.ModeAvailable:availableModes;return helper.checkSecurityType(type,$scope.wifi.ap.data,operatingStands,modeAvailable)}function isOpen(){var operatingStands=$scope.wifi.general&&$scope.wifi.general.data&&$scope.wifi.general.data.OperatingStandards?$scope.wifi.general.data.OperatingStandards:standards,modeAvailable=$scope.wifi.general&&$scope.wifi.general.data&&$scope.wifi.general.data.ModeAvailable?$scope.wifi.general.data.ModeAvailable:availableModes;return helper.isOpen($scope.wifi.ap.data,operatingStands,modeAvailable)}function getEncrypTypes(){var operatingStands=$scope.wifi.general&&$scope.wifi.general.data&&$scope.wifi.general.data.OperatingStandards?$scope.wifi.general.data.OperatingStandards:standards,modeAvailable=$scope.wifi.general&&$scope.wifi.general.data&&$scope.wifi.general.data.ModeAvailable?$scope.wifi.general.data.ModeAvailable:availableModes;return helper.getEncrypTypes($scope.wifi.ap.data,operatingStands,modeAvailable)}function changeBandwidthRestricted(value){!$scope.wifi.ap.data||_.isNull(value)||_.isUndefined(value)||(value?$scope.BandwidthRestrictedBackup&&($scope.wifi.ap.data.BandwidthRestricted=angular.copy($scope.BandwidthRestrictedBackup),$scope.BandwidthRestrictedBackup=null):($scope.BandwidthRestrictedBackup=angular.copy($scope.wifi.ap.data.BandwidthRestricted),$scope.wifi.ap.data.BandwidthRestricted=0))}function isEdit(){return"edit"===action}function isAdd(){return"add"===action}function isChange(){return _.size(device.funcs.getChanges($scope.wifi.ap.data,backupData))}function initNSG(){_.isUndefined(backupData.NSG)&&(backupData.NSG=$scope.wifi.ap.data.NSG=!1)}var helper=device.wifi.helper,action=$state.current.name.split(".").pop(),freq=$state.params.freq,isAPMode="ap"===cookie.get("device_mode"),standards=null,backupData=null,availableModes=null;$scope.wifi.ap={data:null,supportedParam:function(param,subPath){var band=device.wifi.getBand(0),root=subPath?subPath+".":"";return band.ap.supportedParam(param,root)},supportedModes:supportedModes,showSecurity:showSecurity,showPreAuth:function(mode){return"WPA2-Enterprise"==mode||"WPA-WPA2-Enterprise"==mode},getEncrypTypes:getEncrypTypes,getDefaultKeysID:function(){return helper.getDefaultKeysID()},validWEPKey:function(wepKey){return $scope.wifi.ap.data?helper.validWEPKey(wepKey,$scope.wifi.ap.data):null},validPSKKey:function(pskKey){return helper.validPSKKey(pskKey)},validRadiusSecret:function(secret){return autoconf.BR2_PACKAGE_ANWEB_DSYSINIT?helper.validRadiusParamLen(secret):null},getWEPKeyLenMessage:function(){return $scope.wifi.ap.data?helper.getWEPKeyLenMessage($scope.wifi.ap.data):null},isOpen:isOpen,isEdit:isEdit,isAdd:isAdd,isChange:isChange,isShowGuestAccess:function(){return(isAdd()||$state.params.inx>1)&&!isAPMode},initNSG:initNSG,changeBandwidthRestricted:changeBandwidthRestricted},$scope.schedule={active:!1},$scope.BandwidthRestricted={enable:null,min:"1",max:"2.4GHz"==freq?"150":"450"},$scope.$watch(getEncrypTypes,function(types){if(types&&types.length&&$scope.wifi.ap.data){var encr=$scope.wifi.ap.data.Security.EncryptionType;_.contains(types,encr)||($scope.wifi.ap.data.Security.EncryptionType=types[0])}},!0),$scope.$watch("wifi.advancedAp.bandwidthRestrictedEnable",changeBandwidthRestricted),function(){var inxSsid,band=device.wifi.getBand(0),ap=band.ap;standards=band.radio.OperatingStandards,availableModes=band.radio.ModeAvailable,isEdit()?(history.setCleanLastHistory(!0),inxSsid=$state.params.inx,$scope.wifi.ap.data=ap.get(inxSsid)):isAdd()?(history.setCleanLastHistory(!0),inxSsid=ap.add(ap.getDefault()),$scope.wifi.ap.data=ap.get(inxSsid)):$scope.wifi.ap.data=ap.getBase(),$scope.wifi.ap.inxRadio=band.radio.Inx,$scope.wifi.ap.inxSsid=_.isUndefined(inxSsid)?"1":inxSsid,$scope.BandwidthRestricted.enable=0!=$scope.wifi.ap.data.BandwidthRestricted,backupData=angular.copy($scope.wifi.ap.data)}()}])}();
;"use strict";!function(){angular.module("app").controller("WifiAPForm",["$scope","navigationFilter","$state","device","wifiCommonShared",function($scope,navigationFilter,$state,device,shared){function isFormInvalid(){return $scope.form.$invalid}var rules=navigationFilter.rules(),action=$state.current.name.split(".").pop(),freq=$state.params.freq,inx=$state.params.inx;$scope.wifi={isActivate:!1,isWDSInBridgeMode:!1,apply:function(){isFormInvalid()||shared.apply({action:"ap",freq:freq})},wasModified:function(){return $scope.wifi.isActivate&&$scope.wifi.ap&&$scope.wifi.ap.isChange()},isAdd:function(){return"add"===action}},function(){$scope.loading=!0,shared.activate().then(function(){$scope.loading=!1,device.wifi.setBandFreq(freq),$scope.wifi.isActivate=!0;var wds=device.wifi.getWDSData();$scope.wifi.isWDSInBridgeMode=wds&&"Bridge"==wds.Mode,$scope.customRules=_.isFunction(rules.GetRulesForSSID)?rules.GetRulesForSSID(inx,$scope.wifi.ap):rules,$scope.$emit("pageload")})}()}])}();
;"use strict";!function(){angular.module("app").controller("WifiCommonAPInfo",["$scope","$state","translate","navigationFilter",function($scope,$state,translate,navFilter){function list(){return $scope.wifi.APInfo.ap.list()}function add(){$state.go(currentState+".ap.add",{freq:device.wifi.getBandFreq()})}function edit(item,key){$state.go(currentState+".ap.edit",{freq:device.wifi.getBandFreq(),inx:key})}function isOpen(ap){var apInfo=$scope.wifi.APInfo,security=apInfo.getModeName(ap.Security.ModeEnabled);return"Open"==security&&"NONE"==ap.Security.EncryptionType}function getImgLock(ap){return isOpen(ap)?"":'<img name="lock_img" src="/general/img/icon-lock.png">'}var device=$scope.device,helper=device.wifi.helper,navRules=navFilter.rules();$scope.wifi.APInfo={radio:null,ap:null,list:list,add:add,edit:edit,remove:function(items,keys){if(function(keys){return~keys.indexOf("1")}(keys))return void alert(translate("wifi_cant_remove_base_ap"));var ap=$scope.wifi.APInfo.ap;keys.forEach(function(key){ap.cut(key)})},getBSSID:function(ap){return ap.BSSID||"-"},getModeName:function(mode){return helper.getModeName(mode,$scope.wifi.APInfo.radio.OperatingStandards,$scope.wifi.APInfo.radio.ModeAvailable)},isShowAP:function(inx,ap){return navRules.HideWiFiAccessPointBySSID?!_.contains(navRules.HideWiFiAccessPointBySSID,ap.SSID):!/\-$/.test(inx)},isAddDisabled:function(){if(!$scope.wifi.APInfo.radio)return!1;var maxAPCount=$scope.wifi.APInfo.radio.AccessPointMax,currectAPCount=$scope.wifi.APInfo.radio.AccessPointNumberOfEntries;return currectAPCount>=maxAPCount},existDeletedAP:function(){return Object.keys(list()).some(function(key){return/\-$/.test(key)})}},$scope.$watch(function(){return device.wifi.getBandFreq()},function(newBand,oldBand){var band;!newBand||$scope.wifi.APInfo.radio&&_.isEqual(newBand,oldBand)||(band=device.wifi.getBand(0),$scope.wifi.APInfo.radio=band.radio,$scope.wifi.APInfo.ap=band.ap)}),$scope.getCaption=function(ap){return'<span class="mr-5">'+ap.SSID+"</span>"+getImgLock(ap)},$scope.isOpen=isOpen;var currentState=$state.current.name.split(".");currentState.pop(),currentState=currentState.join("."),$scope.getShort=function(ap){return $scope.wifi.APInfo.getBSSID(ap)}}])}();
;"use strict";!function(){angular.module("app").controller("WifiCommonGeneral",["$scope","translate","ngDialog",function($scope,translate,ngDialog){var device=$scope.device,helper=device.wifi.helper;$scope.wifi.general={data:null,supportedParam:function(param){var band,channels;return"HighChannelEnable"==param?device.wifi.supportedParam(param)?(band=$scope.wifi.general.data.OperatingFrequencyBand,channels=$scope.wifi.general.data.PossibleChannels,_.some(channels,function(channel){return"2.4GHz"==band?channel>11:channel>=100})):!1:"startChannelReselect"==param?!0&&device.wifi.supportedParam("AutoChannelReselect")&&device.wifi.supportedParam("AutoChannelType")&&$scope.wifi.general.initData.AutoChannelEnable&&$scope.wifi.general.data.AutoChannelEnable:device.wifi.supportedParam(param)},supportedStandards:function(){if(!$scope.wifi.general.data)return{};var result=helper.supportedStandards($scope.wifi.general.data.SupportedStandards);return _.each(result,function(val,key){/mixed/.test(val)&&(result[key]=val.replace("mixed",translate("wifi_mixed")))}),result},getPossibleCountries:function(){return device.wifi.countries()},selectWifiChannel:function(band){var dlg=ngDialog.open({template:"dialogs/wifi_channel_select/dialog.tpl.html",className:"wifi_wmm_edit_dialog",controller:"WifiChannelSelectCtrl",data:{currentChannel:$scope.wifi.general.data.Channel,band:band}});dlg.closePromise.then(function(data){data.value&&data.value.selected&&($scope.wifi.general.data.Channel=data.value.channel)})},getAutoChannelComment:function(){return translate("wifi_auto")+" ("+translate("wifi_channel").toLowerCase()+" "+($scope.wifi.CurrentChannel?$scope.wifi.CurrentChannel:$scope.wifi.general.data.Channel)+")"},getWifiHighChannelsComment:function(){return"5GHz"==$scope.wifi.band.state?"wifi_channel_high_comment":"wifi_channel_high_comment_24"},getWifiHighChannelsOffComment:function(){return"5GHz"==$scope.wifi.band.state?"wifi_channel_high_off_comment":"wifi_channel_high_off_comment_24"},invalidStandard:function(){var band=$scope.wifi.general.data.OperatingChannelBandwidth;if(!$scope.wifi.general.data.CheckStandard||"Auto"==band)return!1;switch($scope.wifi.general.data.OperatingStandards){case"a":case"b":case"g":case"bg":return"20MHz"!=band;case"n":case"an":return"20MHz"!=band&&"40MHz"!=band;default:return!1}},getChannelInfo:function(){switch($scope.wifi.general.data.OperatingStandards){case"a":return"wifi_cur_bw_info_80211_a_20";case"b":case"g":case"bg":return"wifi_cur_bw_info_80211_n_40";case"n":case"an":return"wifi_cur_bw_info_80211_ac_80_160"}},writeSupported:function(param){return device.wifi.writeSupported(param)}},$scope.schedule={active:!1},$scope.isClientMode=device.wifi.isClientMode(),$scope.$watch(function(){return device.wifi.getBandFreq()},function(newBand,oldBand){var band;!newBand||$scope.wifi.general.data&&_.isEqual(newBand,oldBand)||(band=device.wifi.getBand(0),$scope.wifi.general.data=band.radio,$scope.wifi.general.initData=angular.copy($scope.wifi.general.data),$scope.wifi.general.data.CheckStandard&&($scope.disabledStandarts="2.4GHz"==band.radio.OperatingFrequencyBand?"802.11 n":"802.11 ac/n"))})}])}();
;"use strict";!function(){angular.module("app").controller("wifiWPSSettings",["$scope","$state","device","wifiWpsUtil","ngDialog","funcs","wifiWpsShared","snackbars",function($scope,$state,device,util,ngDialog,funcs,shared,snackbars){function activate(){var band=device.wifi.getBand(0);$scope.wifi.wps.connectMethod=band.wps.getConnectMethod(inx),$scope.wifi.wps.info=band.wps.getInfo(inx),$scope.wifi.wps.data=band.wps.data(inx),saveBackup(),$scope.wifi.needUpdate=!1,resetStatusChecker()}function saveBackup(){backup.data=device.funcs.deepExtend({},$scope.wifi.wps.data)}function update(){$scope.wifi.wps.data.Enable?apply():apply(action)}function refresh(){var overlay=$scope.overlay.circular,overlayId=overlay.start();shared.activate().then(activate)["finally"](overlay.stop.bind(overlay,overlayId))}function resetStatusChecker(){device.wifi.getBand(0)}function apply(action){saveBackup(),action?shared.apply({action:action,freq:freq}):shared.apply()}var freq=$state.params.freq,inx=$state.params.inx||"1",currentState=$state.current.name.split("."),action="edit"==currentState.pop()?"wps":void 0,backup={};$scope.wifi.wps={data:null,connectMethod:null,connectStatus:null,info:{},hasWarning:function(name){var band=device.wifi.getBand(0),warnings=band.wps.warnings(inx);return name?_.contains(warnings,name):warnings.length},hasInfoParam:function(param){return $scope.wifi.wps.info?_.has($scope.wifi.wps.info,param):!1},supportParam:function(name){return _.has($scope.wifi.wps.data,name)}},$scope.wifi.isNotModified=function(){return $scope.wifi.wps.data&&backup?angular.equals($scope.wifi.wps.data,backup.data):!0},$scope.wifi.action={apply:apply,update:update,connect:function(){var dlg=ngDialog.open({template:"dialogs/wps_connection/dialog.tpl.html",controller:"WpsConnectionDialogController",resolve:funcs.getLazyResolve("dialogs/wps_connection/ctrl.lazy.js","WpsConnectionDialogController")});dlg.closePromise.then(function(result){if(result&&result.value&&!_.isString(result.value)){var band=device.wifi.getBand(0);_.extend(band.wps.data(inx),{Method:result.value.method,PIN:result.value.pin}),band.wps.connect(inx),apply(action)}})},refresh:refresh,reset:function(){var band=device.wifi.getBand(0);band.wps.reset(update,inx)},unlock:function(){util.unlock(function(response){funcs.is.RPCSuccess(response)||snackbars.add("msg_rpc_write_error"),activate()})},enableRadio:function(){var overlay=$scope.overlay.circular,overlayId=overlay.start();device.wifi.enableRadio(freq,function(){refresh(),overlay.stop(overlayId)})},enableRadioBroadcast:function(){var overlay=$scope.overlay.circular,overlayId=overlay.start();device.wifi.enableRadioBroadcast(freq,inx,function(){refresh(),overlay.stop(overlayId)})}},activate()}])}();
;"use strict";!function(){angular.module("app").controller("wifiWpsForm",["$scope","$state","device","wifiWpsShared",function($scope,$state,device,shared){var freq=$state.params.freq;$scope.wifi={isActivate:!1},function(){$scope.loading=!0,shared.activate().then(function(){$scope.loading=!1,device.wifi.setBandFreq(freq),$scope.wifi.isActivate=!0,$scope.$emit("pageload")})}()}])}();
;"use strict";!function(){angular.module("app").service("yandexDnsRulesUtil",["somovd","funcs","device",function(somovd,funcs,device){function push(settings){var input=converter.nativeToSomovd(settings),writeModel={br0:funcs.deepClone(wanModel.iface_names.br0)};return writeModel.br0.services.br0.dhcpd.reserved=input,somovd.write(rpc.wan,writeModel).then(function(response){return funcs.is.RPCSuccess(response)?Promise.resolve():Promise.reject()})}function getConfig(){return config?config:{}}function setRules(rules){config||(config={}),config.rules=funcs.deepClone(rules)}var config=null,wanModel=null,converter=device.yandexDns.converter,rpc={wan:1,dhcp:187,yandex:179},_availableModes=[{value:"off",label:"yadns_protection_off_mode"},{value:"safe",label:"yadns_safe_mode"},{value:"child",label:"yadns_child_mode"}],rpcList=[rpc.wan,rpc.dhcp,rpc.yandex];return{pull:function(){return somovd.read(rpcList).then(function(response){if(!funcs.is.allRPCSuccess(response))return Promise.reject();var input={wan_model:response.rq[0].data,dhcp_model:response.rq[1].data,yandex_model:response.rq[2].data};return wanModel=funcs.deepClone(input.wan_model),config=converter.somovdToNative(input),Promise.resolve()})},push:push,getConfig:getConfig,getAvailableModes:function(){return _availableModes},setRules:setRules}}])}();
;"use strict";!function(){angular.module("app").service("yandexDnsSettingsUtil",["somovd","funcs",function(somovd,funcs){function getConfig(){return config?config:{}}var config=null,rpc=179,_availableModes=[{value:"off",label:"yadns_protection_off_mode"},{value:"safe",label:"yadns_safe_mode"},{value:"child",label:"yadns_child_mode"}];return{pull:function(){return somovd.read(rpc).then(function(response){config=funcs.deepClone(response.data)})},push:function(settings){return somovd.write(rpc,settings,-1).then(function(response){return funcs.is.RPCSuccess(response)?Promise.resolve():Promise.reject()})},getConfig:getConfig,getAvailableModes:function(){return _availableModes}}}])}();
;"use strict";!function(){angular.module("app").service("telnetUtil",["somovd","funcs",function(somovd,funcs){function apply(input){var saveData=[];return!__backupTelnet||__backupTelnet.enable==input.Enable&&__backupTelnet.port==input.Port||saveData.push({id:152,data:{telnet:{enable:input.Enable,port:input.Port}},pos:-1}),!__backupSSH||__backupSSH.enable==input.SSH.Enable&&__backupSSH.port==input.SSH.Port||saveData.push({id:218,data:{ssh:{enable:input.SSH.Enable,port:input.SSH.Port}},pos:-1}),somovd.write(saveData,function(response){return funcs.is.allRPCSuccess(response)?Promise.resolve():Promise.reject()})}function getData(){var result={Enable:data.enable||!1,Port:data.port||23};return dataSSH&&(result.SSH={Enable:dataSSH.enable||!1,Port:dataSSH.port||22}),result}var rpcList=[152],data=null,dataSSH=null,__backupTelnet=null,__backupSSH=null;return{pull:function(){function success(response){return data=response.rq[0]&&response.rq[0].data&&response.rq[0].data.telnet?response.rq[0].data.telnet:{},dataSSH=response.rq[1]&&response.rq[1].data&&response.rq[1].data.ssh?response.rq[1].data.ssh:void 0,__backupTelnet=angular.copy(data),__backupSSH=angular.copy(dataSSH),Promise.resolve()}return somovd.read(rpcList).then(success)},apply:apply,getData:getData}}])}();
;"use strict";!function(){angular.module("app").controller("WanContentCtrl",["$scope","$state",function($scope,$state){$scope.content={getType:function(){return $state.params.type}}}])}();
;"use strict";!function(){angular.module("app").controller("WanFlagsCtrl",["$scope","$state","translate","device","wanHelper",function($scope,$state,translate,device,helper){function isUnavailableFlag(flag){return helper.flags.unavailableFlag(flag,connection,type,inx)}var supported=device.wan.supported(),type=$state.params.type,inx=$state.params.inx,connection=$scope.wan.model.connection,core=$scope.wanCore;$scope.flagsInfo=helper.flags.getAllInfo(),$scope.flags={data:connection.Flags,supported:function(type){var connType="L2TP"==connection.ActualType&&_.has(connection,"IPsec")?"l2tpoveripsec":type,base=supported.flags(connType);return base&&(base.IGMP=base.IGMP&&!core.mode.isAdvancedMode(),base.MLD=base.MLD&&!core.mode.isAdvancedMode()),base}(type),unavailable:{}},$scope.flags.data&&_.each($scope.flagsInfo,function(flag){$scope.flags.unavailable[flag.name]={},$scope.$watchCollection(function(){return{unavailable:isUnavailableFlag(flag.name),flag:flag.name}},function(obj){var name=obj.flag;obj.unavailable?($scope.flags.unavailable[name].oldData=angular.copy($scope.flags.data[name]),$scope.flags.data[name]=angular.copy($scope.flags.data[name])):_.has($scope.flags.unavailable[name],"oldData")&&($scope.flags.data[name]=angular.copy($scope.flags.unavailable[name].oldData),delete $scope.flags.unavailable[name].oldData)})})}])}();
;"use strict";!function(){angular.module("app").controller("WanGeneralCtrl",["$scope","translate","somovd",function($scope,translate,somovd){var core=$scope.wanCore,Msisdn=null;$scope.general={action:$scope.wan.action,ifaceDescription:function(){var result="";return result+=translate($scope.wan.model["interface"].info)},has:function(field){switch(field){case"Name":return core.mode.isAdvancedMode()}return!0},changeProfile:function(value){"vpn.rtk.ru"!=value[0]?$scope.wan.model.connection.Login=value[1]:somovd.read(134).then(function(res){Msisdn=res.data.msisdn,Msisdn?$scope.wan.model.connection.Login=Msisdn:console.log("read msisdn failed")})["catch"](function(){console.log("read msisdn failed")}),$scope.wan.model.connection.APN=value[0],$scope.wan.model.connection.Password=value[2]}},$scope.general.data={},$scope.profile={profiles:[{name:"wan_profile_select",value:["","","",""]},{name:"internet.rtk.ru",value:["internet.rtk.ru","","","cpe_internet.rtk.ru"]},{name:"Mobile APN",value:["vpn.rtk.ru","","","cpe_vpn.rtk.ru"]},{name:"Static IP",value:["static.rtk.ru","","","cpe_static.rtk.ru"]},{name:"Center VPN, Tele2",value:["rtk.tele2.ru","","","cpe_rtk.tele2.ru"]},{name:"Center VPN, Megafon",value:["vpdn.rtk.msk","","","cpe_vpdn.rtk.msk"]}]},function(){var index;for(index=0;index<$scope.profile.profiles.length;index++)$scope.profile.profiles[index].value[0]==$scope.wan.model.connection.APN&&($scope.general.data.profile=$scope.profile.profiles[index].value)}()}])}();
;"use strict";!function(){angular.module("app").controller("WanHeaderCtrl",["$scope","translate","$state","funcs",function($scope,translate,$state,funcs){function activate(){header.list.push({value:"basic",description:"wan_setting_basic"}),header.list.push({value:"full",description:"wan_setting_full"}),header.state=header.list[0].value,header.isActivate=!0,$scope.$emit("wan.header.state",header.state)}function changePrepare(toView,fromView){if("full"==fromView&&!function(){return $scope.form&&$scope.form.$valid}()&&!_.isEqual($scope.wan.model,backupModel)){if(!confirm(translate("wan_change_invalid_form_mode")))return null;funcs.deepExtend($scope.wan.model,backupModel)}return!0}$scope.wanHeader={list:[],state:null,activate:activate,changePrepare:changePrepare,changeSuccess:function(toView){backupModel=angular.copy($scope.wan.model),header.state=toView,$scope.$emit("wan.header.change",header.state),$scope.$emit("resetErrorForm",!0)}},$scope.wanHeader.isActivate=!1;var header=$scope.wanHeader,backupModel=null;activate()}])}();
;"use strict";!function(){angular.module("app").controller("WanMediaCtrl",["$scope","$stateParams","translate","wanHelper",function($scope){function clean(){$scope.media.type=null,$scope.media.data={}}function update(){$scope.media.type=$scope.wan.model.connection.MediaType,$scope.media.data=$scope.wan.model.connection.Media,$scope.media.data.Ethernet&&$scope.media.data.Ethernet.MACAddress&&($scope.media.data.Ethernet.MACAddress=$scope.media.data.Ethernet.MACAddress.toUpperCase())}$scope.media={type:null,data:{},clean:clean,update:update,needMTU:function(){return!autoconf.BR2_PACKAGE_ANWEB_DSYSINIT}},$scope.wan.model.connection.Media&&$scope.wan.model.connection.MediaType?update():clean(),$scope.$on("wan.model.connection.media.clean",clean),$scope.$on("wan.model.connection.media.set",update)}])}();
;"use strict";!function(){angular.module("app").controller("WanPPPCtrl",["$scope","$state","$stateParams","translate","device","devinfo","funcs","wanHelper",function($scope,$state,$stateParams,translate,device,devinfo,funcs,helper){function isShowDualLAN(){return $scope.wan.model.contype,!1}var supported=device.wan.supported(),connection=$scope.wan.model.connection,type=$stateParams.type,actualType=helper.connection.identifyActualType(connection,type),ipv6oe=device.wan.ipv6oe,selects=supported.selects[actualType]?supported.selects[actualType]():{},backupValues={},backupConnection=angular.copy(connection),selectList={authProtocol:[{name:"AUTO",value:"AUTO"},{name:"PAP",value:"PAP"},{name:"CHAP",value:"CHAP"},{name:"MS-CHAP",value:"MS-CHAP"},{name:"MS-CHAPv2",value:"MS-CHAP-V2"}],encProtocol:[{name:"wan_no_encrypt",value:"None"},{name:"MPPE 40 128 bit",value:"MPPE"},{name:"MPPE 40 bit",value:"MPPE40"},{name:"MPPE 128 bit",value:"MPPE128"}],Origin:[{name:"wan_ipv6_auto_configured",value:autoconf.BR2_PACKAGE_ANWEB_DSYSINIT?"Auto":"AutoConfigured"},{name:"wan_ipv6_auto_configured_by_dhcp_v6",value:"AutoConfiguredByDHCPv6"},{name:"wan_ipv6_auto_configured_by_slaac",value:"AutoConfiguredBySlaac"}]};$scope.ppp={type:type,data:connection,select:autoconf.BR2_PACKAGE_ANWEB_DSYSINIT?function(selects){function makeList(supportList,type){var input=selectList[type];return _.filter(input,function(elem){return _.contains(supportList,elem.value)})}var output={};return selects.Origin&&(output.Origin=makeList(selects.Origin,"Origin")),selects.encProtocol&&(output.encProtocol=makeList(selects.encProtocol,"encProtocol")),selects.authProtocol&&(output.authProtocol=makeList(selects.authProtocol,"authProtocol")),output.DHGroup=function(list){var result=[];return _.each(list,function(elem){""!=elem&&result.push({name:elem.toUpperCase(),value:elem})}),result}(selects.dhgroup),output}(selects):angular.copy(selectList),supported:supported.connection[actualType](),onChangeUsePassword:function(){$scope.ppp.data.WithoutAuth?$scope.ppp.lastPassword=_.clone($scope.ppp.data.Password):$scope.ppp.data.Password=$scope.ppp.lastPassword},isShow:function(param){return"mobileinet"!=$scope.ppp.type&&"mobileinetv6"!=$scope.ppp.type||"basic"!=$scope.wan.mode?"Ifname"==param?!1:"mobileinet"!=$scope.ppp.type&&"mobileinetv6"!=$scope.ppp.type||"AuthenticationProtocol"!=param&&"Username"!=param&&"Password"!=param&&"WithoutAuth"!=param?!!$scope.ppp.supported[param]&&!_.isNull($scope.ppp.data[param]):!1:!1},isDisabled:function(param){var data=$scope.ppp.data;switch(param){case"Username":return"mobileinet"==$scope.ppp.type||"mobileinetv6"==$scope.ppp.type?data.WithoutAuth:!1;case"Password":return data.WithoutAuth;case"LCPEcho":case"LCPEchoRetry":return!data.KeepAlive;case"IdleDisconnectTime":return!("OnDemand"==data.ConnectionTrigger);case"GatewayIPv6Address":return data.GatewayIPv6AddressBySlaac;case"DNSIPv6Server1":case"DNSIPv6Server2":return data.DNSIPv6Automatical}return!1},isRequired:function(param){var data=$scope.ppp.data;switch(param){case"Username":case"Password":return!data.WithoutAuth;case"MaxMRUSize":return!0;case"LCPEcho":case"LCPEchoRetry":return data.KeepAlive;case"IdleDisconnectTime":return"OnDemand"==data.ConnectionTrigger;case"GatewayIPv6Address":return!data.GatewayIPv6AddressBySlaac;case"DNSIPv6Server1":return!data.DNSIPv6Automatical}return!1},isPPPv6:function(){return"pppoev6"==type||"pppoeDual"==type},isShowIPsec:function(){return"l2tpoveripsec"===actualType},checkIfname:function(value){return value.length>16?"msg_invalid_name_length":null},checkLength:function(value){var param=value.toString();return param.length>6?"msg_input_lenght_more_max":null},onlyHost:function(){return autoconf.BR2_PACKAGE_ANWEB_DSYSINIT},validation:function(value,param){var errors=ipv6oe.validation($scope.ppp.data);return errors[param]&&errors[param].length?errors[param][0]:null},isShowDualLAN:isShowDualLAN,disabledDualLAN:function(){return $scope.ppp.DualLAN&&$scope.ppp.DualLAN.__has?!1:!0},checkStaticIP:function(ip){return""==ip?null:"pppoev6"!=type||funcs.is.ipv6(ip)?"pppoev6"==type||"pppoedual"==type||funcs.is.ipv4(ip)?null:"msg_invalid_ipv4":"msg_invalid_ipv6"},normaliseLCP:function(value){value||($scope.ppp.data.LCPEcho=angular.copy(backupConnection.LCPEcho),$scope.ppp.data.LCPEchoRetry=angular.copy(backupConnection.LCPEchoRetry))},isShowUnnumberedIP:function(){return!1},validateSymbolLength:function(value,param){return value&&value.length>param?translate("msg_maxlength_symb")+" "+param:null}},$scope.ppp.onDemand={value:"OnDemand"==$scope.ppp.data.ConnectionTrigger,change:function(status){status||($scope.ppp.data.IdleDisconnectTime=angular.copy(backupConnection.IdleDisconnectTime)),$scope.ppp.data.ConnectionTrigger=this.value?"OnDemand":"pptp"==type?"AlwaysOn":"Manual"},isShow:function(){return $scope.ppp.isShow("ConnectionTrigger")}},$scope.$watch("ppp.data.EncryptionProtocol",function(value,oldValue){var supportAuthProto;value&&"None"!=value?(supportAuthProto=["MS-CHAP","MS-CHAP-V2"],"None"==oldValue&&(backupValues.AuthenticationProtocol=_.clone($scope.ppp.data.AuthenticationProtocol)),$scope.ppp.data.AuthenticationProtocol="MS-CHAP-V2",$scope.ppp.select.authProtocol=_.filter($scope.ppp.select.authProtocol,function(e){return _.contains(supportAuthProto,e.value)})):(backupValues.AuthenticationProtocol&&($scope.ppp.data.AuthenticationProtocol=backupValues.AuthenticationProtocol),$scope.ppp.select.authProtocol=angular.copy(selectList.authProtocol))}),isShowDualLAN()&&(devinfo.once("net").then(function(data){$scope.ppp.lans=_.map(data.lan,function(elem){return{net:funcs.ipv4.subnet.getNetworkRange(elem.ip,elem.mask),ifname:elem.name}})}),$scope.ppp.DualLAN=device.wan.dualLAN())}])}();
;"use strict";!function(){angular.module("app").service("wifiGeneralUtil",["device","somovd","funcs","devinfo",function(device,somovd,funcs,devinfo){return{subscribeChannelsInfo:function(cb,$scope){devinfo.subscribe("267",function(response){var data;response&&response[267]&&(data=response[267],cb&&cb(data))},$scope)},startReselectChan:function(freq){var data={},prefix="5GHz"==freq?"5G_":"";return data[prefix+"ReselectChan"]=!0,somovd.write(35,data)}}}])}();
;"use strict";!function(){angular.module("app").service("wifiWpsUtil",["devinfo","somovd",function(devinfo,somovd){return{checkStatus:function(action,cb,$scope){function updateStatus(result){if(result[wpsStatusRpc]){var status=result[wpsStatusRpc].WpsProcStatus;cb&&cb(status)}}"start"==action?devinfo.subscribe(wpsStatusRpc,updateStatus,$scope):devinfo.unsubscribe(wpsStatusRpc,updateStatus)},unlock:function(cb){somovd.write(266,{WpsUnlock:!0},-1).then(function(response){cb&&cb(response)})}};var wpsStatusRpc}])}();
;"use strict";!function(){angular.module("app").controller("WanDynIPv4oeCtrl",["$scope","$state","$stateParams","device","wanHelper","navigationFilter",function($scope,$state,$stateParams,device,helper,navFilter){function init(){var conn,connections=ipv4oe.select({MediaType:connection.MediaType});connections&&connections.length&&(conn=connections[0],conn.DNSServer1&&($scope.dynip.data.DNSServer1=conn.DNSServer1),conn.DNSServer2&&($scope.dynip.data.DNSServer2=conn.DNSServer2))}function isHostname(hostname){var re=/^([a-zA-Z0-9]{1})+([a-zA-Z0-9-])+([a-zA-Z0-9]{1})+$/;return re.test(hostname)}var device=$scope.device,supported=device.wan.supported(),ipv4oe=device.wan.ipv4oe,connection=$scope.wan.model.connection,action=$scope.wan.action,type=$stateParams.type,actualType=helper.connection.identifyActualType(connection,type);"ipoeDual"==$stateParams.type&&(connection=$scope.wan.model.connection.AdditionalConnection,type="ipv4oe",actualType=helper.connection.identifyActualType(connection,type));var customRules=navFilter.rules()||{};$scope.dynip={type:type,data:connection,supported:supported.connection[actualType](),isDefined:device.wan.isDefined,isDisabled:{DNSAutomatical:!!customRules.WanDynipDNSAutomaticalDisabled}};var _backupPrimDNS=angular.copy($scope.dynip.data.DNSServer1),_backupSecDNS=angular.copy($scope.dynip.data.DNSServer2);action&&"add"==action&&init(),$scope.$watch("dynip.data.DNSAutomatical",function(){$scope.dynip.data.DNSAutomatical&&($scope.dynip.data.DNSServer1=_backupPrimDNS,$scope.dynip.data.DNSServer2=_backupSecDNS)}),$scope.validateHostname=function(hostname){return hostname&&!isHostname(hostname)?"wan_invalid_dynip_hostname":null},$scope.validateHost=function(hostname){return hostname&&(hostname.length<3||hostname.length>30)?"msg_invalid_name_length":hostname&&!isHostname(hostname)?"wan_invalid_dynip_hostname":null},$scope.validateVendorID=function(vendorID){var re=/[а-яА-Я]/;return re.test(vendorID)?"msg_invalid_not_cyrillic_char":vendorID.length>15?"msg_input_lenght_more_max":null}}])}();
;"use strict";!function(){angular.module("app").controller("WanStatIPv4oeCtrl",["$scope","$state","$stateParams","wanHelper","funcs",function($scope,$state,$stateParams,helper,funcs){function init(){var conn,connections=ipv4oe.select({MediaType:connection.MediaType});connections&&connections.length&&(conn=connections[0],conn.StaticIPAddress0&&(statip.data.StaticIPAddress0=conn.StaticIPAddress0),conn.StaticIPSubnetMask0&&(statip.data.StaticIPSubnetMask0=conn.StaticIPSubnetMask0),conn.GatewayIPAddress&&(statip.data.GatewayIPAddress=conn.GatewayIPAddress),conn.DNSServer1&&(statip.data.DNSServer1=conn.DNSServer1),conn.DNSServer2&&(statip.data.DNSServer2=conn.DNSServer2))}var device=$scope.device,supported=device.wan.supported(),ipv4oe=($scope.device.funcs,device.wan.ipv4oe),connection=$scope.wan.model.connection,action=$scope.wan.action,type=$stateParams.type,actualType=helper.connection.identifyActualType(connection,type);$scope.statip={init:init,type:type,data:connection,supported:supported.connection[actualType](),isDefined:device.wan.isDefined};var statip=$scope.statip;action&&"add"==action&&init()}])}();
;"use strict";!function(){angular.module("app").controller("WanDynIPv6oeCtrl",["$scope","$state","$stateParams","wanHelper",function($scope,$state,$stateParams,helper){var device=$scope.device,supported=device.wan.supported(),ipv6oe=device.wan.ipv6oe,connection=$scope.wan.model.connection,action=$scope.wan.action,type=$stateParams.type,actualType=helper.connection.identifyActualType(connection,type),selects=supported.selects[actualType]?supported.selects[actualType]():{};$scope.dynipv6={type:type,data:connection,supported:supported.connection[actualType](),select:function(selects){var output={};return selects.Origin&&(output.Origin=function(supportList){return _.filter([{name:"wan_ipv6_auto_configured",value:"AutoConfigured"},{name:"wan_ipv6_auto_configured_by_dhcp_v6",value:"AutoConfiguredByDHCPv6"},{name:"wan_ipv6_auto_configured_by_slaac",value:"AutoConfiguredBySlaac"},{name:"wan_ipv6_auto_configured",value:"Auto"}],function(elem){return _.contains(supportList,elem.value)})}(selects.Origin)),output}(selects),validation:function(value,param){var errors=ipv6oe.validation($scope.dynipv6.data);return errors[param]&&errors[param].length?errors[param][0]:null},isDefined:device.wan.isDefined};var dynipv6=$scope.dynipv6,_backupPrimDNS=angular.copy(dynipv6.data.DNSServer1),_backupSecDNS=angular.copy(dynipv6.data.DNSServer2);action&&"add"==action&&function(){var conn,connections=ipv6oe.select({MediaType:connection.MediaType});connections&&connections.length&&(conn=connections[0],conn.DNSServer1&&(dynipv6.data.DNSServer1=conn.DNSServer1),conn.DNSServer2&&(dynipv6.data.DNSServer2=conn.DNSServer2))}(),$scope.$watch("dynipv6.data.DNSAutomatical",function(){dynipv6.data.DNSAutomatical&&(dynipv6.data.DNSServer1=_backupPrimDNS,dynipv6.data.DNSServer2=_backupSecDNS)})}])}();
;"use strict";!function(){angular.module("app").controller("WanStatIPv6oeCtrl",["$scope","$state","$stateParams","wanHelper",function($scope,$state,$stateParams,helper){var device=$scope.device,supported=device.wan.supported();$scope.device.funcs;var ipv6oe=device.wan.ipv6oe,connection=$scope.wan.model.connection,action=$scope.wan.action,type=$stateParams.type,actualType=helper.connection.identifyActualType(connection,type);$scope.statipv6={type:type,data:connection,supported:supported.connection[actualType](),validation:function(value,param){var errors=ipv6oe.validation($scope.statipv6.data);return errors[param]&&errors[param].length?errors[param][0]:null},isDefined:device.wan.isDefined};var statipv6=$scope.statipv6;action&&"add"==action&&function(){var conn,connections=ipv6oe.select({MediaType:connection.MediaType});connections&&connections.length&&(conn=connections[0],conn.DNSServer1&&(statipv6.data.DNSServer1=conn.DNSServer1),conn.DNSServer2&&(statipv6.data.DNSServer2=conn.DNSServer2))}()}])}();
;